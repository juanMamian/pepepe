(function(i){function o(o){for(var t,s,r=o[0],u=o[1],d=o[2],l=0,A=[];l<r.length;l++)s=r[l],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&A.push(n[s][0]),n[s]=0;for(t in u)Object.prototype.hasOwnProperty.call(u,t)&&(i[t]=u[t]);c&&c(o);while(A.length)A.shift()();return a.push.apply(a,d||[]),e()}function e(){for(var i,o=0;o<a.length;o++){for(var e=a[o],t=!0,r=1;r<e.length;r++){var u=e[r];0!==n[u]&&(t=!1)}t&&(a.splice(o--,1),i=s(s.s=e[0]))}return i}var t={},n={app:0},a=[];function s(o){if(t[o])return t[o].exports;var e=t[o]={i:o,l:!1,exports:{}};return i[o].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=i,s.c=t,s.d=function(i,o,e){s.o(i,o)||Object.defineProperty(i,o,{enumerable:!0,get:e})},s.r=function(i){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},s.t=function(i,o){if(1&o&&(i=s(i)),8&o)return i;if(4&o&&"object"===typeof i&&i&&i.__esModule)return i;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:i}),2&o&&"string"!=typeof i)for(var t in i)s.d(e,t,function(o){return i[o]}.bind(null,t));return e},s.n=function(i){var o=i&&i.__esModule?function(){return i["default"]}:function(){return i};return s.d(o,"a",o),o},s.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},s.p="/tallerCuentos/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],u=r.push.bind(r);r.push=o,r=r.slice();for(var d=0;d<r.length;d++)o(r[d]);var c=u;a.push([0,"chunk-vendors"]),e()})({0:function(i,o,e){i.exports=e("56d7")},"034f":function(i,o,e){"use strict";e("85ec")},"0705":function(i,o,e){"use strict";e("3593")},"0d62":function(i,o,e){"use strict";e("fef7")},1:function(i,o){},10:function(i,o){},11:function(i,o){},12:function(i,o){},13:function(i,o){},14:function(i,o){},"1d2e":function(i,o){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAzFBMVEUAAAC8i1q6i1zyu1n2vVq3kUr/tki6i1vyvFm5i1xmXWZ9c2W3il2xiF7kpVqQgmuziV7uuFmpg2GrhmChgmHuuFntuVquhl/TmlrTqmCrhmCvh1+yiF7OqWDHlVqmg2Kog2KigWONd2aDdG3uvVrzvFq7jF349uzkpVvyu1rxuVrVm1vlp1rrsFrorFrJpX/08OP37tnzw2zCmW7w6NrstFr169ns4tHnsG3Ut5fIoHPAkWD07+Pv4cfk1L/VupvNrInYpm3xwGzutFov9SsWAAAAJXRSTlMAH9/fHwcHt7d+Bg38ubca5LeUij7v3863tK+mpI+PbVtFLSMf1QcYpQAAAOxJREFUWMPt10eywjAMgOG8R0+l914EhE4SEnq7/51gCyEOGnvF6D/ANyNbG0kURVE/lhwLCcf1WrUEu3oe4+U1FcJKIbyuBmAtmKFAOQewdQ9LRq6FAY0SLOwhMxsF/v3DeSgY3IoGd65gEC4ne/NsFdBxt29GDQwIe+vqed5tHZDjFCIVAwMCTEajqTlgFIkSSCCBBBJIIIEEvoLmzJ8z5gHn/rjAwfhDvG/o0zhB0zcvF/j+L3c8mGaOjF8bpSp4D6W2KhhUsioeZIu59BdgsY849zpZrazreiYZXKahIA/weEiyRFEU9Ts9APjdERj5ZBqjAAAAAElFTkSuQmCC"},2:function(i,o){},2191:function(i,o){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA9CAMAAADGfvrlAAAAtFBMVEUAAAAAAAACAgIAAAAAAAAAAAAGBgYAAAAAAAAAAAAFBQUAAAABAQEGBgYCAgIAAAAAAAAEBAQFBQUAAAAAAAABAQEDAwMCAgIAAAAAAAAAAAAFBQUAAAAGBgYAAAAAAAAAAAAAAAADAwMBAQEAAAABAQEBAQEBAQEBAQEDAwMBAQEAAAACAgIBAQECAgIAAAAAAAABAQEAAAAAAAABAQEBAQEBAQEDAwMAAAAAAAAAAAAAAAAAI6fdAAAAO3RSTlMABQvg9KseO8T3ho92RZ0X129r+9M/KzjxyZkU3Q/ov7ykMiHOtV5SJRqplEx/ZK6gconruWhZQwmCwUKZof4AAAMbSURBVEjHpZeJlqIwEEUDuNGiIiACoqIi4761S9vv//9rwgxYgqB4fMfjEnOTkKpUVViuxN7E7HbNWasvsLfUq7aXniENLGsgGUOn3WkVJfurum8hIctf/umx15prxxKAkjvcHZR2W/naeWo4lDzcT17NevrVgcFUaVTE28NXOsp2AMDeP519teWof+1GIEnorm0A0z/5+6tIgKHkrK6y5/j3OmfyWROw6mOWq9nhGxhlduhMAfvMnuqPB3idDHZIo+bL3AHDS7q1y1mnkmocbzbdVFPrwOnU3JMyUO+nOgYq4J5YSmvgaCYssQSa6X2c+PB9qGbaanXe936eto7t5MHosjs2Df3BtPMRoNw9sAGjEw/cinXSDXNW09u3hp94K2y4jdtCmtC1eNN3hhpJAlRVhxT/NhareDNKGImx9fj3aFSzBjlXMKrRbA7kIPLKBQbxKvbwg0aky78XKbBxjbpVXUz7/zemhCWLVIfDcnXAKA4qX5DP0Rq+OwTbX7n6JXgsYRE+qck/BXYb8amcW0cHg9CXN7q+IQ93yk/UXNERkbHnq97Bnd35z1PdeYqBrcBaBsoCe19NuBPWtaAkm09Knz2quk4eMA2lBgt0eZUMN6pF3Uh1XJPn34LG1hiYSVgqVTOXWU/GJIk3OFDnWTDfh/hdyIJ7PkZsAbufAZvLTWjGpcm7HZQMWPyFx46oiRnwCZ7IRA98iGrJrTzCwhQ1VsuG22GzWIMWwlIWXIbNjm/DNDM985sw/8+j3S4M026TnQvDZGfysMIweRj5dmGYfJtOVWGYThWd58IwnWeKJEVhiiRRDPt5A6YYRtGzMEzRk+J2UZjiNmWMwjBlDMpVYgrWIniTgilX0XddIyOoMk/JF/srXJ194Y445blc2II3JLPkY35mPws44RhCOOyccbX6vIurB+whPz9WBoGuX+dCQmJ1gVolqzKgmoR+GNPyvTwJ0vm+JhFzq6He2tWRlOydU9VQfh1mBnvlXlqjlarDPq8ASdX3as/Pq97P6+3PK/3Xd4x27/Pbzef3qs9vdK/vkmJuvfMXl9icGVrQDtsAAAAASUVORK5CYII="},"28b8":function(i,o){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAzFBMVEUAAAAyMjIxMTE0NDQqKipBQUEwMDAjIyMxMTExMTEyMjI4ODgxMTFMTEw1NTUrKysjIyMwMDAxMTExMTE1NTUxMTEzMzMwMDAxMTExMTE4ODgwMDAxMTEvLy8gICB/f38yMjIxMTExMTEvLy8xMTExMTEuLi4wMDAyMjIyMjIxMTEvLy8xMTEyMjIxMTEwMDAzMzMuLi42NjYyMjIxMTExMTExMTEwMDAvLy8wMDAwMDAwMDAtLS0tLS0zMzMvLy80NDQ2NjY4ODgzMzN6YhNIAAAAQ3RSTlMA/fT6PVlzBiXd+8TnFCIJA3j7+BjxZS8N2ZFdz78OBO/kyrWmn5trUjspHOu8r5RJQzXV0sWQghKrqIpuWFZPpnmWvT1N0wAAAodJREFUWMPtl9mWmkAQQGlibDWGRRYhIMEFwX0Zt9FxMhP//5+C09UJKnhsOicv4T41p+BC2VWFCAUFBQX/D4peSWLx+ix1XU1gBwNOYVlDpyRouuPy4Sn1UdrDB6+UsZCC/HYttCuP6HSn3+2bo5TI3K2hGJJujLFVHvBFE+18/tpJiQ1CVVUDdI6/qWo5emSbFy6kU33NOkOMo58+C4/h9RAI0UQSUikxCY/+idJQ/4LQSlQGWo/4hYt6omxFh1uobFCyEXoWr1ByLxuhxCt0RHg2ui2cQtyHLugYxDjZ8QmHT8QjmhNiNiI+YblBhK6kwmqGeYRWFzLeKHMfcpd4hCUoQuOHIK3IUjM5hPgAm/skCXiGoBTl/MJRByRBLIkMkA/zC+dj2OPz3KrYkHOYVwhZxqzOM0Hew9HUyiukz4SCj1IxNXJYH+QVUoPmXPq3OYXyM+TY0cnoppNxrecTDugk7OPLtjGiXEJFrcEeO7/vAFU0w3mEuy6ihfedoLdA6Ep5hCWacfvnN8BGtP1yCJUDAiH6wwnYy2xCmP3ZVIfswlfxjhCVmYU4QPeELZ1VuGyf7lEvsQmh7bJpbBU2oQdtl0lnxCYcjOFC8cslPqIvBTbhC7Qt6kpfk+g9BIGDwiKUe3Q7t8rtnWAEsQh1l2ZMM6M0bbrPSxbhckz/s+qpzw7XMwh9qI7yTSjU8ghhdKFV87bHYYbZJCQPm81m+CF8j1dSltFpoxg/TAtVUYzxTt7cs2q9Xic/0DherV6UjOEV9VutZxOnvq3jUHDEZKo3rj/NFpnTwfOsrKLyPAwn7a8bCpkCD3hzLTTmAhfLrlhL4m8sgQ/pWE4QLmShoKCg4J/zC0L99j/wenPiAAAAAElFTkSuQmCC"},3:function(i,o){},3593:function(i,o,e){},"3a36":function(i,o,e){"use strict";e("3d30")},"3d30":function(i,o,e){},4:function(i,o){},"4a8c":function(i,o){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAmVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjHWqVAAAAMnRSTlMA+/m7FsEEiBPmECX07x+ck5iQY1wMBt46InFINCkb6tXQyLaNf6x7QVdRTy0IysOjdbIknQAAAAI9SURBVGje7dbplqowDAfwUpACgqCCoHIRRdxny/s/3PWunmGxtIEPc6a/F/ifJoSEKIqiKMr39DJelWRQi3H4HsOKDMi4THMXIB6TwaRs62pw9/5CBrGYzAsX/nBDMgBzefFj+C8foFrOerb14EGbLvqOuB13vxvx4F76LZMRHjyo2ho9RmTrYAsNWG8J0YntPGjipj1FjFcjj0KzwuyjEdbV30C7OT7COLFXCk/kE+z/NSlHG3gOOSTZXN9owOFdMY1YBzF08CpdLSsp31zoQpuZco9IP3QbOnLXMhFGeLApdLZzhN8QJfschBxF11DyobsgxruJhvgg7EBETXQQdSbCliMNePCb5McIhMgNyVIXajt/SPB92WWy66l7Xyh/7+L74p0Qq7ZrxUYR4cH3hX/K4+fF5h+n+L74hAc/L/RKsCYFd0gsgpbyNjwz0RlO6cFTmxM6I2KUNyQGOmOm8dp+RNeK8TJgkyAzLEaBp1gg37GnwDVHZgQacMUZrlb3nvMFuIxarbwYeZzWM4JqBi1TvT4kDibDr9ZKY07DfjmamHfUMmZRw963EUNi1GvFoqb9UljyGdN6htO0X+hKPqPej73TuPftW48ZgdN8jx1k257VazVzPu/9N/grJJIYVDP2Vss9lktvkrNd/XattnuMEWlz+1PG1Gm7k72E9JNCA6v1HtMjRIgZ2o8Mo/0eWxGUfynatL21Ez8lfaRovkHaLUxkiPmrL/SewYFPuddqaGeWEUVRFEVRvqqfnnZk9rlieAEAAAAASUVORK5CYII="},"4cb3":function(i,o,e){},"4fc3":function(i,o){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAApVBMVEUAAAAFBQUKCgozMzMzMzMoKCgsLCw4ODgsLCwxMTEVFRUzMzM7Ozs2NjY0NDQzMzNMTEw1NTUlJSUxMTEvLy8xMTExMTEtLS0VFRUcHBwuLi4oKCgxMTEuLi4rKyswMDAwMDArKystLS0uLi4xMTEuLi4kJCQxMTEwMDArKysqKioxMTEuLi4rKys0NDQsLCwkJCQuLi4vLy8uLi42NjYwMDAzMzMGZa9aAAAANnRSTlMABgFL7bBzQ9VhGOAzJeq3Coku+Lr16sIMCZhO/JRC5qV2KBDKehnt2bqvoIRWPB8K0bWOjGo12immAAAA/ElEQVRIx+3Sy1LCMBiG4STUoiIeGmKVJG1paUXOnv77vzRjNlJy0AwLGKbvpjNf55ksEnSG4ZJfOes1FlHKnAohaHRrFgmWrgxRFfCTqG8sZepnHpM9sqKaTKv2nHHOE/V5AWCTtiESdKPn1vz0SimVBCWPYBg8t5NUbWNNDIMv/iLafAUTmGXBBMY4mLw1weTy+kSIvkon8T8YN6F1OTRbL8BNQAws5WAnvo5NiknsTlILmW6QJ1xYyN29j5DPcPLQkY4cQubBhHz8j4y2vwNnAGnlJQtF6p1hKwXQZdZ3F+cA70O0U7OcMRZ5Ymwgk72DN+uet36JUZfqG2Wjeg1GwVSoAAAAAElFTkSuQmCC"},5:function(i,o){},5301:function(i,o,e){},"559e":function(i,o){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAqCAMAAAD26OlUAAAAtFBMVEUAAAAAAAAAAAAAAAAaGhoCAgIDAwMBAQEQEBAAAAABAQEBAQECAgIAAAABAQEBAQECAgIEBAQBAQEAAAAFBQUDAwMDAwMAAAAAAAACAgIDAwMFBQUGBgYAAAABAQEBAQEDAwMDAwMICAgJCQkMDAwBAQEBAQEBAQECAgIBAQECAgICAgICAgIGBgYGBgYNDQ0EBAQCAgIEBAQBAQEBAQEDAwMCAgIDAwMEBAQFBQUQEBAAAAAlv8O7AAAAO3RSTlMAvz/5B4MexQP7YBe0n+vmf03b2F0SC+DPqVlRLfbKo3lENiEP89PAu66Ja2dJOjIncUfthpmTjT4pJj+7kzoAAAIXSURBVDjLnZTnlrIwEIbHDaEI0lFAQFGkWrBty/3f16cU0Q3sd86+vybwnMnUwJ/FWGxZshbzOyVqOLN1RdHtDGviILa/2D5S7ESSEltBvn3Z92JePhPid9ezpgwztTz3PRZmuUdzZkCSgoUnsUVCAvMHxqsbRW2xDlWVjcq/pJqTZA49mickfy4AJtJ+IEGJ4O50JOkKBrRKybG1T7r9RhNtGd9s/VRbUwdtae7NGTfWFjnTyhijCUNzIzJrSGaCKiuS5JDu+JKQBxnKUgQA2mZBOSxFdtKRzGKjAcAHcul7J2xN1mm46APA4gyWjo/U5KiuGmtwFhxkh6e5mhw1VeMd+QAawjRXk2L56BzSYCuMKa7WsstxLGxhKcz7udFTt+bCErC/+y8HOx93HmnuxeNLjOKC5toYn7NmwDVors3akzO+qZZ5AFfv4/hM9sDi9HV9jALpAKZOc7DWOQsgR82mfSmkIikOTJTfU2+nR/PJnQyprbhNz66ax/Op2ZybnDVQOp2lqJ7wyiV/VbjJUpsC7RCN250pqn0rLR56VLQ7A6ERhzCoMDYefwthtB/i9iOh6E4qST/7uc+UqM+lx4Trf3s4gl8DV88ypiqzxvJZhR9yOcId1y/Y8fbJBUrlZUaMq+mJ9xdX9MyrQWaXr/6HCwc+kmMuTblYRn6AVzAkcadmgaEoRpCpOxF+FR+J399iRPXoHwT7P6mwTTR1AAAAAElFTkSuQmCC"},"56d7":function(i,o,e){"use strict";e.r(o);e("e260"),e("e6cf"),e("cca6"),e("a79d"),e("caad"),e("2532");var t,n,a,s,r,u,d,c,l,A,m,g,h,f,p,v,x,b,y,C,T,I,P,z,L,S=e("2b0e"),E=function(){var i=this,o=i.$createElement,e=i._self._c||o;return e("div",{attrs:{id:"app"}},[e("center",[e("h2",[i._v("Taller de creación de cuentos")])]),i.usuarioSuperadministrador?e("todos-libros",{on:{libroSeleccionado:i.seleccionarLibro}}):i._e(),e("mis-libros",{on:{libroSeleccionado:i.seleccionarLibro}}),null!=i.idLibroSeleccionado?e("libro",{attrs:{idLibro:i.idLibroSeleccionado}}):i._e()],1)},w=[],D=(e("841c"),e("ac1f"),e("2b3d"),e("d3b7"),e("3ca3"),e("ddb0"),function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("div",{staticClass:"libro",on:{click:function(o){i.idPaginaSeleccionada=null}}},[t("div",{attrs:{id:"zonaTitulo"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!i.editandoTitulo,expression:"!editandoTitulo"}],attrs:{id:"titulo"}},[i._v(" "+i._s(i.libro.titulo)+" ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:i.nuevoTitulo,expression:"nuevoTitulo"},{name:"show",rawName:"v-show",value:i.editandoTitulo,expression:"editandoTitulo"}],class:{letrasRojas:i.nuevoTituloIlegal},attrs:{type:"text",id:"inputNuevoTitulo"},domProps:{value:i.nuevoTitulo},on:{keypress:function(o){return!o.type.indexOf("key")&&i._k(o.keyCode,"enter",13,o.key,"Enter")?null:i.guardarNuevoTitulo(o)},input:function(o){o.target.composing||(i.nuevoTitulo=o.target.value)}}}),t("div",{attrs:{id:"controlesTitulo"}},[t("img",{staticClass:"bEditarTitulo",attrs:{src:e("559e"),alt:"Editar",id:"bEditarrTitulo",title:"Editar titulo del libro"},on:{click:function(o){return o.stopPropagation(),i.toggleEditandoTitulo(o)}}}),t("img",{directives:[{name:"show",rawName:"v-show",value:1==i.editandoTitulo&&0==i.nuevoTituloIlegal,expression:"editandoTitulo == true && nuevoTituloIlegal == false"}],staticClass:"bEditarTitulo",attrs:{src:e("4fc3"),alt:"Guardar",title:"guardar",id:"bGuardarNuevoTitulo"},on:{click:function(o){return o.stopPropagation(),i.guardarNuevoTitulo(o)}}})])]),t("div",{attrs:{id:"contenedorPaginas"}},i._l(i.paginasOrdenadas,(function(o,e){return t("pagina",{key:o.id,attrs:{paginaDerecha:e%2>0||0==e,estaPagina:o,idLibro:i.idLibro,seleccionada:i.idPaginaSeleccionada==o.id,segundoPlano:null!=i.idPaginaSeleccionada&&i.idPaginaSeleccionada!=o.id},on:{meElimine:function(e){return i.removePaginaFromCache(o.id)},tengoNuevoCuadroTexto:function(e){return i.updateCacheConNuevoCuadroTexto(e,o.id)},tengoNuevoCuadroImagen:function(e){return i.updateCacheConNuevoCuadroImagen(e,o.id)},elimineCuadroTexto:function(e){return i.removeCuadroTextoFromCache(e,o.id)},elimineCuadroImagen:function(e){return i.removeCuadroImagenFromCache(e,o.id)}},nativeOn:{click:function(e){e.stopPropagation(),i.idPaginaSeleccionada=o.id}}})})),1),t("div",{class:{deshabilitado:i.creandoPagina},attrs:{id:"bCrearNuevaPagina"},on:{click:function(o){return o.stopPropagation(),i.crearNuevaPaginaLibro(o)}}},[i._v(" Crear nueva página ")])])}),M=[],$=e("8785"),O=(e("c740"),e("a434"),e("99af"),e("7db0"),e("aa5a")),j=e.n(O),F=function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("div",{staticClass:"pagina",class:{seleccionada:i.seleccionada,deshabilitado:i.uploadingInfo,segundoPlano:i.segundoPlano,cursorTexto:i.creandoTexto,cursorImagen:i.creandoImagen},style:[i.estiloColumna,i.estiloSize,i.estiloApariencia],on:{mousedown:function(o){return!o.type.indexOf("key")&&i._k(o.keyCode,"left",37,o.key,["Left","ArrowLeft"])||"button"in o&&0!==o.button?null:(o.stopPropagation(),i.accionCrearElemento(o))},mousemove:i.resizeFantasmaElemento,mouseup:i.endDibujandoElemento,click:function(o){i.idElementoSeleccionado=null}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionada,expression:"seleccionada"}],staticClass:"zonaControlesPagina"},[t("img",{staticClass:"bControlesPagina bEliminarPagina",attrs:{src:e("2191"),title:"Eliminar esta página"},on:{click:i.eliminarse}}),t("img",{staticClass:"bControlesPagina bSelectColorPagina",attrs:{src:e("df69"),alt:"Color",title:"Seleccionar color de la página"},on:{click:function(o){return o.stopPropagation(),i.$refs.inputColorPagina.click()}}})]),t("input",{directives:[{name:"model",rawName:"v-model",value:i.colorSeleccionado,expression:"colorSeleccionado"}],ref:"inputColorPagina",staticStyle:{display:"none"},attrs:{type:"color"},domProps:{value:i.colorSeleccionado},on:{change:i.guardarNuevoColor,input:function(o){o.target.composing||(i.colorSeleccionado=o.target.value)}}}),t("herramientas-edicion",{directives:[{name:"show",rawName:"v-show",value:i.seleccionada,expression:"seleccionada"}],ref:"herramientasEdicion",on:{creacionTexto:function(o){i.desactivarHerramientas(),i.creandoTexto=!0},creacionImagen:function(o){i.desactivarHerramientas(),i.creandoImagen=!0},mousedown:function(i){i.stopPropagation()},mouseup:function(i){i.stopPropagation()}}}),t("div",{directives:[{name:"show",rawName:"v-show",value:i.dibujandoTexto,expression:"dibujandoTexto"}],staticClass:"fantasmaElemento",style:[i.estiloLayoutFantasmaTexto],attrs:{id:"fantasmaTexto"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:i.dibujandoImagen,expression:"dibujandoImagen"}],staticClass:"fantasmaElemento",style:[i.estiloLayoutFantasmaImagen],attrs:{id:"fantasmaImagen"}}),i._l(i.estaPagina.cuadrosImagen,(function(o){return t("cuadro-imagen",{key:o.id,ref:"cuadroImagen"+o.id,refInFor:!0,staticClass:"elementoPagina",class:{primerPlano:i.idElementoSeleccionado==o.id},attrs:{esteCuadroImagen:o,idLibro:i.idLibro,idPagina:i.estaPagina.id,sizePagina:i.size,seleccionado:i.idElementoSeleccionado==o.id&&i.seleccionada,paginaSeleccionada:i.seleccionada,zBase:i.zElementos},on:{meElimine:function(e){return i.$emit("elimineCuadroImagen",o.id)}},nativeOn:{click:function(e){return i.resolverSeleccion(e,o.id)}}})})),i._l(i.estaPagina.cuadrosTexto,(function(o){return t("cuadro-texto",{key:o.id,staticClass:"elementoPagina",class:{primerPlano:i.idElementoSeleccionado==o.id},attrs:{esteCuadroTexto:o,idLibro:i.idLibro,idPagina:i.estaPagina.id,sizePagina:i.size,seleccionado:i.idElementoSeleccionado==o.id&&i.seleccionada,paginaSeleccionada:i.seleccionada,zBase:i.zElementos},on:{meElimine:function(e){return i.$emit("elimineCuadroTexto",o.id)}},nativeOn:{click:function(e){return i.resolverSeleccion(e,o.id)}}})}))],2)},N=[],k=e("898b"),B=function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("div",{staticClass:"cuadroImagen",class:{conAudio:i.esteCuadroImagen.audio,deshabilitado:i.updatingInfo,enPaginaSeleccionada:i.paginaSeleccionada},style:[i.estiloLayout],on:{click:i.playAudio}},[t("img",{staticClass:"imagenContenido",attrs:{src:i.urlImagen+"?v="+i.versionImagen,alt:"ilustracion"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],attrs:{id:"zHandlers"}},[t("div",{staticClass:"zHandler",attrs:{id:"bSendBack",title:"Mover hacia atrás"},on:{click:function(o){i.posicionZeta=i.posicionZeta>0?i.posicionZeta-1:0}}}),t("div",{staticClass:"zHandler",attrs:{id:"bBringFront",title:"Mover hacia adelante"},on:{click:function(o){i.posicionZeta++}}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:i.sizeDragHandle,attrs:{id:"dragHandle"},on:{mousedown:function(o){return!o.type.indexOf("key")&&i._k(o.keyCode,"left",37,o.key,["Left","ArrowLeft"])||"button"in o&&0!==o.button?null:(o.stopPropagation(),i.iniciarDrag(o))},mousemove:i.drag,mouseup:i.finDrag}},[t("div",{class:{enDuda:i.posicionZeta!=i.esteCuadroImagen.posicionZeta},attrs:{id:"bolitaDragHandle",title:"arrastrar"}},[i._v(i._s(i.posicionZeta))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:[i.sizeResizeHandle],attrs:{id:"resizeHandle"},on:{mousedown:function(o){return!o.type.indexOf("key")&&i._k(o.keyCode,"left",37,o.key,["Left","ArrowLeft"])||"button"in o&&0!==o.button?null:i.iniciarResize(o)},mousemove:i.resize,mouseup:i.finResize}},[t("div",{attrs:{id:"bolitaResizeHandle"}})]),t("img",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],attrs:{src:e("2191"),alt:"Eliminar",title:"Eliminar cuadro de imagen",id:"bEliminarCuadroImagen"},on:{click:i.eliminarse}}),t("input",{ref:"inputArchivoImagen",staticStyle:{display:"none"},attrs:{type:"file",id:"inputArchivoImagen"},on:{change:i.uploadArchivoCuadroImagen}}),i.esteCuadroImagen.audio?t("audio",{ref:"audio",attrs:{type:"audio/ogg"}},[t("source",{attrs:{src:i.urlAudio,type:"audio/ogg"}})]):i._e()])},U=[],Q=(e("a9e3"),e("bc3a")),Z=e.n(Q),H=e("b012"),R=e.n(H),q={name:"cuadroImagen",props:{esteCuadroImagen:Object,idLibro:String,idPagina:String,sizePagina:Object,seleccionado:Boolean,archivoCuadroImagenPagina:Object,paginaSeleccionada:Boolean,zBase:Number},data:function(){return{posicionZeta:0,resizing:!1,dragging:!1,posicion:{x:null,y:null},size:{x:null,y:null},updatingInfo:!1,versionImagen:0}},computed:{estiloLayout:function(){return{top:this.posicion.y+"%",left:this.posicion.x+"%",width:this.size.x+"%",height:this.size.y+"%",zIndex:this.seleccionado?this.zBase+this.posicionZeta+100:this.zBase+this.posicionZeta}},urlImagen:function(){return this.serverUrl+"/apiCuentos/imagenCuento/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroImagen.id},sizeResizeHandle:function(){return{width:this.resizing?"200px":"10px",height:this.resizing?"200px":"10px"}},sizeDragHandle:function(){return{width:this.dragging?"200px":"10px",height:this.dragging?"200px":"10px"}},urlAudio:function(){return this.serverUrl+"/apiCuentos/audioImagen/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroImagen.id}},methods:{playAudio:function(){this.esteCuadroImagen.audio&&this.$refs.audio.play()},iniciarResize:function(){this.resizing=!0},resize:function(i){if(this.resizing){var o={x:this.$el.getBoundingClientRect().left,y:this.$el.getBoundingClientRect().top},e=i.clientX-o.x-5,t=i.clientY-o.y-5,n=Math.floor(100*e/this.sizePagina.x),a=Math.floor(100*t/this.sizePagina.y);this.posicion.x+n>100&&(n=Math.floor(100-this.posicion.x)),this.posicion.y+a>100&&(a=Math.floor(100-this.posicion.y)),this.$set(this.size,"x",n),this.$set(this.size,"y",a)}},finResize:function(){this.resizing=!1,this.$apollo.mutate({mutation:Object(k["gql"])(t||(t=Object($["a"])(["\n          mutation(\n            $idLibro: ID!\n            $idPagina: ID!\n            $idCuadroImagen: ID!\n            $nuevoSize: CoordsInput!\n          ) {\n            updateSizeCuadroImagen(\n              idLibro: $idLibro\n              idPagina: $idPagina\n              idCuadroImagen: $idCuadroImagen\n              nuevoSize: $nuevoSize\n            ) {\n              id\n              size {\n                x\n                y\n              }\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroImagen:this.esteCuadroImagen.id,nuevoSize:this.size}})},iniciarDrag:function(){this.dragging=!0},drag:function(i){if(this.dragging){console.log("Dragging");var o=this.$el.closest(".pagina"),e=o.getBoundingClientRect(),t={x:i.clientX-e.left,y:i.clientY-e.top},n={x:t.x-this.$el.offsetWidth/2,y:t.y+20};n.x+this.$el.offsetWidth>o.offsetWidth&&(n.x=o.offsetWidth-this.$el.offsetWidth),n.x<0&&(n.x=0),n.y+this.$el.offsetHeight>o.offsetHeight&&(n.y=o.offsetHeight-this.$el.offsetHeight),n.y<0&&(n.y=0);var a={x:Math.round(100*n.x/o.offsetWidth),y:Math.round(100*n.y/o.offsetHeight)};this.posicion=a}},finDrag:function(){this.dragging=!1,this.$apollo.mutate({mutation:Object(k["gql"])(n||(n=Object($["a"])(["\n          mutation(\n            $idLibro: ID!\n            $idPagina: ID!\n            $idCuadroImagen: ID!\n            $nuevoPosicion: CoordsInput!\n          ) {\n            updatePosicionCuadroImagen(\n              idLibro: $idLibro\n              idPagina: $idPagina\n              idCuadroImagen: $idCuadroImagen\n              nuevoPosicion: $nuevoPosicion\n            ) {\n              id\n              posicion {\n                x\n                y\n              }\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroImagen:this.esteCuadroImagen.id,nuevoPosicion:this.posicion}})},uploadArchivoCuadroImagen:function(){var i=this,o=new FormData;this.$refs.inputArchivoImagen.value?(o.append("idLibro",this.idLibro),o.append("idPagina",this.idPagina),o.append("idCuadroImagen",this.esteCuadroImagen.id),o.append("imagen",this.$refs.inputArchivoImagen.files[0]),Z()({method:"post",url:this.serverUrl+"/apiCuentos/subirArchivoCuadroImagen",data:o,headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+this.$store.state.token}}).then((function(o){var e=o.res;console.log("Resultado de upload archivo: ".concat(e)),i.versionImagen++})).catch((function(i){console.log("Error uploading archivo de cuadroImagen. E: ".concat(i))}))):console.log("No había archivo seleccionado")},guardarPosicionZeta:R()((function(){this.posicionZeta!=this.esteCuadroImagen.posicionZeta&&(console.log("Guardando posición zeta"),this.$apollo.mutate({mutation:Object(k["gql"])(a||(a=Object($["a"])(["\n          mutation($idLibro:ID!, $idPagina:ID!, $idCuadroImagen:ID!, $nuevoPosicionZ:Int!){\n            setPosicionZCuadroImagen(idLibro:$idLibro, idPagina:$idPagina, idCuadroImagen:$idCuadroImagen, nuevoPosicionZ:$nuevoPosicionZ){\n              id\n              posicionZeta\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroImagen:this.esteCuadroImagen.id,nuevoPosicionZ:this.posicionZeta}}))}),3e3),eliminarse:function(){var i=this;confirm("Eliminando cuadro de imagen. Esta operación no se puede deshacer. ¿Continuar?")&&(this.updatingInfo=!0,console.log("Eliminando un cuadro de imagen"),this.$apollo.mutate({mutation:Object(k["gql"])(s||(s=Object($["a"])(["\n            mutation($idLibro: ID!, $idPagina: ID!, $idCuadroImagen: ID!) {\n              eliminarCuadroImagenLibro(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                idCuadroImagen: $idCuadroImagen\n              )\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroImagen:this.esteCuadroImagen.id}}).then((function(o){var e=o.data.eliminarCuadroImagenLibro;console.log("Resultado: ".concat(e)),e&&i.$emit("meElimine")})).catch((function(o){console.log("Error. E: ".concat(o)),i.updatingInfo=!1})))}},watch:{posicionZeta:function(){console.log("Cambio de posicion zeta"),this.guardarPosicionZeta()}},mounted:function(){console.log("Montado"),this.$set(this.posicion,"x",this.esteCuadroImagen.posicion.x),this.$set(this.posicion,"y",this.esteCuadroImagen.posicion.y),this.$set(this.size,"x",this.esteCuadroImagen.size.x),this.$set(this.size,"y",this.esteCuadroImagen.size.y),this.posicionZeta=this.esteCuadroImagen.posicionZeta,this.esteCuadroImagen.sinArchivo&&(console.log("Abriendo el input de archivo"),this.$refs.inputArchivoImagen.click())}},V=q,J=(e("bf1b"),e("2877")),W=Object(J["a"])(V,B,U,!1,null,"2e27fb58",null),G=W.exports,Y=function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("div",{staticClass:"cuadroTexto",class:{conAudio:i.esteCuadroTexto.audio,deshabilitado:i.updatingInfo,enPaginaSeleccionada:i.paginaSeleccionada},style:[i.estiloLayout],on:{click:i.playAudio}},[t("div",{ref:"texto",staticClass:"texto",style:[i.estiloFormato,i.estiloFontSize,i.estiloVisibilidadTexto],on:{click:i.iniciarEdicionTexto}},[i._v(i._s(i.esteCuadroTexto.texto))]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:i.nuevoTexto,expression:"nuevoTexto"},{name:"show",rawName:"v-show",value:i.editandoTexto,expression:"editandoTexto"}],ref:"inputNuevoTexto",style:[i.estiloFormato,i.estiloFontSizeInput],attrs:{id:"inputNuevoTexto"},domProps:{value:i.nuevoTexto},on:{input:function(o){o.target.composing||(i.nuevoTexto=o.target.value)}}}),t("textarea",{directives:[{name:"model",rawName:"v-model",value:i.nuevoTexto,expression:"nuevoTexto"}],ref:"dummyInput",style:[i.estiloFormato,i.estiloInputDummy],attrs:{id:"dummyInputTexto"},domProps:{value:i.nuevoTexto},on:{input:function(o){o.target.composing||(i.nuevoTexto=o.target.value)}}}),t("img",{directives:[{name:"show",rawName:"v-show",value:i.editandoTexto,expression:"editandoTexto"}],attrs:{src:e("4fc3"),alt:"guardar",title:"Guardar cambios",id:"bGuardarTexto"},on:{click:function(o){return o.stopPropagation(),i.guardarNuevoTexto(o)}}}),t("img",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],attrs:{src:e("2191"),alt:"Eliminar",title:"Eliminar cuadro de texto",id:"bEliminarCuadroTexto"},on:{click:i.eliminarse}}),t("div",{ref:"textoDummy",staticClass:"textoDummy",style:[i.estiloFormato,i.estiloDummy]},[i._v(" "+i._s(i.esteCuadroTexto.texto)+" ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],attrs:{id:"zHandlers"}},[t("div",{staticClass:"zHandler",attrs:{id:"bSendBack",title:"Mover hacia atrás"},on:{click:function(o){i.posicionZeta=i.posicionZeta>0?i.posicionZeta-1:0}}}),t("div",{staticClass:"zHandler",attrs:{id:"bBringFront",title:"Mover hacia adelante"},on:{click:function(o){i.posicionZeta++}}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:i.sizeDragHandle,attrs:{id:"dragHandle"},on:{mousedown:function(o){return!o.type.indexOf("key")&&i._k(o.keyCode,"left",37,o.key,["Left","ArrowLeft"])||"button"in o&&0!==o.button?null:(o.stopPropagation(),i.iniciarDrag(o))},mousemove:i.drag,mouseup:i.finDrag}},[t("div",{class:{enDuda:i.posicionZeta!=i.esteCuadroTexto.posicionZeta},attrs:{id:"bolitaDragHandle",title:"Arrastrar"}},[i._v(i._s(i.posicionZeta))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:[i.sizeResizeHandle],attrs:{id:"resizeHandle"},on:{mousedown:function(o){return!o.type.indexOf("key")&&i._k(o.keyCode,"left",37,o.key,["Left","ArrowLeft"])||"button"in o&&0!==o.button?null:(o.stopPropagation(),i.iniciarResize(o))},mousemove:i.resize,mouseup:i.finResize}},[t("div",{attrs:{id:"bolitaResizeHandle"}})]),i.esteCuadroTexto.audio?t("audio",{ref:"audio",attrs:{type:"audio/ogg"}},[t("source",{attrs:{src:i.urlAudio,type:"audio/ogg"}})]):i._e()])},K=[],X={name:"CuadroTexto",props:{idLibro:String,idPagina:String,esteCuadroTexto:Object,sizePagina:Object,seleccionado:Boolean,paginaSeleccionada:Boolean,zBase:Number},data:function(){return{fontSizeDummy:10,fontSizeInputDummy:10,fontSizeTexto:10,fontSizeInput:10,resizing:!1,dragging:!1,posicionZeta:0,posicion:{x:null,y:null},size:{x:null,y:null},updatingInfo:!1,nuevoTexto:null,editandoTexto:!1}},computed:{estiloLayout:function(){return{top:this.posicion.y+"%",left:this.posicion.x+"%",width:this.size.x+"%",height:this.size.y+"%",zIndex:this.seleccionado?this.zBase+this.posicionZeta+100:this.zBase+this.posicionZeta}},estiloFormato:function(){return{textAlign:this.esteCuadroTexto.formato.alineacion,color:this.esteCuadroTexto.formato.colorLetra,fontFamily:this.esteCuadroTexto.formato.tipoLetra+", 'Nunito', sans-serif"}},estiloFontSize:function(){return{fontSize:this.fontSizeTexto+"px"}},estiloVisibilidadTexto:function(){return{visibility:this.editandoTexto?"hidden":"visible"}},estiloFontSizeInput:function(){return{fontSize:this.fontSizeInput+"px"}},estiloDummy:function(){return{fontSize:this.fontSizeDummy+"px"}},estiloInputDummy:function(){return{fontSize:this.fontSizeInputDummy+"px"}},sizeResizeHandle:function(){return{width:this.resizing?"200px":"10px",height:this.resizing?"200px":"10px"}},sizeDragHandle:function(){return{width:this.dragging?"200px":"10px",height:this.dragging?"200px":"10px"}},urlAudio:function(){return this.serverUrl+"/apiCuentos/audioTexto/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroTexto.id}},methods:{playAudio:function(){this.esteCuadroTexto.audio&&(console.log("Reproduciendo"),this.$refs.audio.play())},iniciarResize:function(){this.resizing=!0},resize:function(i){if(this.resizing){var o={x:this.$el.getBoundingClientRect().left,y:this.$el.getBoundingClientRect().top},e=i.clientX-o.x-5,t=i.clientY-o.y-5;if(e<15||t<15)return void console.log("Offlimits");var n=Math.round(100*e/this.sizePagina.x),a=Math.round(100*t/this.sizePagina.y);this.posicion.x+n>100&&(n=Math.floor(100-this.posicion.x)),this.posicion.y+a>100&&(a=Math.floor(100-this.posicion.y)),this.$set(this.size,"x",n),this.$set(this.size,"y",a)}},finResize:function(){var i=this;this.resizing=!1,this.fontSizeDummy=10,this.$nextTick((function(){i.findFontSize(),i.$apollo.mutate({mutation:Object(k["gql"])(r||(r=Object($["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $idCuadroTexto: ID!\n              $nuevoSize: CoordsInput!\n            ) {\n              updateSizeCuadroTexto(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                idCuadroTexto: $idCuadroTexto\n                nuevoSize: $nuevoSize\n              ) {\n                id\n                size {\n                  x\n                  y\n                }\n              }\n            }\n          "]))),variables:{idLibro:i.idLibro,idPagina:i.idPagina,idCuadroTexto:i.esteCuadroTexto.id,nuevoSize:i.size}})}))},findFontSize:function(){var i=this;if(this.esteCuadroTexto&&this.esteCuadroTexto.texto&&!(this.esteCuadroTexto.texto.length<1)){var o=this.$refs.texto.offsetHeight,e=this.$refs.textoDummy.offsetHeight,t=this.$refs.textoDummy.scrollWidth,n=this.$refs.texto.offsetWidth;e>=o||t>=n?(this.fontSizeDummy=this.fontSizeDummy-2,this.$nextTick((function(){var o=i.$refs.texto.offsetHeight,e=i.$refs.textoDummy.offsetHeight,t=i.$refs.textoDummy.scrollWidth,n=i.$refs.texto.offsetWidth;if(e<o&&t<n||i.fontSizeDummy<5)return i.fontSizeTexto=i.fontSizeDummy,void(i.fontSizeInput=i.fontSizeDummy);i.findFontSize()}))):e<o&&t<n&&(this.fontSizeDummy=this.fontSizeDummy+2,this.$nextTick((function(){var o=i.$refs.texto.offsetHeight,e=i.$refs.textoDummy.offsetHeight,t=i.$refs.textoDummy.scrollWidth,n=i.$refs.texto.offsetWidth;if(e>=o||t>=n||i.fontSizeDummy>100)return i.fontSizeDummy=i.fontSizeDummy-2,console.log("Quedó en ".concat(i.fontSizeDummy)),i.fontSizeTexto=i.fontSizeDummy,void(i.fontSizeInput=i.fontSizeDummy);i.findFontSize()})))}},findFontSizeInput:function(){var i=this;if(this.nuevoTexto&&!(this.nuevoTexto.length<1)){var o=this.$refs.inputNuevoTexto.offsetHeight,e=this.$refs.dummyInput.scrollHeight,t=this.$refs.dummyInput.scrollWidth,n=this.$refs.inputNuevoTexto.offsetWidth;e>=o||t>=n?(this.fontSizeInputDummy=this.fontSizeInputDummy-2,this.$nextTick((function(){var o=i.$refs.inputNuevoTexto.offsetHeight,e=i.$refs.dummyInput.scrollHeight,t=i.$refs.dummyInput.scrollWidth,n=i.$refs.inputNuevoTexto.offsetWidth;e<o&&t<n||i.fontSizeInputDummy<5?i.fontSizeInput=i.fontSizeInputDummy:i.findFontSizeInput()}))):e<o&&t<n&&(this.fontSizeInputDummy=this.fontSizeInputDummy+2,this.$nextTick((function(){var o=i.$refs.inputNuevoTexto.offsetHeight,e=i.$refs.dummyInput.scrollHeight,t=i.$refs.dummyInput.scrollWidth,n=i.$refs.inputNuevoTexto.offsetWidth;if(e>=o||t>=n||i.fontSizeInputDummy>100)return i.fontSizeInputDummy=i.fontSizeInputDummy-2,void(i.fontSizeInput=i.fontSizeInputDummy);i.findFontSizeInput()})))}},guardarNuevoTexto:function(){var i=this;if(this.nuevoTexto.length>3e3)alert("Texto demasiado largo");else{if(this.nuevoTexto==this.esteCuadroTexto.texto)return console.log("Texto no modificado"),void(this.editandoTexto=!1);this.updatingInfo=!0,this.$apollo.mutate({mutation:Object(k["gql"])(u||(u=Object($["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $idCuadroTexto: ID!\n              $nuevoTexto: String!\n            ) {\n              updateTextoCuadroTextoCuento(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                idCuadroTexto: $idCuadroTexto\n                nuevoTexto: $nuevoTexto\n              ) {\n                id\n                texto\n              }\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroTexto:this.esteCuadroTexto.id,nuevoTexto:this.nuevoTexto}}).then((function(){i.editandoTexto=!1,i.updatingInfo=!1})).catch((function(o){console.log("Error. E: ".concat(o)),i.updatingInfo=!1}))}},iniciarEdicionTexto:function(){var i=this;this.seleccionado&&(this.fontSizeInput=this.fontSizeTexto,this.fontSizeInputDummy=this.fontSizeTexto,this.nuevoTexto=this.esteCuadroTexto.texto,this.editandoTexto=!0,this.$nextTick((function(){i.$refs.inputNuevoTexto.focus()})))},iniciarDrag:function(){this.dragging=!0},drag:function(i){if(this.dragging){console.log("Dragging");var o=this.$el.closest(".pagina"),e=o.getBoundingClientRect(),t={x:i.clientX-e.left,y:i.clientY-e.top},n={x:t.x-this.$el.offsetWidth/2,y:t.y+20};n.x+this.$el.offsetWidth>o.offsetWidth&&(n.x=o.offsetWidth-this.$el.offsetWidth),n.x<0&&(n.x=0),n.y+this.$el.offsetHeight>o.offsetHeight&&(n.y=o.offsetHeight-this.$el.offsetHeight),n.y<0&&(n.y=0);var a={x:Math.round(100*n.x/o.offsetWidth),y:Math.round(100*n.y/o.offsetHeight)};this.posicion=a}},finDrag:function(){this.dragging=!1,this.$apollo.mutate({mutation:Object(k["gql"])(d||(d=Object($["a"])(["\n          mutation(\n            $idLibro: ID!\n            $idPagina: ID!\n            $idCuadroTexto: ID!\n            $nuevoPosicion: CoordsInput!\n          ) {\n            updatePosicionCuadroTexto(\n              idLibro: $idLibro\n              idPagina: $idPagina\n              idCuadroTexto: $idCuadroTexto\n              nuevoPosicion: $nuevoPosicion\n            ) {\n              id\n              posicion {\n                x\n                y\n              }\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroTexto:this.esteCuadroTexto.id,nuevoPosicion:this.posicion}})},eliminarse:function(){var i=this;confirm("Eliminando cuadro de texto. Esta operación no se puede deshacer. ¿Continuar?")&&(this.updatingInfo=!0,console.log("Eliminando un cuadro de texto"),this.$apollo.mutate({mutation:Object(k["gql"])(c||(c=Object($["a"])(["\n            mutation($idLibro: ID!, $idPagina: ID!, $idCuadroTexto: ID!) {\n              eliminarCuadroTextoLibro(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                idCuadroTexto: $idCuadroTexto\n              )\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroTexto:this.esteCuadroTexto.id}}).then((function(o){var e=o.data.eliminarCuadroTextoLibro;console.log("Resultado: ".concat(e)),e&&i.$emit("meElimine")})).catch((function(o){console.log("Error. E: ".concat(o)),i.updatingInfo=!1})))},guardarPosicionZeta:R()((function(){console.log("Guardando posición zeta"),this.posicionZeta!=this.esteCuadroTexto.posicionZeta&&this.$apollo.mutate({mutation:Object(k["gql"])(l||(l=Object($["a"])(["\n          mutation($idLibro:ID!, $idPagina:ID!, $idCuadroTexto:ID!, $nuevoPosicionZ:Int!){\n            setPosicionZCuadroTexto(idLibro:$idLibro, idPagina:$idPagina, idCuadroTexto:$idCuadroTexto, nuevoPosicionZ:$nuevoPosicionZ){\n              id\n              posicionZeta\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroTexto:this.esteCuadroTexto.id,nuevoPosicionZ:this.posicionZeta}})}),3e3)},watch:{nuevoTexto:function(){var i=this;this.$nextTick((function(){i.findFontSizeInput()}))},esteCuadroTexto:function(){var i=this;this.$nextTick((function(){i.findFontSize()}))},seleccionado:function(i){0==i&&(this.editandoTexto=!1)},posicionZeta:function(){console.log("Cambio de posicion zeta"),this.guardarPosicionZeta()}},mounted:function(){var i=this;this.$set(this.posicion,"x",this.esteCuadroTexto.posicion.x),this.$set(this.posicion,"y",this.esteCuadroTexto.posicion.y),this.$set(this.size,"x",this.esteCuadroTexto.size.x),this.$set(this.size,"y",this.esteCuadroTexto.size.y),this.posicionZeta=this.esteCuadroTexto.posicionZeta,this.$nextTick((function(){i.findFontSize()}))}},_=X,ii=(e("0d62"),Object(J["a"])(_,Y,K,!1,null,null,null)),oi=ii.exports,ei=function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("div",{attrs:{id:"herramientasEdicion"}},[t("img",{staticClass:"bHerramientasEdicion",class:{hSeleccionada:"puntero"==i.herramientaSeleccionada},attrs:{src:e("4a8c")},on:{click:function(o){o.stopPropagation(),i.$emit("puntero"),i.herramientaSeleccionada="puntero"},mousedown:function(i){i.stopPropagation()}}}),t("img",{staticClass:"bHerramientasEdicion",class:{hSeleccionada:"texto"==i.herramientaSeleccionada},attrs:{src:e("28b8")},on:{click:function(o){o.stopPropagation(),i.$emit("creacionTexto"),i.herramientaSeleccionada="texto"},mousedown:function(i){i.stopPropagation()}}}),t("img",{staticClass:"bHerramientasEdicion",class:{hSeleccionada:"imagen"==i.herramientaSeleccionada},attrs:{src:e("885c")},on:{click:function(o){o.stopPropagation(),i.$emit("creacionImagen"),i.herramientaSeleccionada="imagen"},mousedown:function(i){i.stopPropagation()}}})])},ti=[],ni={name:"HerramientasEdicion",data:function(){return{herramientaSeleccionada:"puntero"}},methods:{reset:function(){this.herramientaSeleccionada="puntero"}}},ai=ni,si=(e("0705"),Object(J["a"])(ai,ei,ti,!1,null,"2c9e7702",null)),ri=si.exports,ui={components:{CuadroImagen:G,CuadroTexto:oi,HerramientasEdicion:ri},name:"Pagina",props:{estaPagina:Object,paginaDerecha:Boolean,preparada:{type:Boolean,default:!1},visible:{type:Boolean},idLibro:String,seleccionada:Boolean,segundoPlano:{type:Boolean,default:!1}},data:function(){return{ancho:450,alto:600,uploadingInfo:!1,colorSeleccionado:"#ffffff",creandoTexto:!1,creandoImagen:!1,dibujandoTexto:!1,dibujandoImagen:!1,zElementos:100,posFantasmaTexto:{x:0,y:0},sizeFantasmaTexto:{x:30,y:30},posFantasmaImagen:{x:0,y:0},sizeFantasmaImagen:{x:30,y:30},idElementoSeleccionado:null}},computed:{estiloColumna:function(){return this.paginaDerecha?{gridColumn:"1/2",justifySelf:"right"}:null},estiloSize:function(){return{width:this.ancho+"px",height:this.alto+"px"}},size:function(){return{x:this.ancho,y:this.alto}},estiloApariencia:function(){return{backgroundColor:this.colorSeleccionado}},estiloLayoutFantasmaTexto:function(){return{top:this.posFantasmaTexto.y+"px",left:this.posFantasmaTexto.x+"px",width:this.sizeFantasmaTexto.x+"px",height:this.sizeFantasmaTexto.y+"px"}},estiloLayoutFantasmaImagen:function(){return{top:this.posFantasmaImagen.y+"px",left:this.posFantasmaImagen.x+"px",width:this.sizeFantasmaImagen.x+"px",height:this.sizeFantasmaImagen.y+"px"}}},methods:{eliminarse:function(){var i=this;confirm("Eliminando página. Esta operación no se puede deshacer. ¿Continuar?")&&(this.uploadingInfo=!0,console.log("Eliminando una página"),this.$apollo.mutate({mutation:Object(k["gql"])(A||(A=Object($["a"])(["\n            mutation($idLibro: ID!, $idPagina: ID!) {\n              eliminarPaginaDeLibro(idLibro: $idLibro, idPagina: $idPagina)\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.estaPagina.id}}).then((function(o){var e=o.data.eliminarPaginaDeLibro;console.log("Resultado: ".concat(e)),e&&i.$emit("meElimine")})).catch((function(o){console.log("Error. E: ".concat(o)),i.uploadingInfo=!1})))},desactivarHerramientas:function(){this.creandoTexto=!1,this.creandoImagen=!1},accionCrearElemento:function(i){var o=this.$el.getBoundingClientRect(),e={x:i.clientX-o.left,y:i.clientY-o.top};this.creandoTexto?(this.dibujandoTexto=!0,this.$set(this.posFantasmaTexto,"x",Math.floor(e.x)),this.$set(this.posFantasmaTexto,"y",Math.floor(e.y)),this.$set(this.sizeFantasmaTexto,"x",30),this.$set(this.sizeFantasmaTexto,"y",30)):this.creandoImagen&&(this.dibujandoImagen=!0,this.$set(this.posFantasmaImagen,"x",Math.floor(e.x)),this.$set(this.posFantasmaImagen,"y",Math.floor(e.y)),this.$set(this.sizeFantasmaImagen,"x",30),this.$set(this.sizeFantasmaImagen,"y",30))},resizeFantasmaElemento:function(i){var o=this.$el.getBoundingClientRect(),e={x:i.clientX-o.left,y:i.clientY-o.top};if(this.dibujandoTexto){var t={x:e.x-this.posFantasmaTexto.x,y:e.y-this.posFantasmaTexto.y};t.x<30&&(t.x=30),t.y<30&&(t.y=30),this.$set(this.sizeFantasmaTexto,"x",Math.floor(t.x)),this.$set(this.sizeFantasmaTexto,"y",Math.floor(t.y))}if(this.dibujandoImagen){var n={x:e.x-this.posFantasmaImagen.x,y:e.y-this.posFantasmaImagen.y};n.x<30&&(n.x=30),n.y<30&&(n.y=30),this.$set(this.sizeFantasmaImagen,"x",Math.floor(n.x)),this.$set(this.sizeFantasmaImagen,"y",Math.floor(n.y))}},endDibujandoElemento:function(){this.dibujandoTexto?(console.log("Creando cuadroTexto"),this.dibujandoTexto=!1,this.$refs.herramientasEdicion.reset(),this.crearTextoFromFantasma()):this.dibujandoImagen&&(console.log("Creando cuadro de imágen"),this.dibujandoImagen=!1,this.$refs.herramientasEdicion.reset(),this.crearCuadroImagenFromFantasma()),this.desactivarHerramientas()},crearCuadroImagenFromFantasma:function(){var i=this,o={x:Math.round(100*this.posFantasmaImagen.x/this.$el.offsetWidth),y:Math.round(100*this.posFantasmaImagen.y/this.$el.offsetHeight)},e={x:Math.round(100*this.sizeFantasmaImagen.x/this.$el.offsetWidth),y:Math.round(100*this.sizeFantasmaImagen.y/this.$el.offsetHeight)};this.$apollo.mutate({mutation:Object(k["gql"])(m||(m=Object($["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $datosPosicion: CoordsInput!\n              $datosSize: CoordsInput!\n            ) {\n              crearCuadroImagenPaginaLibro(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                datosPosicion: $datosPosicion\n                datosSize: $datosSize\n              ) {\n                ...fragCuadroImagen\n              }\n            }\n            ","\n          "])),gi),variables:{idLibro:this.idLibro,idPagina:this.estaPagina.id,datosPosicion:o,datosSize:e}}).then((function(o){var e=o.data.crearCuadroImagenPaginaLibro;i.$emit("tengoNuevoCuadroImagen",e)})).catch((function(i){console.log("Error en mutación de crear cuadro imágen. E: ".concat(i))}))},crearTextoFromFantasma:function(){var i=this;console.log("Enviando con ".concat(JSON.stringify(this.idLibro),", ").concat(JSON.stringify(this.estaPagina.id),", ").concat(JSON.stringify(this.posFantasmaTexto),", ").concat(JSON.stringify(this.sizeFantasmaTexto)));var o={x:Math.round(100*this.posFantasmaTexto.x/this.$el.offsetWidth),y:Math.round(100*this.posFantasmaTexto.y/this.$el.offsetHeight)},e={x:Math.round(100*this.sizeFantasmaTexto.x/this.$el.offsetWidth),y:Math.round(100*this.sizeFantasmaTexto.y/this.$el.offsetHeight)};this.$apollo.mutate({mutation:Object(k["gql"])(g||(g=Object($["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $datosPosicion: CoordsInput!\n              $datosSize: CoordsInput!\n            ) {\n              crearCuadroTextoPaginaLibro(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                datosPosicion: $datosPosicion\n                datosSize: $datosSize\n              ) {\n                ...fragCuadroTexto\n              }\n            }\n            ","\n          "])),mi),variables:{idLibro:this.idLibro,idPagina:this.estaPagina.id,datosPosicion:o,datosSize:e},errorPolicy:"all"}).then((function(o){var e=o.data.crearCuadroTextoPaginaLibro;i.$emit("tengoNuevoCuadroTexto",e)})).catch((function(i){console.log("Error. E: ".concat(i.message)),console.log("Hubo ".concat(i.graphQLErrors," errores graphql"))}))},resolverSeleccion:function(i,o){this.seleccionada&&(i.stopPropagation(),this.idElementoSeleccionado=o)},guardarNuevoColor:function(){var i=this;console.log("Guardando nuevo color de página."),this.$apollo.mutate({mutation:Object(k["gql"])(h||(h=Object($["a"])(["\n          mutation($idLibro:ID!, $idPagina:ID!, $nuevoColor:String!){\n            setNuevoColorPaginaLibro(idLibro:$idLibro, idPagina: $idPagina, nuevoColor:$nuevoColor){\n              id\n              color\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.estaPagina.id,nuevoColor:this.$refs.inputColorPagina.value}}).then((function(){console.log("Nuevo color guardado")})).catch((function(o){console.log("Error guardando el nuevo color de página. E: ".concat(o)),i.colorSeleccionado=i.estaPagina.color}))}},mounted:function(){this.colorSeleccionado=this.estaPagina.color}},di=ui,ci=(e("3a36"),Object(J["a"])(di,F,N,!1,null,"aa2cb084",null)),li=ci.exports,Ai=/[^ a-zA-ZÀ-ž0-9_():.,-¿?¡!]/,mi=j()(f||(f=Object($["a"])(["\n  fragment fragCuadroTexto on CuadroTextoCuento {\n    id\n    texto\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n    formato {\n      fontSize\n      colorLetra\n      tipoLetra\n      alineacion\n    }\n  }\n"]))),gi=j()(p||(p=Object($["a"])(["\n  fragment fragCuadroImagen on CuadroImagenCuento {\n    id\n    sinArchivo\n    tipoActivacionSecundario\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n  }\n"]))),hi=j()(v||(v=Object($["a"])(["\n  fragment fragPagina on PaginaCuento {\n    id    \n    numPag\n    color\n    cuadrosTexto {\n      ...fragCuadroTexto\n    }\n    cuadrosImagen {\n      ...fragCuadroImagen\n    }\n  }\n  ","\n  ","\n"])),mi,gi),fi=j()(x||(x=Object($["a"])(["\n  query($idLibro: ID!) {\n    libro(idLibro: $idLibro) {\n      id\n      idsEditores\n      titulo\n      paginas {\n        ...fragPagina\n      }\n    }\n  }\n  ","\n"])),hi),pi={components:{Pagina:li},name:"Libro",apollo:{libro:{query:fi,variables:function(){return{idLibro:this.idLibro}},skip:function(){return null==this.idLibro},fetchPolicy:"cache-and-network"}},props:{idLibro:{type:String,default:null}},data:function(){return{libro:{paginas:null},idPaginaSeleccionada:null,creandoPagina:!1,nuevoTitulo:null,editandoTitulo:!1}},computed:{paginasOrdenadas:function(){if(this.libro.paginas){var i=this.libro.paginas;return i.sort((function(i,o){return parseInt(i.numPag)-parseInt(o.numPag)}))}return[]},nuevoTituloIlegal:function(){return!this.nuevoTitulo||this.nuevoTitulo.length<1||!!Ai.test(this.nuevoTitulo)}},methods:{toggleEditandoTitulo:function(){this.editandoTitulo=!this.editandoTitulo,this.nuevoTitulo=this.libro.titulo},guardarNuevoTitulo:function(){var i=this;this.nuevoTituloIlegal?console.log("No enviado"):this.nuevoTitulo!=this.libro.titulo?(console.log("guardando nuevo título"),this.enviandoNuevoTitulo=!0,this.$apollo.mutate({mutation:j()(b||(b=Object($["a"])(["\n            mutation($idLibro: ID!, $nuevoTitulo: String!) {\n              editarTituloLibro(idLibro: $idLibro, nuevoTitulo: $nuevoTitulo) {\n                id\n                titulo\n              }\n            }\n          "]))),variables:{idLibro:this.idLibro,nuevoTitulo:this.nuevoTitulo}}).then((function(){i.enviandoNuevoTitulo=!1,i.editandoTitulo=!1})).catch((function(o){i.enviandoNuevoTitulo=!1,console.log("Error. E :".concat(o))}))):this.editandoTitulo=!1},crearNuevaPaginaLibro:function(){var i=this;this.creandoPagina=!0;var o=this;this.$apollo.mutate({mutation:j()(y||(y=Object($["a"])(["\n            mutation($idLibro: ID!) {\n              crearNuevaPaginaLibro(idLibro: $idLibro) {\n                ...fragPagina\n              }\n            }\n            ","\n          "])),hi),variables:{idLibro:this.idLibro}}).then((function(e){var t=e.data.crearNuevaPaginaLibro,n=i.$apollo.provider.defaultClient,a=n.readQuery({query:fi,variables:{idLibro:o.idLibro}}),s=JSON.parse(JSON.stringify(a));s.libro.paginas.push(t),n.writeQuery({query:fi,variables:{idLibro:o.idLibro},data:s}),i.creandoPagina=!1})).catch((function(o){console.log("Error: ".concat(o)),i.creandoPagina=!1}))},removePaginaFromCache:function(i){this.idPaginaSeleccionada=null;var o=this.$apollo.provider.defaultClient,e=o.readQuery({query:fi,variables:{idLibro:this.idLibro}}),t=JSON.parse(JSON.stringify(e)),n=t.libro.paginas.findIndex((function(o){return o.id==i}));n>-1?(t.libro.paginas.splice(n,1),o.writeQuery({query:fi,variables:{idLibro:this.idLibro},data:t})):console.log("La pagina no estaba en el caché")},updateCacheConNuevoCuadroImagen:function(i,o){console.log("Se actualizara el cache con info: ".concat(i," en la pagina ").concat(o));var e=this.$apollo.provider.defaultClient,t=e.readQuery({query:fi,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==o}));a?a.cuadrosImagen.some((function(o){return o==i.id}))?console.log("Ese cuadro texto ya estaba incluido"):(a.cuadrosImagen.push(i),e.writeQuery({query:fi,variables:{idLibro:this.idLibro},data:n})):console.log("Pagina no existía")},updateCacheConNuevoCuadroTexto:function(i,o){console.log("Se actualizara el cache con info: ".concat(i," en la pagina ").concat(o));var e=this.$apollo.provider.defaultClient,t=e.readQuery({query:fi,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==o}));a?a.cuadrosTexto.some((function(o){return o==i.id}))?console.log("Ese cuadro texto ya estaba incluido"):(a.cuadrosTexto.push(i),e.writeQuery({query:fi,variables:{idLibro:this.idLibro},data:n})):console.log("Pagina no existía")},removeCuadroTextoFromCache:function(i,o){var e=this.$apollo.provider.defaultClient,t=e.readQuery({query:fi,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==o}));if(a){var s=a.cuadrosTexto.findIndex((function(o){return o.id==i}));s>-1?(a.cuadrosTexto.splice(s,1),e.writeQuery({query:fi,variables:{idLibro:this.idLibro},data:n})):console.log("El cuadro texto no existía en el caché")}else console.log("No existía la pagina en el caché")},removeCuadroImagenFromCache:function(i,o){var e=this.$apollo.provider.defaultClient,t=e.readQuery({query:fi,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==o}));if(a){var s=a.cuadrosImagen.findIndex((function(o){return o.id==i}));s>-1?(a.cuadrosImagen.splice(s,1),e.writeQuery({query:fi,variables:{idLibro:this.idLibro},data:n})):console.log("El cuadro texto no existía en el caché")}else console.log("No existía la pagina en el caché")}}},vi=pi,xi=(e("d0e4"),Object(J["a"])(vi,D,M,!1,null,"038b7b99",null)),bi=xi.exports,yi=function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("div",{attrs:{id:"misLibros"}},[t("h3",[i._v("Mis libros")]),t("div",{attrs:{id:"controlesMisLibros"}},[t("img",{staticClass:"bControlMisLibros",attrs:{src:e("1d2e"),title:"Crear nuevo libro"},on:{click:i.crearNuevoLibro}})]),t("div",{attrs:{id:"listaMisLibros"}},i._l(i.misLibros,(function(o){return t("div",{key:o.id,staticClass:"portadaLibro",on:{click:function(e){return i.seleccionarLibro(o.id)}}},[i._v(" "+i._s(o.titulo)+" ")])})),0)])},Ci=[],Ti=Object(k["gql"])(C||(C=Object($["a"])(["\n  query {\n    misLibros {\n      id\n      titulo\n    }\n  }\n"]))),Ii={name:"MisLibros",apollo:{misLibros:{query:Ti,skip:function(){return null==this.usuario.id}}},data:function(){return{}},methods:{crearNuevoLibro:function(){var i=this;confirm("¿Crear un nuevo libro?")&&this.$apollo.mutate({mutation:Object(k["gql"])(T||(T=Object($["a"])(["\n          mutation {\n            crearNuevoLibro {\n              id\n              titulo\n            }\n          }\n        "])))}).then((function(o){var e=o.data.crearNuevoLibro;console.log("Creado ".concat(JSON.stringify(e)));var t=i.$apollo.provider.defaultClient,n=t.readQuery({query:Ti}),a=JSON.parse(JSON.stringify(n));a.misLibros.some((function(i){return i.id==e.id}))?console.log("El libro ya estaba incluido en el caché"):(a.misLibros.push(e),t.writeQuery({query:Ti,data:a}))}))},seleccionarLibro:function(i){this.$emit("libroSeleccionado",i)}}},Pi=Ii,zi=(e("dd1f"),Object(J["a"])(Pi,yi,Ci,!1,null,"24147a09",null)),Li=zi.exports,Si=function(){var i=this,o=i.$createElement,e=i._self._c||o;return e("div",{attrs:{id:"todosLibros"}},[e("h3",[i._v("Todos los libros")]),e("div",{attrs:{id:"controlesTodosLibros"}}),e("div",{attrs:{id:"listaMisLibros"}},i._l(i.todosLibros,(function(o){return e("div",{key:o.id,staticClass:"portadaLibro",on:{click:function(e){return i.seleccionarLibro(o.id)}}},[i._v(" "+i._s(o.titulo)+" "),i._l(o.idsEditores,(function(i){return e("icono-persona-autonomo",{key:i,attrs:{idPersona:i}})}))],2)})),0)])},Ei=[],wi=function(){var i=this,o=i.$createElement,e=i._self._c||o;return e("div",{staticClass:"iconoPersonaAutonomo",class:{yo:i.soyYo,seleccionado:i.seleccionado}},[e("img",{directives:[{name:"show",rawName:"v-show",value:i.fotografiaEnabled,expression:"fotografiaEnabled"}],staticClass:"fotografia",attrs:{src:this.serverUrl+"/api/usuarios/fotografias/"+i.idPersona,alt:""},on:{load:function(o){i.fotografiaEnabled=!0}}}),e("div",{attrs:{id:"contenedorAlertas"}},[i._t("alertas")],2),e("div",{staticClass:"nombres",class:{nombreSeleccionado:i.seleccionado}},[i._v(" "+i._s(i.estaPersona.nombres)+" ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:i.menuContextual,expression:"menuContextual"}],attrs:{id:"menuCxPersona"}},[e("div",{staticClass:"botonMenuCx",on:{click:function(o){return o.stopPropagation(),i.copiarId(o)}}},[i._v(i._s(i.idPersona))]),i.usuarioSuperadministrador?e("div",{staticClass:"botonMenuCx"},[i._v(" "+i._s(i.estaPersona.username)+" ")]):i._e(),e("input",{directives:[{name:"model",rawName:"v-model",value:i.nuevoPermiso,expression:"nuevoPermiso"}],attrs:{type:"text",placeholder:"Nuevo permiso"},domProps:{value:i.nuevoPermiso},on:{input:function(o){o.target.composing||(i.nuevoPermiso=o.target.value)}}}),e("div",{staticClass:"botonMenuCx",on:{click:function(o){return o.stopPropagation(),i.addPermisos(o)}}},[i._v("Dar permiso")]),i._l(i.opcionesMenuCx,(function(o,t){return e("div",{key:t,staticClass:"botonMenuCx",on:{click:function(e){return i.$emit(o.evento)}}},[i._v(" "+i._s(o.textoVisible)+" ")])}))],2)])},Di=[],Mi=(e("498a"),j()(I||(I=Object($["a"])(["\n  query($idUsuario: ID!) {\n    publicUsuario(idUsuario: $idUsuario) {\n      id\n      nombres\n      apellidos\n      username\n    }\n  }\n"])))),$i={name:"IconoPersonaAutonomo",apollo:{estaPersona:{query:Mi,variables:function(){return{idUsuario:this.idPersona}},update:function(i){var o=i.publicUsuario;return o},skip:function(){return!this.idPersona}}},data:function(){return{estaPersona:{permisos:[]},nuevoPermiso:null,mounted:!1,fotografiaEnabled:!1}},props:{idPersona:String,seleccionado:Boolean,menuContextual:Boolean,opcionesMenuCx:{type:Array}},computed:{soyYo:function(){return!!(this.mounted&&this.idPersona&&this.$store.state.usuario)&&this.$store.state.usuario.id==this.idPersona}},methods:{addPermisos:function(){console.log("enviando ".concat(this.nuevoPermiso," para el usuario con id ").concat(this.idPersona)),this.$apollo.mutate({mutation:j()(P||(P=Object($["a"])(["\n            mutation($nuevoPermiso: String!, $idUsuario: ID!) {\n              addPermisoUsuario(\n                nuevoPermiso: $nuevoPermiso\n                idUsuario: $idUsuario\n              ) {\n                id\n                permisos\n              }\n            }\n          "]))),variables:{nuevoPermiso:this.nuevoPermiso,idUsuario:this.idPersona}}).then((function(){})).catch((function(i){console.log("error: "+i)}))},copiarId:function(i){var o=i.target.innerText.trim(),e=document.createElement("textarea");e.value=o,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)},fotografiaCargada:function(){console.log("Fotografía cargada")}},mounted:function(){this.mounted=!0},beforeRouteUpdate:function(){console.log("Before update")}},Oi=$i,ji=(e("699c"),Object(J["a"])(Oi,wi,Di,!1,null,"1d1d781e",null)),Fi=ji.exports,Ni=Object(k["gql"])(z||(z=Object($["a"])(["\n  query {\n    todosLibros {\n      id\n      titulo\n      idsEditores\n    }\n  }\n"]))),ki={components:{IconoPersonaAutonomo:Fi},name:"TodosLibros",apollo:{todosLibros:{query:Ni,skip:function(){return!this.usuarioSuperadministrador}}},data:function(){return{}},methods:{seleccionarLibro:function(i){this.$emit("libroSeleccionado",i)}},computed:{usuarioSuperadministrador:function(){return this.usuario&&this.usuario.permisos?(console.log("Usuario tiene permisos: ".concat(this.usuario.permisos)),this.usuario.permisos.includes("superadministrador")):(console.log("Datos insuficientes para decidir si usuario es súperadministrador"),!1)}}},Bi=ki,Ui=(e("ef95"),Object(J["a"])(Bi,Si,Ei,!1,null,"1567976c",null)),Qi=Ui.exports,Zi={name:"App",components:{Libro:bi,MisLibros:Li,TodosLibros:Qi},data:function(){return{idLibroSeleccionado:null}},methods:{seleccionarLibro:function(i){this.idLibroSeleccionado=i}},computed:{usuarioSuperadministrador:function(){return!!(this.usuario&&this.usuario.id&&this.usuario.permisos.includes("superadministrador"))}},mounted:function(){var i=window.location.search.substring(1),o=new URLSearchParams(i);this.idLibro=o.get("id");var e=o.get("t");e&&e.length>10?(this.$store.commit("setToken",e),this.$store.commit("setUserInfo",e),localStorage.setItem("token",e)):(this.$store.commit("deslogearse"),localStorage.clear())}},Hi=Zi,Ri=(e("034f"),Object(J["a"])(Hi,E,w,!1,null,null,null)),qi=Ri.exports,Vi=e("5530"),Ji=(e("d81d"),e("09bf")),Wi=e("e312"),Gi=e("b7cf"),Yi=e("522d"),Ki=j()(L||(L=Object($["a"])(["\n    \n    enum TiposUsuario{\n        USUARIO,\n        ADMINISTRADOR,\n        SUPERADMINSTRADOR\n    }\n    \n    type Usuario{\n        username:String,\n        permisos: TiposUsuario\n     }\n\n    type Mutations{ \n        setUsuario(username: String, permisos: TiposUsuario):Usuario\n    }\n"]))),Xi={},_i=e("11c2"),io=e("a000"),oo=e("36f1"),eo=e("f5a8"),to=e("a1b6");S["a"].use(Yi["a"]);var no=new Wi["a"],ao=function(){return localStorage.getItem("token")},so="https://pe-pe-pe.herokuapp.com",ro="wss://"+so.substr(7)+"/subscripciones",uo=Object(Gi["a"])({uri:so+"/graphql"}),co=new io["a"]({uri:ro,options:{reconnect:!0,connectionParams:{headers:{Authorization:"Bearer ".concat(ao())}}}}),lo=Object(eo["a"])((function(i,o){var e=o.headers;return{headers:Object(Vi["a"])(Object(Vi["a"])({},e),{},{authorization:ao()})}})),Ao=Object(to["a"])((function(i){i.graphQLErrors,i.networkError})),mo=Ao.concat(lo).concat(uo),go=Object(_i["split"])((function(i){var o=i.query,e=Object(oo["l"])(o);return"OperationDefinition"===e.kind&&"subscription"===e.operation}),co,mo),ho=new Ji["a"]({link:go,cache:no,typeDefs:Ki,resolvers:Xi,connectToDevTools:!0}),fo=new Yi["a"]({defaultClient:ho}),po=(e("1276"),e("5319"),e("a15b"),e("fb6a"),e("25f0"),e("2f62"));function vo(i){var o=i.split(".")[1],e=o.replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(e).split("").map((function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(t)}S["a"].use(po["a"]);var xo=new po["a"].Store({state:{token:null,usuario:{username:null,nombres:null,id:null,permisos:[]}},mutations:{setToken:function(i,o){i.token=o},setUserInfo:function(i,o){var e=vo(o);i.usuario.username=e.username,i.usuario.id=e.id,i.usuario.permisos=e.permisos},deslogearse:function(i){i.usuario.username=null,i.usuario.id=null,i.token=null}}});S["a"].config.productionTip=!1,S["a"].mixin({data:function(){return{serverUrl:so}},computed:{usuario:function(){return this.$store.state.usuario},usuarioSuperadministrador:function(){return this.$store.state.usuario.permisos.includes("superadministrador")}}}),new S["a"]({render:function(i){return i(qi)},store:xo,apolloProvider:fo}).$mount("#app")},6:function(i,o){},"699c":function(i,o,e){"use strict";e("b13e")},7:function(i,o){},8:function(i,o){},"85ec":function(i,o,e){},"885c":function(i,o){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAjVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADqhzP4AAAALnRSTlMA3x8j4xUmzPyx3gFmiAfUqRhE9zoq6dqbDrl9bu/DoJSCaVtQQPKzpnVfVUo0WjuT0wAAAcBJREFUWMPt2NlygjAAhWEhhoSwr+5LXbr3vP/jdZg6NYoaQ3LRsfx3evENkAUmg76+Ry6grlE0OPWqiAnHIMGiSvY8H8b5nnS/ESwUHe+aMhsgo7+gK9BUOx2r0STcI+g0f6xKt2PlCgCcM7AuB50r6xYo/9bPG/49MM7cLLYH0jBNRJKG1BKY+xxN3M+tgDk7TubcAkh9eQVTczDkEshDYzBOIZfGpmCWQC7JTEFXSNxhSyC2r5DYfobE9igTm/NQDyThbEsVK0UH3E85eFrdWstaYDVF0ytR7TbEuQukK/w0zhT7oQJsv63Xk8GlNMF5gd+i2BzcDnGMzwJTcM8gV7xJz9aj+mD1gtMWm8Gh3ctw+qkLTsY4b/h+WHkjAOxTDwye0G700UyX2QJNy70OKA+wLG5IOeb4afqlAX44uFjh1NK2UN0Nlgz39EpUoO738ThTg/IAq1tP1KA8wOqiWA1unjVA/hSowJ1QM+0V6V4FyyX0ep7fBEkK3erwBjhZQz9nex2ccXQo2V0DwwU6xfLL4HyEji3fL4HFCJ1LihZoWg/+Q1DYAIVr/RDD+jGL7YMgy0dVnvXDtL6+B+4bd8GYEidpbS8AAAAASUVORK5CYII="},9:function(i,o){},9262:function(i,o,e){},b13e:function(i,o,e){},bf1b:function(i,o,e){"use strict";e("9262")},d0e4:function(i,o,e){"use strict";e("4cb3")},dd1f:function(i,o,e){"use strict";e("5301")},df69:function(i,o){i.exports="data:image/png;base64,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"},e3b7:function(i,o,e){},ef95:function(i,o,e){"use strict";e("e3b7")},fef7:function(i,o,e){}});
//# sourceMappingURL=app.6f3ef6a9.js.map