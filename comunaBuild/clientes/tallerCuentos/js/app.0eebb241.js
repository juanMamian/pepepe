(function(i){function e(e){for(var t,s,r=e[0],u=e[1],d=e[2],l=0,A=[];l<r.length;l++)s=r[l],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&A.push(n[s][0]),n[s]=0;for(t in u)Object.prototype.hasOwnProperty.call(u,t)&&(i[t]=u[t]);c&&c(e);while(A.length)A.shift()();return a.push.apply(a,d||[]),o()}function o(){for(var i,e=0;e<a.length;e++){for(var o=a[e],t=!0,r=1;r<o.length;r++){var u=o[r];0!==n[u]&&(t=!1)}t&&(a.splice(e--,1),i=s(s.s=o[0]))}return i}var t={},n={app:0},a=[];function s(e){if(t[e])return t[e].exports;var o=t[e]={i:e,l:!1,exports:{}};return i[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=i,s.c=t,s.d=function(i,e,o){s.o(i,e)||Object.defineProperty(i,e,{enumerable:!0,get:o})},s.r=function(i){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},s.t=function(i,e){if(1&e&&(i=s(i)),8&e)return i;if(4&e&&"object"===typeof i&&i&&i.__esModule)return i;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),2&e&&"string"!=typeof i)for(var t in i)s.d(o,t,function(e){return i[e]}.bind(null,t));return o},s.n=function(i){var e=i&&i.__esModule?function(){return i["default"]}:function(){return i};return s.d(e,"a",e),e},s.o=function(i,e){return Object.prototype.hasOwnProperty.call(i,e)},s.p="/tallerCuentos/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],u=r.push.bind(r);r.push=e,r=r.slice();for(var d=0;d<r.length;d++)e(r[d]);var c=u;a.push([0,"chunk-vendors"]),o()})({0:function(i,e,o){i.exports=o("56d7")},"034f":function(i,e,o){"use strict";o("85ec")},"0705":function(i,e,o){"use strict";o("3593")},"0d62":function(i,e,o){"use strict";o("fef7")},1:function(i,e){},10:function(i,e){},11:function(i,e){},12:function(i,e){},13:function(i,e){},14:function(i,e){},"1d2e":function(i,e){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAzFBMVEUAAAC8i1q6i1zyu1n2vVq3kUr/tki6i1vyvFm5i1xmXWZ9c2W3il2xiF7kpVqQgmuziV7uuFmpg2GrhmChgmHuuFntuVquhl/TmlrTqmCrhmCvh1+yiF7OqWDHlVqmg2Kog2KigWONd2aDdG3uvVrzvFq7jF349uzkpVvyu1rxuVrVm1vlp1rrsFrorFrJpX/08OP37tnzw2zCmW7w6NrstFr169ns4tHnsG3Ut5fIoHPAkWD07+Pv4cfk1L/VupvNrInYpm3xwGzutFov9SsWAAAAJXRSTlMAH9/fHwcHt7d+Bg38ubca5LeUij7v3863tK+mpI+PbVtFLSMf1QcYpQAAAOxJREFUWMPt10eywjAMgOG8R0+l914EhE4SEnq7/51gCyEOGnvF6D/ANyNbG0kURVE/lhwLCcf1WrUEu3oe4+U1FcJKIbyuBmAtmKFAOQewdQ9LRq6FAY0SLOwhMxsF/v3DeSgY3IoGd65gEC4ne/NsFdBxt29GDQwIe+vqed5tHZDjFCIVAwMCTEajqTlgFIkSSCCBBBJIIIEEvoLmzJ8z5gHn/rjAwfhDvG/o0zhB0zcvF/j+L3c8mGaOjF8bpSp4D6W2KhhUsioeZIu59BdgsY849zpZrazreiYZXKahIA/weEiyRFEU9Ts9APjdERj5ZBqjAAAAAElFTkSuQmCC"},2:function(i,e){},2191:function(i,e){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA9CAMAAADGfvrlAAAAtFBMVEUAAAAAAAACAgIAAAAAAAAAAAAGBgYAAAAAAAAAAAAFBQUAAAABAQEGBgYCAgIAAAAAAAAEBAQFBQUAAAAAAAABAQEDAwMCAgIAAAAAAAAAAAAFBQUAAAAGBgYAAAAAAAAAAAAAAAADAwMBAQEAAAABAQEBAQEBAQEBAQEDAwMBAQEAAAACAgIBAQECAgIAAAAAAAABAQEAAAAAAAABAQEBAQEBAQEDAwMAAAAAAAAAAAAAAAAAI6fdAAAAO3RSTlMABQvg9KseO8T3ho92RZ0X129r+9M/KzjxyZkU3Q/ov7ykMiHOtV5SJRqplEx/ZK6gconruWhZQwmCwUKZof4AAAMbSURBVEjHpZeJlqIwEEUDuNGiIiACoqIi4761S9vv//9rwgxYgqB4fMfjEnOTkKpUVViuxN7E7HbNWasvsLfUq7aXniENLGsgGUOn3WkVJfurum8hIctf/umx15prxxKAkjvcHZR2W/naeWo4lDzcT17NevrVgcFUaVTE28NXOsp2AMDeP519teWof+1GIEnorm0A0z/5+6tIgKHkrK6y5/j3OmfyWROw6mOWq9nhGxhlduhMAfvMnuqPB3idDHZIo+bL3AHDS7q1y1mnkmocbzbdVFPrwOnU3JMyUO+nOgYq4J5YSmvgaCYssQSa6X2c+PB9qGbaanXe936eto7t5MHosjs2Df3BtPMRoNw9sAGjEw/cinXSDXNW09u3hp94K2y4jdtCmtC1eNN3hhpJAlRVhxT/NhareDNKGImx9fj3aFSzBjlXMKrRbA7kIPLKBQbxKvbwg0aky78XKbBxjbpVXUz7/zemhCWLVIfDcnXAKA4qX5DP0Rq+OwTbX7n6JXgsYRE+qck/BXYb8amcW0cHg9CXN7q+IQ93yk/UXNERkbHnq97Bnd35z1PdeYqBrcBaBsoCe19NuBPWtaAkm09Knz2quk4eMA2lBgt0eZUMN6pF3Uh1XJPn34LG1hiYSVgqVTOXWU/GJIk3OFDnWTDfh/hdyIJ7PkZsAbufAZvLTWjGpcm7HZQMWPyFx46oiRnwCZ7IRA98iGrJrTzCwhQ1VsuG22GzWIMWwlIWXIbNjm/DNDM985sw/8+j3S4M026TnQvDZGfysMIweRj5dmGYfJtOVWGYThWd58IwnWeKJEVhiiRRDPt5A6YYRtGzMEzRk+J2UZjiNmWMwjBlDMpVYgrWIniTgilX0XddIyOoMk/JF/srXJ194Y445blc2II3JLPkY35mPws44RhCOOyccbX6vIurB+whPz9WBoGuX+dCQmJ1gVolqzKgmoR+GNPyvTwJ0vm+JhFzq6He2tWRlOydU9VQfh1mBnvlXlqjlarDPq8ASdX3as/Pq97P6+3PK/3Xd4x27/Pbzef3qs9vdK/vkmJuvfMXl9icGVrQDtsAAAAASUVORK5CYII="},"28b8":function(i,e){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAzFBMVEUAAAAyMjIxMTE0NDQqKipBQUEwMDAjIyMxMTExMTEyMjI4ODgxMTFMTEw1NTUrKysjIyMwMDAxMTExMTE1NTUxMTEzMzMwMDAxMTExMTE4ODgwMDAxMTEvLy8gICB/f38yMjIxMTExMTEvLy8xMTExMTEuLi4wMDAyMjIyMjIxMTEvLy8xMTEyMjIxMTEwMDAzMzMuLi42NjYyMjIxMTExMTExMTEwMDAvLy8wMDAwMDAwMDAtLS0tLS0zMzMvLy80NDQ2NjY4ODgzMzN6YhNIAAAAQ3RSTlMA/fT6PVlzBiXd+8TnFCIJA3j7+BjxZS8N2ZFdz78OBO/kyrWmn5trUjspHOu8r5RJQzXV0sWQghKrqIpuWFZPpnmWvT1N0wAAAodJREFUWMPtl9mWmkAQQGlibDWGRRYhIMEFwX0Zt9FxMhP//5+C09UJKnhsOicv4T41p+BC2VWFCAUFBQX/D4peSWLx+ix1XU1gBwNOYVlDpyRouuPy4Sn1UdrDB6+UsZCC/HYttCuP6HSn3+2bo5TI3K2hGJJujLFVHvBFE+18/tpJiQ1CVVUDdI6/qWo5emSbFy6kU33NOkOMo58+C4/h9RAI0UQSUikxCY/+idJQ/4LQSlQGWo/4hYt6omxFh1uobFCyEXoWr1ByLxuhxCt0RHg2ui2cQtyHLugYxDjZ8QmHT8QjmhNiNiI+YblBhK6kwmqGeYRWFzLeKHMfcpd4hCUoQuOHIK3IUjM5hPgAm/skCXiGoBTl/MJRByRBLIkMkA/zC+dj2OPz3KrYkHOYVwhZxqzOM0Hew9HUyiukz4SCj1IxNXJYH+QVUoPmXPq3OYXyM+TY0cnoppNxrecTDugk7OPLtjGiXEJFrcEeO7/vAFU0w3mEuy6ihfedoLdA6Ep5hCWacfvnN8BGtP1yCJUDAiH6wwnYy2xCmP3ZVIfswlfxjhCVmYU4QPeELZ1VuGyf7lEvsQmh7bJpbBU2oQdtl0lnxCYcjOFC8cslPqIvBTbhC7Qt6kpfk+g9BIGDwiKUe3Q7t8rtnWAEsQh1l2ZMM6M0bbrPSxbhckz/s+qpzw7XMwh9qI7yTSjU8ghhdKFV87bHYYbZJCQPm81m+CF8j1dSltFpoxg/TAtVUYzxTt7cs2q9Xic/0DherV6UjOEV9VutZxOnvq3jUHDEZKo3rj/NFpnTwfOsrKLyPAwn7a8bCpkCD3hzLTTmAhfLrlhL4m8sgQ/pWE4QLmShoKCg4J/zC0L99j/wenPiAAAAAElFTkSuQmCC"},"2c16":function(i,e,o){},3:function(i,e){},3593:function(i,e,o){},4:function(i,e){},"4a8c":function(i,e){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAmVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjHWqVAAAAMnRSTlMA+/m7FsEEiBPmECX07x+ck5iQY1wMBt46InFINCkb6tXQyLaNf6x7QVdRTy0IysOjdbIknQAAAAI9SURBVGje7dbplqowDAfwUpACgqCCoHIRRdxny/s/3PWunmGxtIEPc6a/F/ifJoSEKIqiKMr39DJelWRQi3H4HsOKDMi4THMXIB6TwaRs62pw9/5CBrGYzAsX/nBDMgBzefFj+C8foFrOerb14EGbLvqOuB13vxvx4F76LZMRHjyo2ho9RmTrYAsNWG8J0YntPGjipj1FjFcjj0KzwuyjEdbV30C7OT7COLFXCk/kE+z/NSlHG3gOOSTZXN9owOFdMY1YBzF08CpdLSsp31zoQpuZco9IP3QbOnLXMhFGeLApdLZzhN8QJfschBxF11DyobsgxruJhvgg7EBETXQQdSbCliMNePCb5McIhMgNyVIXajt/SPB92WWy66l7Xyh/7+L74p0Qq7ZrxUYR4cH3hX/K4+fF5h+n+L74hAc/L/RKsCYFd0gsgpbyNjwz0RlO6cFTmxM6I2KUNyQGOmOm8dp+RNeK8TJgkyAzLEaBp1gg37GnwDVHZgQacMUZrlb3nvMFuIxarbwYeZzWM4JqBi1TvT4kDibDr9ZKY07DfjmamHfUMmZRw963EUNi1GvFoqb9UljyGdN6htO0X+hKPqPej73TuPftW48ZgdN8jx1k257VazVzPu/9N/grJJIYVDP2Vss9lktvkrNd/XattnuMEWlz+1PG1Gm7k72E9JNCA6v1HtMjRIgZ2o8Mo/0eWxGUfynatL21Ez8lfaRovkHaLUxkiPmrL/SewYFPuddqaGeWEUVRFEVRvqqfnnZk9rlieAEAAAAASUVORK5CYII="},"4fc3":function(i,e){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAApVBMVEUAAAAFBQUKCgozMzMzMzMoKCgsLCw4ODgsLCwxMTEVFRUzMzM7Ozs2NjY0NDQzMzNMTEw1NTUlJSUxMTEvLy8xMTExMTEtLS0VFRUcHBwuLi4oKCgxMTEuLi4rKyswMDAwMDArKystLS0uLi4xMTEuLi4kJCQxMTEwMDArKysqKioxMTEuLi4rKys0NDQsLCwkJCQuLi4vLy8uLi42NjYwMDAzMzMGZa9aAAAANnRSTlMABgFL7bBzQ9VhGOAzJeq3Coku+Lr16sIMCZhO/JRC5qV2KBDKehnt2bqvoIRWPB8K0bWOjGo12immAAAA/ElEQVRIx+3Sy1LCMBiG4STUoiIeGmKVJG1paUXOnv77vzRjNlJy0AwLGKbvpjNf55ksEnSG4ZJfOes1FlHKnAohaHRrFgmWrgxRFfCTqG8sZepnHpM9sqKaTKv2nHHOE/V5AWCTtiESdKPn1vz0SimVBCWPYBg8t5NUbWNNDIMv/iLafAUTmGXBBMY4mLw1weTy+kSIvkon8T8YN6F1OTRbL8BNQAws5WAnvo5NiknsTlILmW6QJ1xYyN29j5DPcPLQkY4cQubBhHz8j4y2vwNnAGnlJQtF6p1hKwXQZdZ3F+cA70O0U7OcMRZ5Ymwgk72DN+uet36JUZfqG2Wjeg1GwVSoAAAAAElFTkSuQmCC"},5:function(i,e){},5301:function(i,e,o){},"559e":function(i,e){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAqCAMAAAD26OlUAAAAtFBMVEUAAAAAAAAAAAAAAAAaGhoCAgIDAwMBAQEQEBAAAAABAQEBAQECAgIAAAABAQEBAQECAgIEBAQBAQEAAAAFBQUDAwMDAwMAAAAAAAACAgIDAwMFBQUGBgYAAAABAQEBAQEDAwMDAwMICAgJCQkMDAwBAQEBAQEBAQECAgIBAQECAgICAgICAgIGBgYGBgYNDQ0EBAQCAgIEBAQBAQEBAQEDAwMCAgIDAwMEBAQFBQUQEBAAAAAlv8O7AAAAO3RSTlMAvz/5B4MexQP7YBe0n+vmf03b2F0SC+DPqVlRLfbKo3lENiEP89PAu66Ja2dJOjIncUfthpmTjT4pJj+7kzoAAAIXSURBVDjLnZTnlrIwEIbHDaEI0lFAQFGkWrBty/3f16cU0Q3sd86+vybwnMnUwJ/FWGxZshbzOyVqOLN1RdHtDGviILa/2D5S7ESSEltBvn3Z92JePhPid9ezpgwztTz3PRZmuUdzZkCSgoUnsUVCAvMHxqsbRW2xDlWVjcq/pJqTZA49mickfy4AJtJ+IEGJ4O50JOkKBrRKybG1T7r9RhNtGd9s/VRbUwdtae7NGTfWFjnTyhijCUNzIzJrSGaCKiuS5JDu+JKQBxnKUgQA2mZBOSxFdtKRzGKjAcAHcul7J2xN1mm46APA4gyWjo/U5KiuGmtwFhxkh6e5mhw1VeMd+QAawjRXk2L56BzSYCuMKa7WsstxLGxhKcz7udFTt+bCErC/+y8HOx93HmnuxeNLjOKC5toYn7NmwDVors3akzO+qZZ5AFfv4/hM9sDi9HV9jALpAKZOc7DWOQsgR82mfSmkIikOTJTfU2+nR/PJnQyprbhNz66ax/Op2ZybnDVQOp2lqJ7wyiV/VbjJUpsC7RCN250pqn0rLR56VLQ7A6ERhzCoMDYefwthtB/i9iOh6E4qST/7uc+UqM+lx4Trf3s4gl8DV88ypiqzxvJZhR9yOcId1y/Y8fbJBUrlZUaMq+mJ9xdX9MyrQWaXr/6HCwc+kmMuTblYRn6AVzAkcadmgaEoRpCpOxF+FR+J399iRPXoHwT7P6mwTTR1AAAAAElFTkSuQmCC"},"56d7":function(i,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var t,n,a,s,r,u,d,c,l,A,g,h,m,f,p,x,v,b,y=o("2b0e"),T=function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("div",{attrs:{id:"app"}},[o("center",[o("h2",[i._v("Taller de creación de cuentos")])]),o("mis-libros",{on:{libroSeleccionado:i.seleccionarLibro}}),null!=i.idLibroSeleccionado?o("libro",{attrs:{idLibro:i.idLibroSeleccionado}}):i._e()],1)},C=[],I=(o("841c"),o("ac1f"),o("2b3d"),o("d3b7"),o("3ca3"),o("ddb0"),function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"libro",on:{click:function(e){i.idPaginaSeleccionada=null}}},[t("div",{attrs:{id:"zonaTitulo"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!i.editandoTitulo,expression:"!editandoTitulo"}],attrs:{id:"titulo"}},[i._v(" "+i._s(i.libro.titulo)+" ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:i.nuevoTitulo,expression:"nuevoTitulo"},{name:"show",rawName:"v-show",value:i.editandoTitulo,expression:"editandoTitulo"}],class:{letrasRojas:i.nuevoTituloIlegal},attrs:{type:"text",id:"inputNuevoTitulo"},domProps:{value:i.nuevoTitulo},on:{keypress:function(e){return!e.type.indexOf("key")&&i._k(e.keyCode,"enter",13,e.key,"Enter")?null:i.guardarNuevoTitulo(e)},input:function(e){e.target.composing||(i.nuevoTitulo=e.target.value)}}}),t("div",{attrs:{id:"controlesTitulo"}},[t("img",{staticClass:"bEditarTitulo",attrs:{src:o("559e"),alt:"Editar",id:"bEditarrTitulo",title:"Editar titulo del libro"},on:{click:function(e){return e.stopPropagation(),i.toggleEditandoTitulo(e)}}}),t("img",{directives:[{name:"show",rawName:"v-show",value:1==i.editandoTitulo&&0==i.nuevoTituloIlegal,expression:"editandoTitulo == true && nuevoTituloIlegal == false"}],staticClass:"bEditarTitulo",attrs:{src:o("4fc3"),alt:"Guardar",title:"guardar",id:"bGuardarNuevoTitulo"},on:{click:function(e){return e.stopPropagation(),i.guardarNuevoTitulo(e)}}})])]),t("div",{attrs:{id:"contenedorPaginas"}},i._l(i.paginasOrdenadas,(function(e,o){return t("pagina",{key:e.id,attrs:{paginaDerecha:o%2>0||0==o,estaPagina:e,idLibro:i.idLibro,seleccionada:i.idPaginaSeleccionada==e.id,segundoPlano:null!=i.idPaginaSeleccionada&&i.idPaginaSeleccionada!=e.id},on:{meElimine:function(o){return i.removePaginaFromCache(e.id)},tengoNuevoCuadroTexto:function(o){return i.updateCacheConNuevoCuadroTexto(o,e.id)},tengoNuevoCuadroImagen:function(o){return i.updateCacheConNuevoCuadroImagen(o,e.id)},elimineCuadroTexto:function(o){return i.removeCuadroTextoFromCache(o,e.id)},elimineCuadroImagen:function(o){return i.removeCuadroImagenFromCache(o,e.id)}},nativeOn:{click:function(o){o.stopPropagation(),i.idPaginaSeleccionada=e.id}}})})),1),t("div",{class:{deshabilitado:i.creandoPagina},attrs:{id:"bCrearNuevaPagina"},on:{click:function(e){return e.stopPropagation(),i.crearNuevaPaginaLibro(e)}}},[i._v(" Crear nueva página ")])])}),z=[],L=o("8785"),E=(o("c740"),o("a434"),o("99af"),o("7db0"),o("aa5a")),S=o.n(E),P=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"pagina",class:{seleccionada:i.seleccionada,deshabilitado:i.uploadingInfo,segundoPlano:i.segundoPlano,cursorTexto:i.creandoTexto,cursorImagen:i.creandoImagen},style:[i.estiloColumna,i.estiloSize,i.estiloApariencia],on:{mousedown:function(e){return!e.type.indexOf("key")&&i._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:(e.stopPropagation(),i.accionCrearElemento(e))},mousemove:i.resizeFantasmaElemento,mouseup:i.endDibujandoElemento,click:function(e){i.idElementoSeleccionado=null}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionada,expression:"seleccionada"}],staticClass:"zonaControlesPagina"},[t("img",{staticClass:"bControlesPagina bEliminarPagina",attrs:{src:o("2191")},on:{click:i.eliminarse}})]),t("herramientas-edicion",{directives:[{name:"show",rawName:"v-show",value:i.seleccionada,expression:"seleccionada"}],ref:"herramientasEdicion",on:{creacionTexto:function(e){i.desactivarHerramientas(),i.creandoTexto=!0},creacionImagen:function(e){i.desactivarHerramientas(),i.creandoImagen=!0},mousedown:function(i){i.stopPropagation()},mouseup:function(i){i.stopPropagation()}}}),t("div",{directives:[{name:"show",rawName:"v-show",value:i.dibujandoTexto,expression:"dibujandoTexto"}],staticClass:"fantasmaElemento",style:[i.estiloLayoutFantasmaTexto],attrs:{id:"fantasmaTexto"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:i.dibujandoImagen,expression:"dibujandoImagen"}],staticClass:"fantasmaElemento",style:[i.estiloLayoutFantasmaImagen],attrs:{id:"fantasmaImagen"}}),i._l(i.estaPagina.cuadrosImagen,(function(e){return t("cuadro-imagen",{key:e.id,ref:"cuadroImagen"+e.id,refInFor:!0,staticClass:"elementoPagina",class:{primerPlano:i.idElementoSeleccionado==e.id},attrs:{esteCuadroImagen:e,idLibro:i.idLibro,idPagina:i.estaPagina.id,sizePagina:i.size,seleccionado:i.idElementoSeleccionado==e.id&&i.seleccionada,paginaSeleccionada:i.seleccionada},on:{meElimine:function(o){return i.$emit("elimineCuadroImagen",e.id)}},nativeOn:{click:function(o){return i.resolverSeleccion(o,e.id)}}})})),i._l(i.estaPagina.cuadrosTexto,(function(e){return t("cuadro-texto",{key:e.id,staticClass:"elementoPagina",class:{primerPlano:i.idElementoSeleccionado==e.id},attrs:{esteCuadroTexto:e,idLibro:i.idLibro,idPagina:i.estaPagina.id,sizePagina:i.size,seleccionado:i.idElementoSeleccionado==e.id&&i.seleccionada,paginaSeleccionada:i.seleccionada},on:{meElimine:function(o){return i.$emit("elimineCuadroTexto",e.id)}},nativeOn:{click:function(o){return i.resolverSeleccion(o,e.id)}}})}))],2)},w=[],M=o("898b"),D=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"cuadroImagen",class:{conAudio:i.esteCuadroImagen.audio,deshabilitado:i.updatingInfo,enPaginaSeleccionada:i.paginaSeleccionada},style:[i.estiloLayout],on:{click:i.playAudio}},[t("img",{staticClass:"imagenContenido",attrs:{src:i.urlImagen+"?v="+i.versionImagen,alt:"ilustracion"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:i.sizeDragHandle,attrs:{id:"dragHandle"},on:{mousedown:function(e){return!e.type.indexOf("key")&&i._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:(e.stopPropagation(),i.iniciarDrag(e))},mousemove:i.drag,mouseup:i.finDrag}},[t("div",{attrs:{id:"bolitaDragHandle"}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:[i.sizeResizeHandle],attrs:{id:"resizeHandle"},on:{mousedown:function(e){return!e.type.indexOf("key")&&i._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:i.iniciarResize(e)},mousemove:i.resize,mouseup:i.finResize}},[t("div",{attrs:{id:"bolitaResizeHandle"}})]),t("img",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],attrs:{src:o("2191"),alt:"Eliminar",title:"Eliminar cuadro de imagen",id:"bEliminarCuadroImagen"},on:{click:i.eliminarse}}),t("input",{ref:"inputArchivoImagen",staticStyle:{display:"none"},attrs:{type:"file",id:"inputArchivoImagen"},on:{change:i.uploadArchivoCuadroImagen}}),i.esteCuadroImagen.audio?t("audio",{ref:"audio",attrs:{type:"audio/ogg"}},[t("source",{attrs:{src:i.urlAudio,type:"audio/ogg"}})]):i._e()])},O=[],$=o("bc3a"),F=o.n($),N={name:"cuadroImagen",props:{esteCuadroImagen:Object,idLibro:String,idPagina:String,sizePagina:Object,seleccionado:Boolean,archivoCuadroImagenPagina:Object,paginaSeleccionada:Boolean},data:function(){return{resizing:!1,dragging:!1,posicion:{x:null,y:null},size:{x:null,y:null},updatingInfo:!1,versionImagen:0}},computed:{estiloLayout:function(){return{top:this.posicion.y+"%",left:this.posicion.x+"%",width:this.size.x+"%",height:this.size.y+"%"}},urlImagen:function(){return this.serverUrl+"/apiCuentos/imagenCuento/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroImagen.id},sizeResizeHandle:function(){return{width:this.resizing?"200px":"10px",height:this.resizing?"200px":"10px"}},sizeDragHandle:function(){return{width:this.dragging?"200px":"10px",height:this.dragging?"200px":"10px"}},urlAudio:function(){return this.serverUrl+"/apiCuentos/audioImagen/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroImagen.id}},methods:{playAudio:function(){this.esteCuadroImagen.audio&&this.$refs.audio.play()},iniciarResize:function(){this.resizing=!0},resize:function(i){if(this.resizing){var e={x:this.$el.getBoundingClientRect().left,y:this.$el.getBoundingClientRect().top},o=i.clientX-e.x-5,t=i.clientY-e.y-5,n=Math.floor(100*o/this.sizePagina.x),a=Math.floor(100*t/this.sizePagina.y);this.posicion.x+n>100&&(n=Math.floor(100-this.posicion.x)),this.posicion.y+a>100&&(a=Math.floor(100-this.posicion.y)),this.$set(this.size,"x",n),this.$set(this.size,"y",a)}},finResize:function(){this.resizing=!1},iniciarDrag:function(){this.dragging=!0},drag:function(i){if(this.dragging){console.log("Dragging");var e=this.$el.closest(".pagina"),o=e.getBoundingClientRect(),t={x:i.clientX-o.left,y:i.clientY-o.top},n={x:t.x-this.$el.offsetWidth/2,y:t.y+20};n.x+this.$el.offsetWidth>e.offsetWidth&&(n.x=e.offsetWidth-this.$el.offsetWidth),n.x<0&&(n.x=0),n.y+this.$el.offsetHeight>e.offsetHeight&&(n.y=e.offsetHeight-this.$el.offsetHeight),n.y<0&&(n.y=0);var a={x:Math.round(100*n.x/e.offsetWidth),y:Math.round(100*n.y/e.offsetHeight)};this.posicion=a}},finDrag:function(){this.dragging=!1,this.$apollo.mutate({mutation:Object(M["gql"])(t||(t=Object(L["a"])(["\n          mutation(\n            $idLibro: ID!\n            $idPagina: ID!\n            $idCuadroImagen: ID!\n            $nuevoPosicion: CoordsInput!\n          ) {\n            updatePosicionCuadroImagen(\n              idLibro: $idLibro\n              idPagina: $idPagina\n              idCuadroImagen: $idCuadroImagen\n              nuevoPosicion: $nuevoPosicion\n            ) {\n              id\n              posicion {\n                x\n                y\n              }\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroImagen:this.esteCuadroImagen.id,nuevoPosicion:this.posicion}})},uploadArchivoCuadroImagen:function(){var i=this,e=new FormData;this.$refs.inputArchivoImagen.value?(e.append("idLibro",this.idLibro),e.append("idPagina",this.idPagina),e.append("idCuadroImagen",this.esteCuadroImagen.id),e.append("imagen",this.$refs.inputArchivoImagen.files[0]),F()({method:"post",url:this.serverUrl+"/apiCuentos/subirArchivoCuadroImagen",data:e,headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+this.$store.state.token}}).then((function(e){var o=e.res;console.log("Resultado de upload archivo: ".concat(o)),i.versionImagen++})).catch((function(i){console.log("Error uploading archivo de cuadroImagen. E: ".concat(i))}))):console.log("No había archivo seleccionado")},eliminarse:function(){var i=this;confirm("Eliminando cuadro de imagen. Esta operación no se puede deshacer. ¿Continuar?")&&(this.updatingInfo=!0,console.log("Eliminando un cuadro de imagen"),this.$apollo.mutate({mutation:Object(M["gql"])(n||(n=Object(L["a"])(["\n            mutation($idLibro: ID!, $idPagina: ID!, $idCuadroImagen:ID!) {\n              eliminarCuadroImagenLibro(idLibro: $idLibro, idPagina: $idPagina, idCuadroImagen:$idCuadroImagen)\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroImagen:this.esteCuadroImagen.id}}).then((function(e){var o=e.data.eliminarCuadroImagenLibro;console.log("Resultado: ".concat(o)),o&&i.$emit("meElimine")})).catch((function(e){console.log("Error. E: ".concat(e)),i.updatingInfo=!1})))}},mounted:function(){console.log("Montado"),this.posicion=this.esteCuadroImagen.posicion,this.size=this.esteCuadroImagen.size,this.esteCuadroImagen.sinArchivo&&(console.log("Abriendo el input de archivo"),this.$refs.inputArchivoImagen.click())}},j=N,B=(o("f392"),o("2877")),k=Object(B["a"])(j,D,O,!1,null,"20b4bbac",null),Q=k.exports,U=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"cuadroTexto",class:{conAudio:i.esteCuadroTexto.audio,deshabilitado:i.updatingInfo,enPaginaSeleccionada:i.paginaSeleccionada},style:[i.estiloLayout],on:{click:i.playAudio}},[t("div",{ref:"texto",staticClass:"texto",style:[i.estiloFormato,i.estiloFontSize,i.estiloVisibilidadTexto],on:{click:i.iniciarEdicionTexto}},[i._v(i._s(i.esteCuadroTexto.texto))]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:i.nuevoTexto,expression:"nuevoTexto"},{name:"show",rawName:"v-show",value:i.editandoTexto,expression:"editandoTexto"}],ref:"inputNuevoTexto",style:[i.estiloFormato,i.estiloFontSizeInput],attrs:{id:"inputNuevoTexto"},domProps:{value:i.nuevoTexto},on:{input:function(e){e.target.composing||(i.nuevoTexto=e.target.value)}}}),t("textarea",{directives:[{name:"model",rawName:"v-model",value:i.nuevoTexto,expression:"nuevoTexto"}],ref:"dummyInput",style:[i.estiloFormato,i.estiloInputDummy],attrs:{id:"dummyInputTexto"},domProps:{value:i.nuevoTexto},on:{input:function(e){e.target.composing||(i.nuevoTexto=e.target.value)}}}),t("img",{directives:[{name:"show",rawName:"v-show",value:i.editandoTexto,expression:"editandoTexto"}],attrs:{src:o("4fc3"),alt:"guardar",title:"Guardar cambios",id:"bGuardarTexto"},on:{click:function(e){return e.stopPropagation(),i.guardarNuevoTexto(e)}}}),t("img",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],attrs:{src:o("2191"),alt:"Eliminar",title:"Eliminar cuadro de texto",id:"bEliminarCuadroTexto"},on:{click:i.eliminarse}}),t("div",{ref:"textoDummy",staticClass:"textoDummy",style:[i.estiloFormato,i.estiloDummy]},[i._v(" "+i._s(i.esteCuadroTexto.texto)+" ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:i.sizeDragHandle,attrs:{id:"dragHandle"},on:{mousedown:function(e){return!e.type.indexOf("key")&&i._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:(e.stopPropagation(),i.iniciarDrag(e))},mousemove:i.drag,mouseup:i.finDrag}},[t("div",{attrs:{id:"bolitaDragHandle"}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.seleccionado,expression:"seleccionado"}],style:[i.sizeResizeHandle],attrs:{id:"resizeHandle"},on:{mousedown:function(e){return!e.type.indexOf("key")&&i._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:(e.stopPropagation(),i.iniciarResize(e))},mousemove:i.resize,mouseup:i.finResize}},[t("div",{attrs:{id:"bolitaResizeHandle"}})]),i.esteCuadroTexto.audio?t("audio",{ref:"audio",attrs:{type:"audio/ogg"}},[t("source",{attrs:{src:i.urlAudio,type:"audio/ogg"}})]):i._e()])},R=[],q={name:"CuadroTexto",props:{idLibro:String,idPagina:String,esteCuadroTexto:Object,sizePagina:Object,seleccionado:Boolean,paginaSeleccionada:Boolean},data:function(){return{fontSizeDummy:10,fontSizeInputDummy:10,fontSizeTexto:10,fontSizeInput:10,resizing:!1,dragging:!1,posicion:{x:null,y:null},size:{x:null,y:null},updatingInfo:!1,nuevoTexto:null,editandoTexto:!1}},computed:{estiloLayout:function(){return{top:this.posicion.y+"%",left:this.posicion.x+"%",width:this.size.x+"%",height:this.size.y+"%"}},estiloFormato:function(){return{textAlign:this.esteCuadroTexto.formato.alineacion,color:this.esteCuadroTexto.formato.colorLetra,fontFamily:this.esteCuadroTexto.formato.tipoLetra+", 'Nunito', sans-serif"}},estiloFontSize:function(){return{fontSize:this.fontSizeTexto+"px"}},estiloVisibilidadTexto:function(){return{visibility:this.editandoTexto?"hidden":"visible"}},estiloFontSizeInput:function(){return{fontSize:this.fontSizeInput+"px"}},estiloDummy:function(){return{fontSize:this.fontSizeDummy+"px"}},estiloInputDummy:function(){return{fontSize:this.fontSizeInputDummy+"px"}},sizeResizeHandle:function(){return{width:this.resizing?"200px":"10px",height:this.resizing?"200px":"10px"}},sizeDragHandle:function(){return{width:this.dragging?"200px":"10px",height:this.dragging?"200px":"10px"}},urlAudio:function(){return this.serverUrl+"/apiCuentos/audioTexto/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroTexto.id}},methods:{playAudio:function(){this.esteCuadroTexto.audio&&(console.log("Reproduciendo"),this.$refs.audio.play())},iniciarResize:function(){this.resizing=!0},resize:function(i){if(this.resizing){var e={x:this.$el.getBoundingClientRect().left,y:this.$el.getBoundingClientRect().top},o=i.clientX-e.x-5,t=i.clientY-e.y-5;if(o<15||t<15)return void console.log("Offlimits");var n=Math.round(100*o/this.sizePagina.x),a=Math.round(100*t/this.sizePagina.y);this.posicion.x+n>100&&(n=Math.floor(100-this.posicion.x)),this.posicion.y+a>100&&(a=Math.floor(100-this.posicion.y)),this.$set(this.size,"x",n),this.$set(this.size,"y",a)}},finResize:function(){var i=this;this.resizing=!1,this.fontSizeDummy=10,this.$nextTick((function(){i.findFontSize(),i.$apollo.mutate({mutation:Object(M["gql"])(a||(a=Object(L["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $idCuadroTexto: ID!\n              $nuevoSize: CoordsInput!\n            ) {\n              updateSizeCuadroTexto(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                idCuadroTexto: $idCuadroTexto\n                nuevoSize: $nuevoSize\n              ) {\n                id\n                size {\n                  x\n                  y\n                }\n              }\n            }\n          "]))),variables:{idLibro:i.idLibro,idPagina:i.idPagina,idCuadroTexto:i.esteCuadroTexto.id,nuevoSize:i.size}})}))},findFontSize:function(){var i=this;if(this.esteCuadroTexto&&this.esteCuadroTexto.texto&&!(this.esteCuadroTexto.texto.length<1)){console.log("Ajustando font size texto");var e=this.$refs.texto.offsetHeight,o=this.$refs.textoDummy.offsetHeight,t=this.$refs.textoDummy.scrollWidth,n=this.$refs.texto.offsetWidth;console.log("Dummy: ".concat(t,"x").concat(o,". Texto: ").concat(n,"x").concat(e)),o>=e||t>=n?(console.log("El dummy es más grande que el texto. Disminuyendo font size"),this.fontSizeDummy=this.fontSizeDummy-2,this.$nextTick((function(){var e=i.$refs.texto.offsetHeight,o=i.$refs.textoDummy.offsetHeight,t=i.$refs.textoDummy.scrollWidth,n=i.$refs.texto.offsetWidth;if(console.log("Ahora: Dummy: ".concat(t,"x").concat(o,". texto: ").concat(n,"x").concat(e)),o<e&&t<n||i.fontSizeDummy<5)return console.log("Encontrado"),i.fontSizeTexto=i.fontSizeDummy,void(i.fontSizeInput=i.fontSizeDummy);i.findFontSize()}))):o<e&&t<n&&(console.log("El dummy es más pequeño que el texto. Creciendo font size"),this.fontSizeDummy=this.fontSizeDummy+2,this.$nextTick((function(){var e=i.$refs.texto.offsetHeight,o=i.$refs.textoDummy.offsetHeight,t=i.$refs.textoDummy.scrollWidth,n=i.$refs.texto.offsetWidth;if(console.log("Ahora: Dummy: ".concat(t,"x").concat(o,". Texto: ").concat(n,"x").concat(e)),o>=e||t>=n||i.fontSizeDummy>100)return console.log("Encontrado"),i.fontSizeDummy=i.fontSizeDummy-2,console.log("Quedó en ".concat(i.fontSizeDummy)),i.fontSizeTexto=i.fontSizeDummy,void(i.fontSizeInput=i.fontSizeDummy);i.findFontSize()})))}},findFontSizeInput:function(){var i=this;if(this.nuevoTexto&&!(this.nuevoTexto.length<1)){console.log("Ajustando font size input");var e=this.$refs.inputNuevoTexto.offsetHeight,o=this.$refs.dummyInput.scrollHeight,t=this.$refs.dummyInput.scrollWidth,n=this.$refs.inputNuevoTexto.offsetWidth;console.log("Dummy: ".concat(t,"x").concat(o,". Input: ").concat(n,"x").concat(e)),o>=e||t>=n?(console.log("El dummy es más grande que el input. Disminuyendo font size"),this.fontSizeInputDummy=this.fontSizeInputDummy-2,this.$nextTick((function(){var e=i.$refs.inputNuevoTexto.offsetHeight,o=i.$refs.dummyInput.scrollHeight,t=i.$refs.dummyInput.scrollWidth,n=i.$refs.inputNuevoTexto.offsetWidth;console.log("Ahora: Dummy: ".concat(t,"x").concat(o,". Input: ").concat(n,"x").concat(e)),o<e&&t<n||i.fontSizeInputDummy<5?i.fontSizeInput=i.fontSizeInputDummy:i.findFontSizeInput()}))):o<e&&t<n&&(console.log("El dummy es más pequeño que el input. Creciendo font size"),this.fontSizeInputDummy=this.fontSizeInputDummy+2,this.$nextTick((function(){var e=i.$refs.inputNuevoTexto.offsetHeight,o=i.$refs.dummyInput.scrollHeight,t=i.$refs.dummyInput.scrollWidth,n=i.$refs.inputNuevoTexto.offsetWidth;if(console.log("Ahora: Dummy: ".concat(t,"x").concat(o,". Input: ").concat(n,"x").concat(e)),o>=e||t>=n||i.fontSizeInputDummy>100)return i.fontSizeInputDummy=i.fontSizeInputDummy-2,void(i.fontSizeInput=i.fontSizeInputDummy);i.findFontSizeInput()})))}},guardarNuevoTexto:function(){var i=this;if(this.nuevoTexto.length>3e3)alert("Texto demasiado largo");else{if(this.nuevoTexto==this.esteCuadroTexto.texto)return console.log("Texto no modificado"),void(this.editandoTexto=!1);this.updatingInfo=!0,this.$apollo.mutate({mutation:Object(M["gql"])(s||(s=Object(L["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $idCuadroTexto: ID!\n              $nuevoTexto: String!\n            ) {\n              updateTextoCuadroTextoCuento(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                idCuadroTexto: $idCuadroTexto\n                nuevoTexto: $nuevoTexto\n              ) {\n                id\n                texto\n              }\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroTexto:this.esteCuadroTexto.id,nuevoTexto:this.nuevoTexto}}).then((function(){i.editandoTexto=!1,i.updatingInfo=!1})).catch((function(e){console.log("Error. E: ".concat(e)),i.updatingInfo=!1}))}},iniciarEdicionTexto:function(){var i=this;this.seleccionado&&(this.fontSizeInput=this.fontSizeTexto,this.fontSizeInputDummy=this.fontSizeTexto,this.nuevoTexto=this.esteCuadroTexto.texto,this.editandoTexto=!0,this.$nextTick((function(){i.$refs.inputNuevoTexto.focus()})))},iniciarDrag:function(){this.dragging=!0},drag:function(i){if(this.dragging){console.log("Dragging");var e=this.$el.closest(".pagina"),o=e.getBoundingClientRect(),t={x:i.clientX-o.left,y:i.clientY-o.top},n={x:t.x-this.$el.offsetWidth/2,y:t.y+20};n.x+this.$el.offsetWidth>e.offsetWidth&&(n.x=e.offsetWidth-this.$el.offsetWidth),n.x<0&&(n.x=0),n.y+this.$el.offsetHeight>e.offsetHeight&&(n.y=e.offsetHeight-this.$el.offsetHeight),n.y<0&&(n.y=0);var a={x:Math.round(100*n.x/e.offsetWidth),y:Math.round(100*n.y/e.offsetHeight)};this.posicion=a}},finDrag:function(){this.dragging=!1,this.$apollo.mutate({mutation:Object(M["gql"])(r||(r=Object(L["a"])(["\n          mutation(\n            $idLibro: ID!\n            $idPagina: ID!\n            $idCuadroTexto: ID!\n            $nuevoPosicion: CoordsInput!\n          ) {\n            updatePosicionCuadroTexto(\n              idLibro: $idLibro\n              idPagina: $idPagina\n              idCuadroTexto: $idCuadroTexto\n              nuevoPosicion: $nuevoPosicion\n            ) {\n              id\n              posicion {\n                x\n                y\n              }\n            }\n          }\n        "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroTexto:this.esteCuadroTexto.id,nuevoPosicion:this.posicion}})},eliminarse:function(){var i=this;confirm("Eliminando cuadro de texto. Esta operación no se puede deshacer. ¿Continuar?")&&(this.updatingInfo=!0,console.log("Eliminando un cuadro de texto"),this.$apollo.mutate({mutation:Object(M["gql"])(u||(u=Object(L["a"])(["\n            mutation($idLibro: ID!, $idPagina: ID!, $idCuadroTexto: ID!) {\n              eliminarCuadroTextoLibro(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                idCuadroTexto: $idCuadroTexto\n              )\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.idPagina,idCuadroTexto:this.esteCuadroTexto.id}}).then((function(e){var o=e.data.eliminarCuadroTextoLibro;console.log("Resultado: ".concat(o)),o&&i.$emit("meElimine")})).catch((function(e){console.log("Error. E: ".concat(e)),i.updatingInfo=!1})))}},watch:{nuevoTexto:function(){var i=this;this.$nextTick((function(){i.findFontSizeInput()}))},esteCuadroTexto:function(){var i=this;this.$nextTick((function(){i.findFontSize()}))},seleccionado:function(i){0==i&&(this.editandoTexto=!1)}},mounted:function(){var i=this;this.$set(this.posicion,"x",this.esteCuadroTexto.posicion.x),this.$set(this.posicion,"y",this.esteCuadroTexto.posicion.y),this.$set(this.size,"x",this.esteCuadroTexto.size.x),this.$set(this.size,"y",this.esteCuadroTexto.size.y),this.$nextTick((function(){i.findFontSize()}))}},H=q,V=(o("0d62"),Object(B["a"])(H,U,R,!1,null,null,null)),W=V.exports,J=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{attrs:{id:"herramientasEdicion"}},[t("img",{staticClass:"bHerramientasEdicion",class:{hSeleccionada:"puntero"==i.herramientaSeleccionada},attrs:{src:o("4a8c")},on:{click:function(e){e.stopPropagation(),i.$emit("puntero"),i.herramientaSeleccionada="puntero"},mousedown:function(i){i.stopPropagation()}}}),t("img",{staticClass:"bHerramientasEdicion",class:{hSeleccionada:"texto"==i.herramientaSeleccionada},attrs:{src:o("28b8")},on:{click:function(e){e.stopPropagation(),i.$emit("creacionTexto"),i.herramientaSeleccionada="texto"},mousedown:function(i){i.stopPropagation()}}}),t("img",{staticClass:"bHerramientasEdicion",class:{hSeleccionada:"imagen"==i.herramientaSeleccionada},attrs:{src:o("885c")},on:{click:function(e){e.stopPropagation(),i.$emit("creacionImagen"),i.herramientaSeleccionada="imagen"},mousedown:function(i){i.stopPropagation()}}})])},G=[],K={name:"HerramientasEdicion",data:function(){return{herramientaSeleccionada:"puntero"}},methods:{reset:function(){this.herramientaSeleccionada="puntero"}}},Y=K,X=(o("0705"),Object(B["a"])(Y,J,G,!1,null,"2c9e7702",null)),Z=X.exports,_={components:{CuadroImagen:Q,CuadroTexto:W,HerramientasEdicion:Z},name:"Pagina",props:{estaPagina:Object,paginaDerecha:Boolean,preparada:{type:Boolean,default:!1},visible:{type:Boolean},idLibro:String,seleccionada:Boolean,segundoPlano:{type:Boolean,default:!1}},data:function(){return{ancho:450,alto:600,uploadingInfo:!1,creandoTexto:!1,creandoImagen:!1,dibujandoTexto:!1,dibujandoImagen:!1,posFantasmaTexto:{x:0,y:0},sizeFantasmaTexto:{x:30,y:30},posFantasmaImagen:{x:0,y:0},sizeFantasmaImagen:{x:30,y:30},idElementoSeleccionado:null}},computed:{estiloColumna:function(){return this.paginaDerecha?{gridColumn:"1/2",justifySelf:"right"}:null},estiloSize:function(){return{width:this.ancho+"px",height:this.alto+"px"}},size:function(){return{x:this.ancho,y:this.alto}},estiloApariencia:function(){return{backgroundColor:this.estaPagina.color}},estiloLayoutFantasmaTexto:function(){return{top:this.posFantasmaTexto.y+"px",left:this.posFantasmaTexto.x+"px",width:this.sizeFantasmaTexto.x+"px",height:this.sizeFantasmaTexto.y+"px"}},estiloLayoutFantasmaImagen:function(){return{top:this.posFantasmaImagen.y+"px",left:this.posFantasmaImagen.x+"px",width:this.sizeFantasmaImagen.x+"px",height:this.sizeFantasmaImagen.y+"px"}}},methods:{eliminarse:function(){var i=this;confirm("Eliminando página. Esta operación no se puede deshacer. ¿Continuar?")&&(this.uploadingInfo=!0,console.log("Eliminando una página"),this.$apollo.mutate({mutation:Object(M["gql"])(d||(d=Object(L["a"])(["\n            mutation($idLibro: ID!, $idPagina: ID!) {\n              eliminarPaginaDeLibro(idLibro: $idLibro, idPagina: $idPagina)\n            }\n          "]))),variables:{idLibro:this.idLibro,idPagina:this.estaPagina.id}}).then((function(e){var o=e.data.eliminarPaginaDeLibro;console.log("Resultado: ".concat(o)),o&&i.$emit("meElimine")})).catch((function(e){console.log("Error. E: ".concat(e)),i.uploadingInfo=!1})))},desactivarHerramientas:function(){this.creandoTexto=!1,this.creandoImagen=!1},accionCrearElemento:function(i){var e=this.$el.getBoundingClientRect(),o={x:i.clientX-e.left,y:i.clientY-e.top};this.creandoTexto?(this.dibujandoTexto=!0,this.$set(this.posFantasmaTexto,"x",Math.floor(o.x)),this.$set(this.posFantasmaTexto,"y",Math.floor(o.y)),this.$set(this.sizeFantasmaTexto,"x",30),this.$set(this.sizeFantasmaTexto,"y",30)):this.creandoImagen&&(this.dibujandoImagen=!0,this.$set(this.posFantasmaImagen,"x",Math.floor(o.x)),this.$set(this.posFantasmaImagen,"y",Math.floor(o.y)),this.$set(this.sizeFantasmaImagen,"x",30),this.$set(this.sizeFantasmaImagen,"y",30))},resizeFantasmaElemento:function(i){var e=this.$el.getBoundingClientRect(),o={x:i.clientX-e.left,y:i.clientY-e.top};if(this.dibujandoTexto){var t={x:o.x-this.posFantasmaTexto.x,y:o.y-this.posFantasmaTexto.y};t.x<30&&(t.x=30),t.y<30&&(t.y=30),this.$set(this.sizeFantasmaTexto,"x",Math.floor(t.x)),this.$set(this.sizeFantasmaTexto,"y",Math.floor(t.y))}if(this.dibujandoImagen){var n={x:o.x-this.posFantasmaImagen.x,y:o.y-this.posFantasmaImagen.y};n.x<30&&(n.x=30),n.y<30&&(n.y=30),this.$set(this.sizeFantasmaImagen,"x",Math.floor(n.x)),this.$set(this.sizeFantasmaImagen,"y",Math.floor(n.y))}},endDibujandoElemento:function(){this.dibujandoTexto?(console.log("Creando cuadroTexto"),this.dibujandoTexto=!1,this.$refs.herramientasEdicion.reset(),this.crearTextoFromFantasma()):this.dibujandoImagen&&(console.log("Creando cuadro de imágen"),this.dibujandoImagen=!1,this.$refs.herramientasEdicion.reset(),this.crearCuadroImagenFromFantasma()),this.desactivarHerramientas()},crearCuadroImagenFromFantasma:function(){var i=this,e={x:Math.round(100*this.posFantasmaImagen.x/this.$el.offsetWidth),y:Math.round(100*this.posFantasmaImagen.y/this.$el.offsetHeight)},o={x:Math.round(100*this.sizeFantasmaImagen.x/this.$el.offsetWidth),y:Math.round(100*this.sizeFantasmaImagen.y/this.$el.offsetHeight)};this.$apollo.mutate({mutation:Object(M["gql"])(c||(c=Object(L["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $datosPosicion: CoordsInput!\n              $datosSize: CoordsInput!\n            ) {\n              crearCuadroImagenPaginaLibro(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                datosPosicion: $datosPosicion\n                datosSize: $datosSize\n              ) {\n                ...fragCuadroImagen\n              }\n            }\n            ","\n          "])),ai),variables:{idLibro:this.idLibro,idPagina:this.estaPagina.id,datosPosicion:e,datosSize:o}}).then((function(e){var o=e.data.crearCuadroImagenPaginaLibro;i.$emit("tengoNuevoCuadroImagen",o)})).catch((function(i){console.log("Error en mutación de crear cuadro imágen. E: ".concat(i))}))},crearTextoFromFantasma:function(){var i=this;console.log("Enviando con ".concat(JSON.stringify(this.idLibro),", ").concat(JSON.stringify(this.estaPagina.id),", ").concat(JSON.stringify(this.posFantasmaTexto),", ").concat(JSON.stringify(this.sizeFantasmaTexto)));var e={x:Math.round(100*this.posFantasmaTexto.x/this.$el.offsetWidth),y:Math.round(100*this.posFantasmaTexto.y/this.$el.offsetHeight)},o={x:Math.round(100*this.sizeFantasmaTexto.x/this.$el.offsetWidth),y:Math.round(100*this.sizeFantasmaTexto.y/this.$el.offsetHeight)};this.$apollo.mutate({mutation:Object(M["gql"])(l||(l=Object(L["a"])(["\n            mutation(\n              $idLibro: ID!\n              $idPagina: ID!\n              $datosPosicion: CoordsInput!\n              $datosSize: CoordsInput!\n            ) {\n              crearCuadroTextoPaginaLibro(\n                idLibro: $idLibro\n                idPagina: $idPagina\n                datosPosicion: $datosPosicion\n                datosSize: $datosSize\n              ) {\n                ...fragCuadroTexto\n              }\n            }\n            ","\n          "])),ni),variables:{idLibro:this.idLibro,idPagina:this.estaPagina.id,datosPosicion:e,datosSize:o},errorPolicy:"all"}).then((function(e){var o=e.data.crearCuadroTextoPaginaLibro;i.$emit("tengoNuevoCuadroTexto",o)})).catch((function(i){console.log("Error. E: ".concat(i.message)),console.log("Hubo ".concat(i.graphQLErrors," errores graphql"))}))},resolverSeleccion:function(i,e){this.seleccionada&&(i.stopPropagation(),this.idElementoSeleccionado=e)}}},ii=_,ei=(o("9cd3"),Object(B["a"])(ii,P,w,!1,null,"3cec6303",null)),oi=ei.exports,ti=/[^ a-zA-ZÀ-ž0-9_():.,-¿?¡!]/,ni=S()(A||(A=Object(L["a"])(["\n  fragment fragCuadroTexto on CuadroTextoCuento {\n    id\n    texto\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n    formato {\n      fontSize\n      colorLetra\n      tipoLetra\n      alineacion\n    }\n  }\n"]))),ai=S()(g||(g=Object(L["a"])(["\n  fragment fragCuadroImagen on CuadroImagenCuento {\n    id\n    sinArchivo\n    tipoActivacionSecundario\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n  }\n"]))),si=S()(h||(h=Object(L["a"])(["\n  fragment fragPagina on PaginaCuento {\n    id    \n    numPag\n    color\n    cuadrosTexto {\n      ...fragCuadroTexto\n    }\n    cuadrosImagen {\n      ...fragCuadroImagen\n    }\n  }\n  ","\n  ","\n"])),ni,ai),ri=S()(m||(m=Object(L["a"])(["\n  query($idLibro: ID!) {\n    libro(idLibro: $idLibro) {\n      id\n      idsEditores\n      titulo\n      paginas {\n        ...fragPagina\n      }\n    }\n  }\n  ","\n"])),si),ui={components:{Pagina:oi},name:"Libro",apollo:{libro:{query:ri,variables:function(){return{idLibro:this.idLibro}},skip:function(){return null==this.idLibro}}},props:{idLibro:{type:String,default:null}},data:function(){return{libro:{paginas:null},idPaginaSeleccionada:null,creandoPagina:!1,nuevoTitulo:null,editandoTitulo:!1}},computed:{paginasOrdenadas:function(){if(this.libro.paginas){var i=this.libro.paginas;return i.sort((function(i,e){return parseInt(i.numPag)-parseInt(e.numPag)}))}return[]},nuevoTituloIlegal:function(){return!this.nuevoTitulo||this.nuevoTitulo.length<1||!!ti.test(this.nuevoTitulo)}},methods:{toggleEditandoTitulo:function(){this.editandoTitulo=!this.editandoTitulo,this.nuevoTitulo=this.libro.titulo},guardarNuevoTitulo:function(){var i=this;this.nuevoTituloIlegal?console.log("No enviado"):this.nuevoTitulo!=this.libro.titulo?(console.log("guardando nuevo título"),this.enviandoNuevoTitulo=!0,this.$apollo.mutate({mutation:S()(f||(f=Object(L["a"])(["\n            mutation($idLibro: ID!, $nuevoTitulo: String!) {\n              editarTituloLibro(idLibro: $idLibro, nuevoTitulo: $nuevoTitulo) {\n                id\n                titulo\n              }\n            }\n          "]))),variables:{idLibro:this.idLibro,nuevoTitulo:this.nuevoTitulo}}).then((function(){i.enviandoNuevoTitulo=!1,i.editandoTitulo=!1})).catch((function(e){i.enviandoNuevoTitulo=!1,console.log("Error. E :".concat(e))}))):this.editandoTitulo=!1},crearNuevaPaginaLibro:function(){var i=this;this.creandoPagina=!0;var e=this;this.$apollo.mutate({mutation:S()(p||(p=Object(L["a"])(["\n            mutation($idLibro: ID!) {\n              crearNuevaPaginaLibro(idLibro: $idLibro) {\n                ...fragPagina\n              }\n            }\n            ","\n          "])),si),variables:{idLibro:this.idLibro}}).then((function(o){var t=o.data.crearNuevaPaginaLibro,n=i.$apollo.provider.defaultClient,a=n.readQuery({query:ri,variables:{idLibro:e.idLibro}}),s=JSON.parse(JSON.stringify(a));s.libro.paginas.push(t),n.writeQuery({query:ri,variables:{idLibro:e.idLibro},data:s}),i.creandoPagina=!1})).catch((function(e){console.log("Error: ".concat(e)),i.creandoPagina=!1}))},removePaginaFromCache:function(i){this.idPaginaSeleccionada=null;var e=this.$apollo.provider.defaultClient,o=e.readQuery({query:ri,variables:{idLibro:this.idLibro}}),t=JSON.parse(JSON.stringify(o)),n=t.libro.paginas.findIndex((function(e){return e.id==i}));n>-1?(t.libro.paginas.splice(n,1),e.writeQuery({query:ri,variables:{idLibro:this.idLibro},data:t})):console.log("La pagina no estaba en el caché")},updateCacheConNuevoCuadroImagen:function(i,e){console.log("Se actualizara el cache con info: ".concat(i," en la pagina ").concat(e));var o=this.$apollo.provider.defaultClient,t=o.readQuery({query:ri,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==e}));a?a.cuadrosImagen.some((function(e){return e==i.id}))?console.log("Ese cuadro texto ya estaba incluido"):(a.cuadrosImagen.push(i),o.writeQuery({query:ri,variables:{idLibro:this.idLibro},data:n})):console.log("Pagina no existía")},updateCacheConNuevoCuadroTexto:function(i,e){console.log("Se actualizara el cache con info: ".concat(i," en la pagina ").concat(e));var o=this.$apollo.provider.defaultClient,t=o.readQuery({query:ri,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==e}));a?a.cuadrosTexto.some((function(e){return e==i.id}))?console.log("Ese cuadro texto ya estaba incluido"):(a.cuadrosTexto.push(i),o.writeQuery({query:ri,variables:{idLibro:this.idLibro},data:n})):console.log("Pagina no existía")},removeCuadroTextoFromCache:function(i,e){var o=this.$apollo.provider.defaultClient,t=o.readQuery({query:ri,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==e}));if(a){var s=a.cuadrosTexto.findIndex((function(e){return e.id==i}));s>-1?(a.cuadrosTexto.splice(s,1),o.writeQuery({query:ri,variables:{idLibro:this.idLibro},data:n})):console.log("El cuadro texto no existía en el caché")}else console.log("No existía la pagina en el caché")},removeCuadroImagenFromCache:function(i,e){var o=this.$apollo.provider.defaultClient,t=o.readQuery({query:ri,variables:{idLibro:this.idLibro}}),n=JSON.parse(JSON.stringify(t)),a=n.libro.paginas.find((function(i){return i.id==e}));if(a){var s=a.cuadrosImagen.findIndex((function(e){return e.id==i}));s>-1?(a.cuadrosImagen.splice(s,1),o.writeQuery({query:ri,variables:{idLibro:this.idLibro},data:n})):console.log("El cuadro texto no existía en el caché")}else console.log("No existía la pagina en el caché")}}},di=ui,ci=(o("66e6"),Object(B["a"])(di,I,z,!1,null,"1aa26e8c",null)),li=ci.exports,Ai=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{attrs:{id:"misLibros"}},[t("h3",[i._v("Mis libros")]),t("div",{attrs:{id:"controlesMisLibros"}},[t("img",{staticClass:"bControlMisLibros",attrs:{src:o("1d2e"),title:"Crear nuevo libro"},on:{click:i.crearNuevoLibro}})]),t("div",{attrs:{id:"listaMisLibros"}},i._l(i.misLibros,(function(e){return t("div",{key:e.id,staticClass:"portadaLibro",on:{click:function(o){return i.seleccionarLibro(e.id)}}},[i._v(" "+i._s(e.titulo)+" ")])})),0)])},gi=[],hi=Object(M["gql"])(x||(x=Object(L["a"])(["\n  query {\n    misLibros {\n      id\n      titulo\n    }\n  }\n"]))),mi={name:"MisLibros",apollo:{misLibros:{query:hi,skip:function(){return null==this.usuario.id}}},data:function(){return{}},methods:{crearNuevoLibro:function(){var i=this;confirm("¿Crear un nuevo libro?")&&this.$apollo.mutate({mutation:Object(M["gql"])(v||(v=Object(L["a"])(["\n          mutation {\n            crearNuevoLibro {\n              id\n              titulo\n            }\n          }\n        "])))}).then((function(e){var o=e.data.crearNuevoLibro;console.log("Creado ".concat(JSON.stringify(o)));var t=i.$apollo.provider.defaultClient,n=t.readQuery({query:hi}),a=JSON.parse(JSON.stringify(n));a.misLibros.some((function(i){return i.id==o.id}))?console.log("El libro ya estaba incluido en el caché"):(a.misLibros.push(o),t.writeQuery({query:hi,data:a}))}))},seleccionarLibro:function(i){this.$emit("libroSeleccionado",i)}}},fi=mi,pi=(o("dd1f"),Object(B["a"])(fi,Ai,gi,!1,null,"24147a09",null)),xi=pi.exports,vi={name:"App",components:{Libro:li,MisLibros:xi},data:function(){return{idLibroSeleccionado:null}},methods:{seleccionarLibro:function(i){this.idLibroSeleccionado=i}},mounted:function(){var i=window.location.search.substring(1),e=new URLSearchParams(i);this.idLibro=e.get("id");var o=e.get("t");console.log("Token: ".concat(o)),o&&o.length>10?(this.$store.commit("setToken",o),this.$store.commit("setUserInfo",o),localStorage.setItem("token",o)):(this.$store.commit("deslogearse"),localStorage.clear())}},bi=vi,yi=(o("034f"),Object(B["a"])(bi,T,C,!1,null,null,null)),Ti=yi.exports,Ci=o("5530"),Ii=(o("d81d"),o("09bf")),zi=o("e312"),Li=o("b7cf"),Ei=o("522d"),Si=S()(b||(b=Object(L["a"])(["\n    \n    enum TiposUsuario{\n        USUARIO,\n        ADMINISTRADOR,\n        SUPERADMINSTRADOR\n    }\n    \n    type Usuario{\n        username:String,\n        permisos: TiposUsuario\n     }\n\n    type Mutations{ \n        setUsuario(username: String, permisos: TiposUsuario):Usuario\n    }\n"]))),Pi={},wi=o("11c2"),Mi=o("a000"),Di=o("36f1"),Oi=o("f5a8"),$i=o("a1b6");y["a"].use(Ei["a"]);var Fi=new zi["a"],Ni=function(){return localStorage.getItem("token")},ji="https://pe-pe-pe.herokuapp.com",Bi="wss://"+ji.substr(7)+"/subscripciones",ki=Object(Li["a"])({uri:ji+"/graphql"}),Qi=new Mi["a"]({uri:Bi,options:{reconnect:!0,connectionParams:{headers:{Authorization:"Bearer ".concat(Ni())}}}}),Ui=Object(Oi["a"])((function(i,e){var o=e.headers;return{headers:Object(Ci["a"])(Object(Ci["a"])({},o),{},{authorization:Ni()})}})),Ri=Object($i["a"])((function(i){i.graphQLErrors,i.networkError})),qi=Ri.concat(Ui).concat(ki),Hi=Object(wi["split"])((function(i){var e=i.query,o=Object(Di["l"])(e);return"OperationDefinition"===o.kind&&"subscription"===o.operation}),Qi,qi),Vi=new Ii["a"]({link:Hi,cache:Fi,typeDefs:Si,resolvers:Pi,connectToDevTools:!0}),Wi=new Ei["a"]({defaultClient:Vi}),Ji=(o("1276"),o("5319"),o("a15b"),o("fb6a"),o("25f0"),o("2f62"));function Gi(i){var e=i.split(".")[1],o=e.replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(o).split("").map((function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(t)}y["a"].use(Ji["a"]);var Ki=new Ji["a"].Store({state:{token:null,usuario:{username:null,nombres:null,id:null}},mutations:{setToken:function(i,e){i.token=e},setUserInfo:function(i,e){var o=Gi(e);i.usuario.username=o.username,i.usuario.id=o.id},deslogearse:function(i){i.usuario.username=null,i.usuario.id=null,i.token=null}}});y["a"].config.productionTip=!1,y["a"].mixin({data:function(){return{serverUrl:ji}},computed:{usuario:function(){return this.$store.state.usuario}}}),new y["a"]({render:function(i){return i(Ti)},store:Ki,apolloProvider:Wi}).$mount("#app")},6:function(i,e){},"66e6":function(i,e,o){"use strict";o("7f23")},7:function(i,e){},"7f23":function(i,e,o){},8:function(i,e){},"85ec":function(i,e,o){},"885c":function(i,e){i.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAjVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADqhzP4AAAALnRSTlMA3x8j4xUmzPyx3gFmiAfUqRhE9zoq6dqbDrl9bu/DoJSCaVtQQPKzpnVfVUo0WjuT0wAAAcBJREFUWMPt2NlygjAAhWEhhoSwr+5LXbr3vP/jdZg6NYoaQ3LRsfx3evENkAUmg76+Ry6grlE0OPWqiAnHIMGiSvY8H8b5nnS/ESwUHe+aMhsgo7+gK9BUOx2r0STcI+g0f6xKt2PlCgCcM7AuB50r6xYo/9bPG/49MM7cLLYH0jBNRJKG1BKY+xxN3M+tgDk7TubcAkh9eQVTczDkEshDYzBOIZfGpmCWQC7JTEFXSNxhSyC2r5DYfobE9igTm/NQDyThbEsVK0UH3E85eFrdWstaYDVF0ytR7TbEuQukK/w0zhT7oQJsv63Xk8GlNMF5gd+i2BzcDnGMzwJTcM8gV7xJz9aj+mD1gtMWm8Gh3ctw+qkLTsY4b/h+WHkjAOxTDwye0G700UyX2QJNy70OKA+wLG5IOeb4afqlAX44uFjh1NK2UN0Nlgz39EpUoO738ThTg/IAq1tP1KA8wOqiWA1unjVA/hSowJ1QM+0V6V4FyyX0ep7fBEkK3erwBjhZQz9nex2ccXQo2V0DwwU6xfLL4HyEji3fL4HFCJ1LihZoWg/+Q1DYAIVr/RDD+jGL7YMgy0dVnvXDtL6+B+4bd8GYEidpbS8AAAAASUVORK5CYII="},9:function(i,e){},"9cd3":function(i,e,o){"use strict";o("2c16")},b1f4:function(i,e,o){},dd1f:function(i,e,o){"use strict";o("5301")},f392:function(i,e,o){"use strict";o("b1f4")},fef7:function(i,e,o){}});
//# sourceMappingURL=app.0eebb241.js.map