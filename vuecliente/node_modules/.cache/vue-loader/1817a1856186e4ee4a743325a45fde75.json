{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/atlasConocimiento/VentanaRepasos.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/atlasConocimiento/VentanaRepasos.vue","mtime":1648741729541},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MgfSBmcm9tICIuL0F0bGFzQ29ub2NpbWllbnRvLnZ1ZSI7CmltcG9ydCBJdGVtUmVwYXNvIGZyb20gIi4vSXRlbVJlcGFzby52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBJdGVtUmVwYXNvIH0sCiAgbmFtZTogIlZlbnRhbmFSZXBhc29zIiwKICBwcm9wczogewogICAgeW86IE9iamVjdCwKICAgIGRhdG9zTm9kb3NSZXBhc2FyOiBBcnJheSwKICAgIGRhdG9zTm9kb3NVcmdlbnRlczogQXJyYXksCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaWRSZXBhc29BYmllcnRvOiBudWxsLAogICAgICBpbmljaWFkb3M6IDAsCiAgICAgIHNjcm9sbEluZGV4OiBudWxsLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGVsaW1pbmFyUmVwYXNvQ2FjaGUoaWRSZXBhc28pIHsKICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLiRhcG9sbG8ucHJvdmlkZXIuZGVmYXVsdENsaWVudDsKICAgICAgY29uc3QgY2FjaGUgPSBzdG9yZS5yZWFkUXVlcnkoewogICAgICAgIHF1ZXJ5OiBRVUVSWV9EQVRPU19VU1VBUklPX05PRE9TLAogICAgICB9KTsKICAgICAgdmFyIG51ZXZvQ2FjaGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7CiAgICAgIHZhciBpbmRleEkgPSBudWV2b0NhY2hlLnlvLmF0bGFzLnJlcGFzb3MuZmluZEluZGV4KAogICAgICAgIChyKSA9PiByLmlkID09PSBpZFJlcGFzbwogICAgICApOwogICAgICBpZiAoaW5kZXhJID4gLTEpIHsKICAgICAgICBudWV2b0NhY2hlLnlvLmF0bGFzLnJlcGFzb3Muc3BsaWNlKGluZGV4SSwgMSk7CiAgICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgICBxdWVyeTogUVVFUllfREFUT1NfVVNVQVJJT19OT0RPUywKICAgICAgICAgIGRhdGE6IG51ZXZvQ2FjaGUsCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coYEVsIHJlcGFzbyBubyBlc3RhYmEgZW4gY2FjaMOpYCk7CiAgICAgIH0KICAgIH0sCiAgICB0b2dnbGVSZXBhc29BYmllcnRvKGlkUmVwYXNvKSB7CiAgICAgIGlmIChpZFJlcGFzbyA9PT0gdGhpcy5pZFJlcGFzb0FiaWVydG8pIHsKICAgICAgICB0aGlzLmlkUmVwYXNvQWJpZXJ0byA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pZFJlcGFzb0FiaWVydG8gPSBpZFJlcGFzbzsKICAgICAgfQogICAgfSwKICAgIGNvbnRhckluaWNpYWRvcygpIHsKICAgICAgdGhpcy5pbmljaWFkb3MrKzsKICAgICAgY29uc29sZS5sb2coYEluaWNpYWRvczogJHt0aGlzLmluaWNpYWRvc31gKTsKICAgICAgaWYgKHRoaXMuaW5pY2lhZG9zID09PSB0aGlzLmRhdG9zTm9kb3NSZXBhc2FyLmxlbmd0aCkgewogICAgICAgIGNvbnNvbGUubG9nKGBUb2RvcyBjb21wbGV0b3NgKTsKICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmlkUmVwYXNvKSB7CiAgICAgICAgICBjb25zdCBpbmRleFIgPSB0aGlzLm5vZG9zUmVwYXNhck9yZGVuYWRvcy5maW5kSW5kZXgoCiAgICAgICAgICAgIChucikgPT4gbnIuaWQgPT09IHRoaXMuJHJvdXRlLnBhcmFtcy5pZFJlcGFzbwogICAgICAgICAgKTsKICAgICAgICAgIGlmIChpbmRleFIgPiAtMSkgewogICAgICAgICAgICB0aGlzLnNjcm9sbEluZGV4ID0gaW5kZXhSOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBub2Rvc1JlcGFzYXJPcmRlbmFkb3MoKSB7CiAgICAgIHZhciBkYXRvcyA9IHRoaXMuZGF0b3NOb2Rvc1JlcGFzYXIubWFwKChkbikgPT4gewogICAgICAgIHZhciB0aWVtcG9SZXN0YW50ZVRvUmVwYXNvID0KICAgICAgICAgIG5ldyBEYXRlKGRuLmVzdHVkaWFkbykuZ2V0VGltZSgpICsKICAgICAgICAgIGRuLml0ZXJhY2lvbmVzUmVwYXNvWzBdLmludGVydmFsbyAtCiAgICAgICAgICBEYXRlLm5vdygpOwoKICAgICAgICB2YXIgcG9yY2VudGFqZUludGVydmFsb1Jlc3RhbnRlID0gTWF0aC5yb3VuZCgKICAgICAgICAgICh0aWVtcG9SZXN0YW50ZVRvUmVwYXNvICogMTAwKSAvIGRuLml0ZXJhY2lvbmVzUmVwYXNvWzBdLmludGVydmFsbwogICAgICAgICk7CiAgICAgICAgdmFyIHBvcmNlbnRhamVJbnRlcnZhbG9UcmFuc2N1cnJpZG8gPSAxMDAgLSBwb3JjZW50YWplSW50ZXJ2YWxvUmVzdGFudGU7CiAgICAgICAgaWYgKHBvcmNlbnRhamVJbnRlcnZhbG9UcmFuc2N1cnJpZG8gPiAxMDApCiAgICAgICAgICBwb3JjZW50YWplSW50ZXJ2YWxvVHJhbnNjdXJyaWRvID0gMTAwOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICAuLi5kbiwKICAgICAgICAgIHRpZW1wb1Jlc3RhbnRlVG9SZXBhc28sCiAgICAgICAgICBwb3JjZW50YWplSW50ZXJ2YWxvUmVzdGFudGUsCiAgICAgICAgICBwb3JjZW50YWplSW50ZXJ2YWxvVHJhbnNjdXJyaWRvLAogICAgICAgIH07CiAgICAgIH0pOwoKICAgICAgZGF0b3Muc29ydCgoYSwgYikgPT4gYS50aWVtcG9SZXN0YW50ZVRvUmVwYXNvIC0gYi50aWVtcG9SZXN0YW50ZVRvUmVwYXNvKTsKICAgICAgcmV0dXJuIGRhdG9zOwogICAgfSwKICB9LAogIG1vdW50ZWQoKSB7CiAgICBjb25zb2xlLmxvZyhgTW9udGFkYSBjb24gaWQgcmVwYXNvOiAke3RoaXMuJHJvdXRlLnBhcmFtcy5pZFJlcGFzb31gKTsKICAgIHRoaXMuaWRSZXBhc29BYmllcnRvID0gdGhpcy4kcm91dGUucGFyYW1zLmlkUmVwYXNvOwogICAgaWYgKHRoaXMuc2Nyb2xsSW5kZXgpIHsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coYFNjcm9sbGluZyBpbnRvIHZpZXcgZWwgaXRlbSAke3RoaXMuc2Nyb2xsSW5kZXh9YCk7CiAgICAgICAgdGhpcy4kcmVmcy5pdGVtc1JlcGFzb1t0aGlzLnNjcm9sbEluZGV4XS4kZWwuc2Nyb2xsSW50b1ZpZXcoKTsKICAgICAgfSwgNTAwKTsKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["VentanaRepasos.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VentanaRepasos.vue","sourceRoot":"src/components/atlasConocimiento","sourcesContent":["<template>\n  <div class=\"ventanaRepasos\">\n    <div id=\"barraSuperior\">\n      <div id=\"titulo\">Temas para repasar</div>\n      <div\n        class=\"boton\"\n        id=\"botonCerrar\"\n        title=\"Cerrar\"\n        @click=\"$router.push({ name: 'atlas' })\"\n      >\n        <img src=\"@/assets/iconos/equis.svg\" alt=\"Equis\" />\n      </div>\n    </div>\n    <div id=\"zonaTemas\">\n      <div id=\"listaTemas\">\n        <item-repaso\n          v-for=\"repaso of nodosRepasarOrdenados\"\n          :key=\"repaso.id\"\n          ref=\"itemsRepaso\"\n          :esteRepaso=\"repaso\"\n          :mostrarRepasos=\"idRepasoAbierto === repaso.id\"\n          @iniciado=\"contarIniciados\"\n          @toggleAbierto=\"toggleRepasoAbierto(repaso.id)\"\n          @meElimine=\"eliminarRepasoCache(repaso.id)\"\n          @centrarEnNodo=\"$emit('centrarEnNodo', repaso.idNodo)\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { QUERY_DATOS_USUARIO_NODOS } from \"./AtlasConocimiento.vue\";\nimport ItemRepaso from \"./ItemRepaso.vue\";\nexport default {\n  components: { ItemRepaso },\n  name: \"VentanaRepasos\",\n  props: {\n    yo: Object,\n    datosNodosRepasar: Array,\n    datosNodosUrgentes: Array,\n  },\n  data() {\n    return {\n      idRepasoAbierto: null,\n      iniciados: 0,\n      scrollIndex: null,\n    };\n  },\n  methods: {\n    eliminarRepasoCache(idRepaso) {\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      var indexI = nuevoCache.yo.atlas.repasos.findIndex(\n        (r) => r.id === idRepaso\n      );\n      if (indexI > -1) {\n        nuevoCache.yo.atlas.repasos.splice(indexI, 1);\n        store.writeQuery({\n          query: QUERY_DATOS_USUARIO_NODOS,\n          data: nuevoCache,\n        });\n      } else {\n        console.log(`El repaso no estaba en cachÃ©`);\n      }\n    },\n    toggleRepasoAbierto(idRepaso) {\n      if (idRepaso === this.idRepasoAbierto) {\n        this.idRepasoAbierto = null;\n      } else {\n        this.idRepasoAbierto = idRepaso;\n      }\n    },\n    contarIniciados() {\n      this.iniciados++;\n      console.log(`Iniciados: ${this.iniciados}`);\n      if (this.iniciados === this.datosNodosRepasar.length) {\n        console.log(`Todos completos`);\n        if (this.$route.params.idRepaso) {\n          const indexR = this.nodosRepasarOrdenados.findIndex(\n            (nr) => nr.id === this.$route.params.idRepaso\n          );\n          if (indexR > -1) {\n            this.scrollIndex = indexR;\n          }\n        }\n      }\n    },\n  },\n  computed: {\n    nodosRepasarOrdenados() {\n      var datos = this.datosNodosRepasar.map((dn) => {\n        var tiempoRestanteToRepaso =\n          new Date(dn.estudiado).getTime() +\n          dn.iteracionesRepaso[0].intervalo -\n          Date.now();\n\n        var porcentajeIntervaloRestante = Math.round(\n          (tiempoRestanteToRepaso * 100) / dn.iteracionesRepaso[0].intervalo\n        );\n        var porcentajeIntervaloTranscurrido = 100 - porcentajeIntervaloRestante;\n        if (porcentajeIntervaloTranscurrido > 100)\n          porcentajeIntervaloTranscurrido = 100;\n        return {\n          ...dn,\n          tiempoRestanteToRepaso,\n          porcentajeIntervaloRestante,\n          porcentajeIntervaloTranscurrido,\n        };\n      });\n\n      datos.sort((a, b) => a.tiempoRestanteToRepaso - b.tiempoRestanteToRepaso);\n      return datos;\n    },\n  },\n  mounted() {\n    console.log(`Montada con id repaso: ${this.$route.params.idRepaso}`);\n    this.idRepasoAbierto = this.$route.params.idRepaso;\n    if (this.scrollIndex) {\n      setTimeout(() => {\n        console.log(`Scrolling into view el item ${this.scrollIndex}`);\n        this.$refs.itemsRepaso[this.scrollIndex].$el.scrollIntoView();\n      }, 500);\n    }\n  },\n};\n</script>\n\n<style scoped>\n.ventanaRepasos {\n  width: min(500px, 100vw);\n}\n#barraSuperior {\n  display: flex;\n  padding: 10px;\n  font-family: Salsa, cursive;\n  font-size: 20px;\n}\n#botonCerrar {\n  margin-left: auto;\n}\n#listaTemas {\n  padding-bottom: 100px;\n  overflow-y: scroll;\n  height: min(700px, 80vh);\n}\n</style>"]}]}