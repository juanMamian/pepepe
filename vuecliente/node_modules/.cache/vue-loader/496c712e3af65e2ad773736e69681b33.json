{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/usuario/IconoPersonaAutonomo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/usuario/IconoPersonaAutonomo.vue","mtime":1644587546122},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgeyBmcmFnbWVudG9NaW5pbW9QZXJzb25hIH0gZnJvbSAiLi4vdXRpbGlkYWRlcy9yZWN1cnNvc0dxbCI7Cgpjb25zdCBRVUVSWV9QRVJTT05BID0gZ3FsYAogIHF1ZXJ5ICgkaWRVc3VhcmlvOiBJRCEpIHsKICAgIHB1YmxpY1VzdWFyaW8oaWRVc3VhcmlvOiAkaWRVc3VhcmlvKSB7CiAgICAgIC4uLmZyYWdNaW5pbW9QZXJzb25hCiAgICB9CiAgfQogICR7ZnJhZ21lbnRvTWluaW1vUGVyc29uYX0KYDsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiSWNvbm9QZXJzb25hQXV0b25vbW8iLAogIGFwb2xsbzogewogICAgZXN0YVBlcnNvbmE6IHsKICAgICAgcXVlcnk6IFFVRVJZX1BFUlNPTkEsCiAgICAgIHZhcmlhYmxlcygpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWRVc3VhcmlvOiB0aGlzLmlkUGVyc29uYSwKICAgICAgICB9OwogICAgICB9LAogICAgICB1cGRhdGUoeyBwdWJsaWNVc3VhcmlvIH0pIHsKICAgICAgICByZXR1cm4gcHVibGljVXN1YXJpbzsKICAgICAgfSwKICAgICAgc2tpcCgpIHsKICAgICAgICByZXR1cm4gIXRoaXMuaWRQZXJzb25hOwogICAgICB9LAogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlc3RhUGVyc29uYTogewogICAgICAgIHBlcm1pc29zOiBbXSwKICAgICAgfSwKICAgICAgbnVldm9QZXJtaXNvOiBudWxsLAogICAgICBtb3VudGVkOiBmYWxzZSwKICAgICAgZm90b2dyYWZpYUVuYWJsZWQ6IGZhbHNlLAoKICAgICAgYmFzaWNXaWR0aEZvdG86IDcwLAogICAgICBiYXNpY0ZvbnRTaXplTm9tYnJlOiAxNSwKICAgIH07CiAgfSwKICBwcm9wczogewogICAgaWRQZXJzb25hOiBTdHJpbmcsCiAgICBzZWxlY2Npb25hZG86IEJvb2xlYW4sCiAgICBtZW51Q29udGV4dHVhbDogQm9vbGVhbiwKICAgIGZhY3RvckVzY2FsYTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICIxIiwKICAgIH0sCiAgICBvcGNpb25lc01lbnVDeDogewogICAgICB0eXBlOiBBcnJheSwKICAgIH0sCiAgfSwKICBjb21wdXRlZDogewogICAgc295WW8oKSB7CiAgICAgIGlmICh0aGlzLm1vdW50ZWQgJiYgdGhpcy5pZFBlcnNvbmEgJiYgdGhpcy4kc3RvcmUuc3RhdGUudXN1YXJpbykgewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c3VhcmlvLmlkID09IHRoaXMuaWRQZXJzb25hID8gdHJ1ZSA6IGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBvZmZzZXRGb3RvKCkgewogICAgICByZXR1cm4gewogICAgICAgIHdpZHRoOiB0aGlzLmJhc2ljV2lkdGhGb3RvICogdGhpcy5mYWN0b3IgKyAicHgiLAogICAgICAgIGhlaWdodDogdGhpcy5iYXNpY1dpZHRoRm90byAqIHRoaXMuZmFjdG9yICsgInB4IiwKICAgICAgfTsKICAgIH0sCiAgICBvZmZzZXRJY29ubygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogdGhpcy5iYXNpY1dpZHRoRm90byAqIHRoaXMuZmFjdG9yICsgInB4IiwKICAgICAgfTsKICAgIH0sCiAgICBmYWN0b3IoKSB7CiAgICAgIHJldHVybiBOdW1iZXIodGhpcy5mYWN0b3JFc2NhbGEpOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGFkZFBlcm1pc29zKCkgewogICAgICBjb25zb2xlLmxvZygKICAgICAgICBgZW52aWFuZG8gJHt0aGlzLm51ZXZvUGVybWlzb30gcGFyYSBlbCB1c3VhcmlvIGNvbiBpZCAke3RoaXMuaWRQZXJzb25hfWAKICAgICAgKTsKICAgICAgdGhpcy4kYXBvbGxvCiAgICAgICAgLm11dGF0ZSh7CiAgICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgICBtdXRhdGlvbiAoJG51ZXZvUGVybWlzbzogU3RyaW5nISwgJGlkVXN1YXJpbzogSUQhKSB7CiAgICAgICAgICAgICAgYWRkUGVybWlzb1VzdWFyaW8oCiAgICAgICAgICAgICAgICBudWV2b1Blcm1pc286ICRudWV2b1Blcm1pc28KICAgICAgICAgICAgICAgIGlkVXN1YXJpbzogJGlkVXN1YXJpbwogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgaWQKICAgICAgICAgICAgICAgIHBlcm1pc29zCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICBgLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIG51ZXZvUGVybWlzbzogdGhpcy5udWV2b1Blcm1pc28sCiAgICAgICAgICAgIGlkVXN1YXJpbzogdGhpcy5pZFBlcnNvbmEsCiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4ge30pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yOiAiICsgZXJyb3IpOwogICAgICAgIH0pOwogICAgfSwKICAgIGNvcGlhcklkKGUpIHsKICAgICAgbGV0IHN0ciA9IGUudGFyZ2V0LmlubmVyVGV4dC50cmltKCk7CiAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKTsKICAgICAgZWwudmFsdWUgPSBzdHI7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpOwogICAgICBlbC5zZWxlY3QoKTsKICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoImNvcHkiKTsKICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbCk7CiAgICB9LAogICAgZm90b2dyYWZpYUNhcmdhZGEoKSB7CiAgICAgIGNvbnNvbGUubG9nKGBGb3RvZ3JhZsOtYSBjYXJnYWRhYCk7CiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMubW91bnRlZCA9IHRydWU7CiAgfSwKICBiZWZvcmVSb3V0ZVVwZGF0ZSgpIHsKICAgIGNvbnNvbGUubG9nKGBCZWZvcmUgdXBkYXRlYCk7CiAgfSwKfTsK"},{"version":3,"sources":["IconoPersonaAutonomo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"IconoPersonaAutonomo.vue","sourceRoot":"src/components/usuario","sourcesContent":["<template>\n  <div class=\"iconoPersonaAutonomo\" :class=\"{ yo: soyYo }\" :style=\"[offsetIcono]\">\n    <img\n      class=\"fotografia\"\n      :src=\"this.serverUrl + '/api/usuarios/fotografias/' + idPersona\"\n      :style=\"[offsetFoto]\"\n      v-show=\"fotografiaEnabled\"\n      @load=\"fotografiaEnabled = true\"\n      alt=\"Usuario\"\n    />\n    <div id=\"contenedorAlertas\">\n      <slot name=\"alertas\"></slot>\n    </div>\n    <div\n      class=\"nombres\"\n      :class=\"{ nombreSeleccionado: seleccionado }\"\n      :style=\"[{ fontSize: basicFontSizeNombre * factor + 'px' }]\"\n    >\n      {{ estaPersona.nombres }}\n    </div>\n    <div id=\"menuCxPersona\" v-show=\"menuContextual\">\n      <div class=\"botonMenuCx\" @click.stop=\"copiarId\">{{ idPersona }}</div>\n      <div class=\"botonMenuCx\" v-if=\"usuarioSuperadministrador\">\n        {{ estaPersona.username }}\n      </div>\n      <input type=\"text\" v-model=\"nuevoPermiso\" placeholder=\"Nuevo permiso\" />\n      <div class=\"botonMenuCx\" @click.stop=\"addPermisos\">Dar permiso</div>\n      <div\n        class=\"botonMenuCx\"\n        :key=\"index\"\n        v-for=\"(opcionCx, index) of opcionesMenuCx\"\n        @click=\"$emit(opcionCx.evento)\"\n      >\n        {{ opcionCx.textoVisible }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport { fragmentoMinimoPersona } from \"../utilidades/recursosGql\";\n\nconst QUERY_PERSONA = gql`\n  query ($idUsuario: ID!) {\n    publicUsuario(idUsuario: $idUsuario) {\n      ...fragMinimoPersona\n    }\n  }\n  ${fragmentoMinimoPersona}\n`;\n\nexport default {\n  name: \"IconoPersonaAutonomo\",\n  apollo: {\n    estaPersona: {\n      query: QUERY_PERSONA,\n      variables() {\n        return {\n          idUsuario: this.idPersona,\n        };\n      },\n      update({ publicUsuario }) {\n        return publicUsuario;\n      },\n      skip() {\n        return !this.idPersona;\n      },\n    },\n  },\n  data() {\n    return {\n      estaPersona: {\n        permisos: [],\n      },\n      nuevoPermiso: null,\n      mounted: false,\n      fotografiaEnabled: false,\n\n      basicWidthFoto: 70,\n      basicFontSizeNombre: 15,\n    };\n  },\n  props: {\n    idPersona: String,\n    seleccionado: Boolean,\n    menuContextual: Boolean,\n    factorEscala: {\n      type: String,\n      default: \"1\",\n    },\n    opcionesMenuCx: {\n      type: Array,\n    },\n  },\n  computed: {\n    soyYo() {\n      if (this.mounted && this.idPersona && this.$store.state.usuario) {\n        return this.$store.state.usuario.id == this.idPersona ? true : false;\n      }\n      return false;\n    },\n    offsetFoto() {\n      return {\n        width: this.basicWidthFoto * this.factor + \"px\",\n        height: this.basicWidthFoto * this.factor + \"px\",\n      };\n    },\n    offsetIcono() {\n      return {\n        width: this.basicWidthFoto * this.factor + \"px\",\n      };\n    },\n    factor() {\n      return Number(this.factorEscala);\n    },\n  },\n  methods: {\n    addPermisos() {\n      console.log(\n        `enviando ${this.nuevoPermiso} para el usuario con id ${this.idPersona}`\n      );\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($nuevoPermiso: String!, $idUsuario: ID!) {\n              addPermisoUsuario(\n                nuevoPermiso: $nuevoPermiso\n                idUsuario: $idUsuario\n              ) {\n                id\n                permisos\n              }\n            }\n          `,\n          variables: {\n            nuevoPermiso: this.nuevoPermiso,\n            idUsuario: this.idPersona,\n          },\n        })\n        .then(() => {})\n        .catch((error) => {\n          console.log(\"error: \" + error);\n        });\n    },\n    copiarId(e) {\n      let str = e.target.innerText.trim();\n      const el = document.createElement(\"textarea\");\n      el.value = str;\n      document.body.appendChild(el);\n      el.select();\n      document.execCommand(\"copy\");\n      document.body.removeChild(el);\n    },\n    fotografiaCargada() {\n      console.log(`Fotograf√≠a cargada`);\n    },\n  },\n  mounted() {\n    this.mounted = true;\n  },\n  beforeRouteUpdate() {\n    console.log(`Before update`);\n  },\n};\n</script>\n\n<style scoped>\n.iconoPersonaAutonomo {\n  cursor: pointer;\n  position: relative;\n  border-radius: 50%;\n  margin-bottom: 50px;\n  user-select: none;\n}\n\n.fotografia {\n  border-radius: 50%;\n  pointer-events: none;\n}\n\n#contenedorAlertas {\n  position: absolute;\n  top: 0;\n  right: 0;\n}\n\n.nombres {\n  background-color: rgb(243, 216, 204);\n  position: absolute;\n  top: 105%;\n  left: 50%;\n  transform: translateX(-50%);\n  text-align: center;\n  border: 1px solid rgb(105, 24, 24);\n  padding: 3px 5px;\n  border-radius: 5px;\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n.nombreSeleccionado {\n  background-color: rgb(241, 116, 63);\n}\n\n.botonMenuCx {\n  cursor: pointer;\n  font-size: 14px;\n  padding: 3px 7px;\n}\n.seccionMenuCx {\n  font-size: 15px;\n  color: rgb(71, 71, 71);\n}\n.infoMenuCx {\n  font-size: 15px;\n  color: rgb(107, 107, 107);\n}\n.botonMenuCx:hover {\n  background-color: gray;\n}\n#menuCxPersona {\n  position: absolute;\n  top: 110%;\n  left: 110%;\n  min-width: 140px;\n\n  z-index: 10;\n  background-color: rgb(177, 177, 159);\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n</style>"]}]}