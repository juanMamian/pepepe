{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/calendario/BloqueHorario.vue?vue&type=style&index=0&id=c48224ea&scoped=true&lang=css&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/calendario/BloqueHorario.vue","mtime":1674568326919},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYmxvcXVlSG9yYXJpbyB7CiAgaGVpZ2h0OiAxMDBweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjYTA0ZDRkOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDBweDsKICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogIGJvcmRlcjogMXB4IHNvbGlkIHJnYigxMTAsIDExMCwgMTEwKTsKfQouYmxvcXVlSG9yYXJpby5zZWxlY2Npb25hZG8gewogIGZpbHRlcjogYnJpZ2h0bmVzcygxLjcpOwogIGJvcmRlcjogMnB4IHNvbGlkIHdoaXRlOwp9Ci5ibG9xdWVIb3JhcmlvLnVzdWFyaW9Bc2lzdGUgewp9CiNib3Rvbk9wY2lvbmVzIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAxMHB4OwogIGxlZnQ6IGNhbGMoMTAwJSArIDBweCk7Cn0KI2JhcnJhVGFnIHsKICBtaW4taGVpZ2h0OiAyMHB4OwogIHdpZHRoOiAxMDAlOwogIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCByZ2IoMjA0LCAyMDQsIDIwNCk7CiAgcGFkZGluZzogNXB4IDEwcHg7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKfQojbm9tYnJlIHsKICBkaXNwbGF5OiBmbGV4OwogIGdhcDogMTBweDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwp9CiNjYW50aWRhZEFzaXN0ZW50ZXMgewogIHdpZHRoOiAxMDAlOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBmb250LXNpemU6IDEzcHg7Cn0KI21lbnVDb250ZXh0dWFsIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAwJTsKICBsZWZ0OiA1MCU7Cn0KCiNtZW51Q29udGV4dHVhbC5zZWxlY2Npb25hZG8gewogIGNvbG9yOiBibGFjazsKfQoKI21lbnVDb250ZXh0dWFsOm5vdCguc2VsZWNjaW9uYWRvKSB7CiAgY29sb3I6IGFudGlxdWV3aGl0ZTsKfQouaXRlbU1lbnVDb250ZXh0dWFsIHsKICBwYWRkaW5nOiAxMHB4IDEwcHg7CiAgZm9udC1zaXplOiAxMnB4OwogIGN1cnNvcjogcG9pbnRlcjsKfQouaXRlbU1lbnVDb250ZXh0dWFsOmhvdmVyIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoNTksIDU5LCA1OSk7Cn0K"},{"version":3,"sources":["BloqueHorario.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BloqueHorario.vue","sourceRoot":"src/components/calendario","sourcesContent":["<template>\n  <div\n    class=\"bloqueHorario\"\n    :class=\"{\n      seleccionado,\n      deshabilitado: eliminandose || settingTiempos,\n      usuarioAsiste,\n    }\"\n    :style=\"[\n      { width: duracionMinutos * factorZoom + 'px', backgroundColor: miColor },\n    ]\"\n    @contextmenu.exact.prevent.stop=\"$emit('menuContextual', esteBloque.id)\"\n    @dblclick=\"toggleDuracionBloque\"\n    @click.left=\"$emit('seleccionado')\"\n  >\n    <div\n      class=\"boton\"\n      v-show=\"seleccionado\"\n      @click.stop=\"$emit('menuContextual', esteBloque.id)\"\n      id=\"botonOpciones\"\n    >\n      <img src=\"@/assets/iconos/ellipsisVertical.svg\" alt=\"Opciones\" />\n    </div>\n    <div id=\"barraTag\" :style=\"[colorBarraTag]\">\n      <div id=\"nombre\">\n        <img\n          src=\"@/assets/iconos/babySolid.svg\"\n          v-if=\"esteBloque.paraChiquis\"\n          alt=\"bebé\"\n          style=\"height: 15px\"\n        />{{ esteBloque.nombreEspacio }}\n      </div>\n    </div>\n\n    <div\n      id=\"cantidadAsistentes\"\n      v-if=\"\n        esteBloque.idsParticipantesConstantes &&\n        esteBloque.idsParticipantesConstantes.length > 0 &&\n        mostrarCantidadAsistentes\n      \"\n      v-show=\"!seleccionado\"\n    >\n      Asistentes: {{ esteBloque.idsParticipantesConstantes.length }}\n    </div>\n\n    <div\n      id=\"botonExpandir\"\n      class=\"boton\"\n      style=\"margin: 0px auto\"\n      @click.stop=\"expandir\"\n      v-show=\"seleccionado\"\n    >\n      <img src=\"@/assets/iconos/expand.svg\" alt=\"expandir\" style=\"\" />\n    </div>\n\n    <loading v-show=\"eliminandose || settingTiempos\" />\n\n    <div\n      id=\"menuContextual\"\n      :class=\"{ seleccionado }\"\n      @click.stop=\"\"\n      @dblclick.stop=\"\"\n      v-show=\"mostrandoMenuContextual\"\n    >\n      <div\n        class=\"itemMenuContextual\"\n        v-if=\"usuarioAdministrador || usuarioSuperadministrador\"\n        @click=\"eliminarse\"\n      >\n        Eliminar\n      </div>\n      <div class=\"itemMenuContextual\" @click=\"$refs.inputColor.click()\">\n        Seleccionar color\n      </div>\n      <div\n        class=\"itemMenuContextual\"\n        v-if=\"usuarioAdministrador || usuarioSuperadministrador\"\n        @click=\"iniciarSetHoraInicio\"\n      >\n        Fijar hora de inicio\n      </div>\n      <input\n        type=\"time\"\n        :value=\"tiempoInicioFormateado\"\n        v-show=\"editandoHoraInicio\"\n        ref=\"inputHoraInicio\"\n        id=\"inputHoraInicio\"\n        @change=\"setHoraInicio\"\n      />\n\n      <div\n        class=\"itemMenuContextual\"\n        v-if=\"usuarioAdministrador || usuarioSuperadministrador\"\n        @click=\"iniciarSetHoraFinal\"\n      >\n        Fijar hora de finalización\n      </div>\n      <input\n        type=\"time\"\n        :value=\"tiempoFinalFormateado\"\n        v-show=\"editandoHoraFinal\"\n        ref=\"inputHoraFinal\"\n        id=\"inputHoraFinal\"\n        @change=\"setHoraFinal\"\n      />\n\n      <input\n        type=\"color\"\n        ref=\"inputColor\"\n        @change=\"setColorEspacio\"\n        v-show=\"false\"\n        id=\"inputColor\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport Loading from \"../utilidades/Loading.vue\";\nexport default {\n  components: { Loading },\n  name: \"BloqueHorario\",\n  props: {\n    esteBloque: Object,\n    idBloqueSeleccionado: String,\n    factorZoom: Number,\n    idBloqueMenuContextual: String,\n    mostrarCantidadAsistentes: Boolean,\n  },\n\n  data() {\n    var coloresEspacios = localStorage.getItem(\"coloresEspacios\")\n      ? JSON.parse(localStorage.getItem(\"coloresEspacios\"))\n      : [];\n\n    return {\n      coloresEspacios,\n      eliminandose: false,\n      settingTiempos: false,\n      mostrarVentana: false,\n\n      editandoHoraInicio: false,\n      editandoHoraFinal: false,\n    };\n  },\n  computed: {\n    duracionMinutos() {\n      return Math.round(\n        (this.esteBloque.millisFinal - this.esteBloque.millisInicio) / 60000\n      );\n    },\n    mostrandoMenuContextual() {\n      return this.idBloqueMenuContextual === this.esteBloque.id;\n    },\n    miColor() {\n      if (!this.coloresEspacios) {\n        return \"#a04d4d\";\n      }\n      const miIndex = this.coloresEspacios.findIndex(\n        (d) => d[0] === this.esteBloque.idEspacio\n      );\n\n      if (miIndex > -1) {\n        return this.coloresEspacios[miIndex][1];\n      }\n\n      return \"#a04d4d\";\n    },\n    seleccionado() {\n      return this.idBloqueSeleccionado === this.esteBloque.id;\n    },\n    usuarioAdministrador() {\n      return this.usuario.id === this.esteBloque.idAdministradorEspacio;\n    },\n    minutosInicio() {\n      return Math.round(this.esteBloque.millisInicio / 60000);\n    },\n    minutosFinal() {\n      return Math.round(this.esteBloque.millisFinal / 60000);\n    },\n    tiempoInicioFormateado() {\n      return this.toTiempoFormateado(this.minutosInicio);\n    },\n    tiempoFinalFormateado() {\n      return this.toTiempoFormateado(this.minutosFinal);\n    },\n    usuarioAsiste() {\n      return (\n        this.usuarioAdministrador ||\n        this.esteBloque.idsParticipantesConstantes.includes(this.usuario.id)\n      );\n    },\n    colorBarraTag() {\n      var color = \"rgb(182 182 182)\";\n\n      if (this.usuarioAsiste) {\n        color = \"var(--calendarioUsuario)\";\n      }\n      if (this.usuarioAdministrador) {\n        color = \"var(--calendarioUsuarioStrong)\";\n      }\n      return {\n        backgroundColor: color,\n      };\n    },\n  },\n  methods: {\n    setColorEspacio() {\n      const inputColor = this.$refs.inputColor;\n      console.log(\n        `Setting color en ${inputColor.value} para el espacio ${this.esteBloque.nombreEspacio} con id ${this.esteBloque.idEspacio}`\n      );\n\n      const indexDupla = this.coloresEspacios.findIndex(\n        (d) => d[0] === this.esteBloque.idEspacio\n      );\n\n      if (indexDupla > -1) {\n        this.$set(this.coloresEspacios, indexDupla, [\n          this.esteBloque.idEspacio,\n          inputColor.value,\n        ]);\n      } else {\n        this.coloresEspacios.push([\n          this.esteBloque.idEspacio,\n          inputColor.value,\n        ]);\n      }\n\n      localStorage.setItem(\n        \"coloresEspacios\",\n        JSON.stringify(this.coloresEspacios)\n      );\n    },\n    eliminarse() {\n      if (!this.usuarioAdministrador && !this.usuarioSuperadministrador) {\n        console.log(\"No autorizado\");\n        return;\n      }\n\n      this.eliminandose = true;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($idEspacio: ID!, $idIteracion: ID!) {\n              eliminarIteracionSemanalEspacio(\n                idEspacio: $idEspacio\n                idIteracion: $idIteracion\n              )\n            }\n          `,\n          variables: {\n            idEspacio: this.esteBloque.idEspacio,\n            idIteracion: this.esteBloque.id,\n          },\n        })\n        .then(() => {\n          this.eliminandose = false;\n          this.$emit(\"meElimine\");\n        })\n        .catch((error) => {\n          console.log(\"Error: \" + error);\n          this.eliminandose = false;\n        });\n    },\n    toggleDuracionBloque() {\n      console.log(\n        `Toggleando bloque que tiene minutosInicio ${this.minutosInicio} y minutosFinal ${this.minutosFinal}`\n      );\n\n      if (!this.usuarioAdministrador && !this.usuarioSuperadministrador) {\n        console.log(\"No autorizado\");\n        return;\n      }\n\n      if (this.minutosInicio === 480) {\n        if (this.minutosFinal === 600) {\n          this.setMinutos(480, 540);\n        } else {\n          this.setMinutos(480, 600);\n        }\n      } else if (this.minutosInicio === 540) {\n        this.setMinutos(480, 600);\n      } else if (this.minutosInicio === 630) {\n        if (this.minutosFinal === 750) {\n          this.setMinutos(630, 690);\n        } else {\n          this.setMinutos(630, 750);\n        }\n      } else if (this.minutosInicio === 690) {\n        this.setMinutos(630, 750);\n      } else if (this.minutosInicio === 810) {\n        if (this.minutosFinal === 930) {\n          this.setMinutos(810, 870);\n        } else {\n          this.setMinutos(810, 930);\n        }\n      } else if (this.minutosInicio === 870) {\n        this.setMinutos(870, 930);\n      } else {\n        console.log(`No se pudo togglear el bloque`);\n      }\n    },\n    setMinutos(minutosInicio, minutosFinal) {\n      const millisInicio = minutosInicio * 60000;\n      const millisFinal = minutosFinal * 60000;\n\n      this.settingTiempos = true;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation (\n              $idEspacio: ID!\n              $idIteracion: ID!\n              $millisInicio: Int!\n              $millisFinal: Int!\n            ) {\n              setTiemposIteracionSemanalEspacio(\n                idEspacio: $idEspacio\n                idIteracion: $idIteracion\n                millisInicio: $millisInicio\n                millisFinal: $millisFinal\n              ) {\n                id\n                millisInicio\n                millisFinal\n              }\n            }\n          `,\n          variables: {\n            idEspacio: this.esteBloque.idEspacio,\n            idIteracion: this.esteBloque.id,\n            millisInicio,\n            millisFinal,\n          },\n        })\n        .then(() => {\n          this.settingTiempos = false;\n        })\n        .catch((error) => {\n          console.log(\"Error: \" + error);\n          this.settingTiempos = false;\n        });\n    },\n    expandir() {\n      this.$emit(\"expandirme\");\n    },\n    iniciarSetHoraInicio() {\n      this.$refs.inputHoraInicio.value = this.toTiempoFormateado(\n        this.minutosInicio\n      );\n      this.editandoHoraInicio = true;\n      this.editandoHoraFinal = false;\n    },\n    iniciarSetHoraFinal() {\n      this.$refs.inputHoraFinal.value = this.toTiempoFormateado(\n        this.minutosFinal\n      );\n      this.editandoHoraFinal = true;\n      this.editandoHoraInicio = false;\n    },\n    toTiempoFormateado(minutos) {\n      var horas = Math.floor(minutos / 60);\n      if (String(horas).length < 2) {\n        horas = \"0\" + horas;\n      }\n\n      var minutosSolos = String(Math.round(minutos - horas * 60));\n\n      if (minutosSolos.length < 2) {\n        minutosSolos = \"0\" + minutosSolos;\n      }\n\n      return horas + \":\" + minutosSolos;\n    },\n    setHoraInicio() {\n      console.log(`Setting hora inicio`);\n      const inputTime = this.$refs.inputHoraInicio.value.split(\":\");\n      const inputHoras = parseInt(inputTime[0]);\n      const inputMinutos = parseInt(inputTime[1]);\n\n      const minutosTotal = inputHoras * 60 + inputMinutos;\n\n      console.log(\"Nuevo minutos inicio: \" + minutosTotal);\n      this.setMinutos(minutosTotal, this.minutosFinal);\n    },\n    setHoraFinal() {\n      console.log(`Setting hora final`);\n      const inputTime = this.$refs.inputHoraFinal.value.split(\":\");\n      const inputHoras = parseInt(inputTime[0]);\n      const inputMinutos = parseInt(inputTime[1]);\n\n      const minutosTotal = inputHoras * 60 + inputMinutos;\n\n      console.log(\"Nuevo minutos final: \" + minutosTotal);\n      this.setMinutos(this.minutosInicio, minutosTotal);\n    },\n  },\n};\n</script>\n\n<style scoped>\n.bloqueHorario {\n  height: 100px;\n  background-color: #a04d4d;\n  position: absolute;\n  top: 0px;\n  box-sizing: border-box;\n  border: 1px solid rgb(110, 110, 110);\n}\n.bloqueHorario.seleccionado {\n  filter: brightness(1.7);\n  border: 2px solid white;\n}\n.bloqueHorario.usuarioAsiste {\n}\n#botonOpciones {\n  position: absolute;\n  top: 10px;\n  left: calc(100% + 0px);\n}\n#barraTag {\n  min-height: 20px;\n  width: 100%;\n  border-bottom: 1px solid rgb(204, 204, 204);\n  padding: 5px 10px;\n  box-sizing: border-box;\n}\n#nombre {\n  display: flex;\n  gap: 10px;\n  justify-content: center;\n  align-items: center;\n}\n#cantidadAsistentes {\n  width: 100%;\n  text-align: center;\n  font-size: 13px;\n}\n#menuContextual {\n  position: absolute;\n  top: 0%;\n  left: 50%;\n}\n\n#menuContextual.seleccionado {\n  color: black;\n}\n\n#menuContextual:not(.seleccionado) {\n  color: antiquewhite;\n}\n.itemMenuContextual {\n  padding: 10px 10px;\n  font-size: 12px;\n  cursor: pointer;\n}\n.itemMenuContextual:hover {\n  background-color: rgb(59, 59, 59);\n}\n</style>"]}]}