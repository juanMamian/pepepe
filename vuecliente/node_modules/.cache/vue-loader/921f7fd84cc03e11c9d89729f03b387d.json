{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/utilidades/DiaCalendario.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/utilidades/DiaCalendario.vue","mtime":1644587546126},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgewogIGZyYWdtZW50b0V2ZW50b1BlcnNvbmFsLAogIGZyYWdtZW50b0V2ZW50b1B1YmxpY28sCn0gZnJvbSAiLi9mcmFnc0NhbGVuZGFyaW8uanMiOwppbXBvcnQgRXZlbnRvUHVibGljb0NhbGVuZGFyaW8gZnJvbSAiLi9FdmVudG9QdWJsaWNvQ2FsZW5kYXJpby52dWUiOwppbXBvcnQgRXZlbnRvUGVyc29uYWxDYWxlbmRhcmlvIGZyb20gIi4vRXZlbnRvUGVyc29uYWxDYWxlbmRhcmlvLnZ1ZSI7CmltcG9ydCBMb2FkaW5nIGZyb20gIi4vTG9hZGluZy52dWUiOwoKY29uc3QgUVVFUllfRVZFTlRPU19QVUJMSUNPU19ESUEgPSBncWxgCiAgcXVlcnkgKCRkYXRlSW5pY2lvRGlhOiBEYXRlISkgewogICAgZXZlbnRvc1B1YmxpY29zRGlhKGRhdGVJbmljaW9EaWE6ICRkYXRlSW5pY2lvRGlhKSB7CiAgICAgIC4uLmZyYWdFdmVudG9QdWJsaWNvCiAgICB9CiAgfQogICR7ZnJhZ21lbnRvRXZlbnRvUHVibGljb30KYDsKCmNvbnN0IFFVRVJZX0VWRU5UT1NfUEVSU09OQUxFU19ESUEgPSBncWxgCiAgcXVlcnkgKCRkYXRlSW5pY2lvRGlhOiBEYXRlISwgJGlkVXN1YXJpbzogSUQhKSB7CiAgICBldmVudG9zUGVyc29uYWxlc0RpYShkYXRlSW5pY2lvRGlhOiAkZGF0ZUluaWNpb0RpYSwgaWRVc3VhcmlvOiAkaWRVc3VhcmlvKSB7CiAgICAgIC4uLmZyYWdFdmVudG9QZXJzb25hbAogICAgfQogIH0KICAke2ZyYWdtZW50b0V2ZW50b1BlcnNvbmFsfQpgOwoKY29uc3QgUVVFUllfRVZFTlRPU19DT0xJU0lPTkFOVEVTX0RJQSA9IGdxbGAKICBxdWVyeSAoJGRhdGVJbmljaW9EaWE6IERhdGUhLCAkaWRQYXJlbnQ6IElEISwgJHRpcG9QYXJlbnQ6IFN0cmluZyEpIHsKICAgIGV2ZW50b3NQZXJzb25hbGVzRGVQYXJlbnREaWEoCiAgICAgIGRhdGVJbmljaW9EaWE6ICRkYXRlSW5pY2lvRGlhCiAgICAgIGlkUGFyZW50OiAkaWRQYXJlbnQKICAgICAgdGlwb1BhcmVudDogJHRpcG9QYXJlbnQKICAgICkgewogICAgICAuLi5mcmFnRXZlbnRvUGVyc29uYWwKICAgIH0KICB9CiAgJHtmcmFnbWVudG9FdmVudG9QZXJzb25hbH0KYDsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IEV2ZW50b1B1YmxpY29DYWxlbmRhcmlvLCBFdmVudG9QZXJzb25hbENhbGVuZGFyaW8sIExvYWRpbmcgfSwKICBuYW1lOiAiRGlhQ2FsZW5kYXJpbyIsCiAgYXBvbGxvOiB7CiAgICBldmVudG9zUHVibGljb3NEaWE6IHsKICAgICAgcXVlcnk6IFFVRVJZX0VWRU5UT1NfUFVCTElDT1NfRElBLAogICAgICB2YXJpYWJsZXMoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGRhdGVJbmljaW9EaWE6IHRoaXMuZXN0ZURpYS5kYXRlLAogICAgICAgIH07CiAgICAgIH0sCiAgICAgIGZldGNoUG9saWN5OiAiY2FjaGUtYW5kLW5ldHdvcmsiLAogICAgfSwKICAgIGV2ZW50b3NQZXJzb25hbGVzRGlhOiB7CiAgICAgIHF1ZXJ5OiBRVUVSWV9FVkVOVE9TX1BFUlNPTkFMRVNfRElBLAogICAgICB2YXJpYWJsZXMoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGRhdGVJbmljaW9EaWE6IHRoaXMuZXN0ZURpYS5kYXRlLAogICAgICAgICAgaWRVc3VhcmlvOiB0aGlzLmlkVXN1YXJpb1RhcmdldCwKICAgICAgICB9OwogICAgICB9LAogICAgICBza2lwKCkgewogICAgICAgIHJldHVybiAhdGhpcy51c3VhcmlvTG9nZWFkbzsKICAgICAgfSwKICAgICAgZmV0Y2hQb2xpY3k6ICJjYWNoZS1hbmQtbmV0d29yayIsCiAgICB9LAogICAgZXZlbnRvc1BlcnNvbmFsZXNEZVBhcmVudERpYTogewogICAgICBxdWVyeTogUVVFUllfRVZFTlRPU19DT0xJU0lPTkFOVEVTX0RJQSwKICAgICAgdmFyaWFibGVzKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBkYXRlSW5pY2lvRGlhOiB0aGlzLmVzdGVEaWEuZGF0ZSwKICAgICAgICAgIGlkUGFyZW50OiB0aGlzLmlkUGFyZW50LAogICAgICAgICAgdGlwb1BhcmVudDogdGhpcy50aXBvUGFyZW50LAogICAgICAgIH07CiAgICAgIH0sCiAgICAgIHNraXAoKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIHRoaXMudGlwb1BhcmVudCAhPSAibm9kb1NvbGlkYXJpZGFkIiB8fAogICAgICAgICAgIXRoaXMudXN1YXJpb0xvZ2VhZG8gfHwKICAgICAgICAgICF0aGlzLmlkUGFyZW50CiAgICAgICAgKTsKICAgICAgfSwKICAgICAgZmV0Y2hQb2xpY3k6ICJjYWNoZS1hbmQtbmV0d29yayIsCiAgICB9LAogIH0sCiAgcHJvcHM6IHsKICAgIGhveTogQm9vbGVhbiwKICAgIGVzdGVEaWE6IE9iamVjdCwKICAgIGV2ZW50b1NpZW5kb0NyZWFkbzogT2JqZWN0LAogICAgaG9yYVB4OiBOdW1iZXIsCiAgICBzY3JvbGxYQ2FsZW5kYXJpbzogTnVtYmVyLAogICAgaWRQYXJlbnQ6IFN0cmluZywKICAgIGlkRXZlbnRvU2VsZWNjaW9uYWRvOiBTdHJpbmcsCiAgICBpZFVzdWFyaW9UYXJnZXQ6IFN0cmluZywKICAgIHRpcG9QYXJlbnQ6IFN0cmluZywKICAgIGVuZmFzaXM6IFN0cmluZywKICAgIG1vZG9FdmVudG9zUHVibGljb3NFeHRyYW5qZXJvczogU3RyaW5nLAogICAgdXN1YXJpb1ZlRXZlbnRvc1B1YmxpY29zOiBCb29sZWFuLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGV2ZW50b3NQdWJsaWNvc0RpYTogW10sCiAgICAgIGV2ZW50b3NQZXJzb25hbGVzRGlhOiBbXSwKICAgICAgZXZlbnRvc1BlcnNvbmFsZXNEZVBhcmVudERpYTogW10sCgogICAgICBhYmllcnRvOiBmYWxzZSwKCiAgICAgIGNyZWFuZG9FdmVudG86IGZhbHNlLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNsaWNrQ29udGVuZWRvckV2ZW50b3MoZSkgewogICAgICBjb25zb2xlLmxvZyhgQ2xpY2sgZW4gZWwgY29udGVuZWRvciBkZSBldmVudG9zYCk7CiAgICAgIGlmICh0aGlzLmV2ZW50b1NpZW5kb0NyZWFkbykgewogICAgICAgIGNvbnN0IG1hcmdlbiA9IDYwICogNjAwMDA7IC8vNjAgbWludXRvcwogICAgICAgIHZhciBpbmZvTnVldm9FdmVudG8gPSBKU09OLnBhcnNlKAogICAgICAgICAgSlNPTi5zdHJpbmdpZnkodGhpcy5ldmVudG9TaWVuZG9DcmVhZG8pCiAgICAgICAgKTsKICAgICAgICB0aGlzLiRlbWl0KCJpbmljaWFDcmVhY2lvbkV2ZW50byIpOwogICAgICAgIGNvbnN0IHBvc0NvbnRlbmVkb3JFdmVudG9zID0KICAgICAgICAgIHRoaXMuJHJlZnMuY29udGVuZWRvckV2ZW50b3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgY29uc3QgcG9zWCA9IGUucGFnZVggLSBwb3NDb250ZW5lZG9yRXZlbnRvcy5sZWZ0OwoKICAgICAgICBjb25zdCB0aW1lQ2xpY2tlZCA9IHBvc1ggLyB0aGlzLmhvcmFQeDsKICAgICAgICB2YXIgbWludXRvc0NsaWNrZWQgPSBNYXRoLnJvdW5kKAogICAgICAgICAgKHRpbWVDbGlja2VkIC0gTWF0aC5mbG9vcih0aW1lQ2xpY2tlZCkpICogNjAKICAgICAgICApOwogICAgICAgIG1pbnV0b3NDbGlja2VkID0gTWF0aC5mbG9vcihtaW51dG9zQ2xpY2tlZCAvIDE1KSAqIDE1OyAvLy9TZXQgZW4gbcO6bHRpcGxvcyBkZSAxNQoKICAgICAgICBjb25zdCB0aW1lQ2xpY2tlZEZvcm1hdHRlZCA9IHsKICAgICAgICAgIGhvcmFzOiBNYXRoLmZsb29yKHRpbWVDbGlja2VkKSwKICAgICAgICAgIG1pbnV0b3M6IG1pbnV0b3NDbGlja2VkLAogICAgICAgIH07CiAgICAgICAgY29uc3QgZGF0ZUNsaWNrZWQgPQogICAgICAgICAgdGhpcy5lc3RlRGlhLmRhdGUuZ2V0VGltZSgpICsKICAgICAgICAgIHRpbWVDbGlja2VkRm9ybWF0dGVkLmhvcmFzICogNjAgKiA2MDAwMCArCiAgICAgICAgICB0aW1lQ2xpY2tlZEZvcm1hdHRlZC5taW51dG9zICogNjAwMDA7CiAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICBgRW4gJHtwb3NYfSAtPiAke3RpbWVDbGlja2VkRm9ybWF0dGVkLmhvcmFzfTogJHt0aW1lQ2xpY2tlZEZvcm1hdHRlZC5taW51dG9zfWAKICAgICAgICApOwoKICAgICAgICBjb25zb2xlLmxvZygKICAgICAgICAgIGBEYXRlIGNlbnRyYWxoOiAkewogICAgICAgICAgICB0aGlzLmVzdGVEaWEuZGF0ZS5nZXRUaW1lKCkgKwogICAgICAgICAgICB0aW1lQ2xpY2tlZEZvcm1hdHRlZC5ob3JhcyArCiAgICAgICAgICAgIHRpbWVDbGlja2VkRm9ybWF0dGVkLm1pbnV0b3MgKiA2MDAwMAogICAgICAgICAgfWAKICAgICAgICApOwoKICAgICAgICB2YXIgZGF0ZUluaWNpbyA9IGRhdGVDbGlja2VkOwogICAgICAgIHZhciBkYXRlRmluYWwgPSBkYXRlQ2xpY2tlZCArIG1hcmdlbjsKCiAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICBgUXVlZGFyw6EgZW50cmU6ICR7bmV3IERhdGUoZGF0ZUluaWNpbyl9IHkgJHtuZXcgRGF0ZShkYXRlRmluYWwpfWAKICAgICAgICApOwoKICAgICAgICBpbmZvTnVldm9FdmVudG8uaG9yYXJpb0luaWNpbyA9IG5ldyBEYXRlKGRhdGVJbmljaW8pOwogICAgICAgIGluZm9OdWV2b0V2ZW50by5ob3JhcmlvRmluYWwgPSBuZXcgRGF0ZShkYXRlRmluYWwpOwogICAgICAgIGlmIChpbmZvTnVldm9FdmVudG8udGlwb0V2ZW50byA9PT0gImV2ZW50b1B1YmxpY28iKSB7CiAgICAgICAgICBkZWxldGUgaW5mb051ZXZvRXZlbnRvLnRpcG9FdmVudG87CiAgICAgICAgICB0aGlzLmNyZWFyRXZlbnRvUHVibGljbyhpbmZvTnVldm9FdmVudG8pOwogICAgICAgIH0gZWxzZSBpZiAoaW5mb051ZXZvRXZlbnRvLnRpcG9FdmVudG8gPT09ICJldmVudG9QZXJzb25hbCIpIHsKICAgICAgICAgIGRlbGV0ZSBpbmZvTnVldm9FdmVudG8udGlwb0V2ZW50bzsKICAgICAgICAgIHRoaXMuY3JlYXJFdmVudG9QZXJzb25hbChpbmZvTnVldm9FdmVudG8pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhgVGlwbyAke2luZm9OdWV2b0V2ZW50by50aXBvRXZlbnRvfSBubyByZWNvbm9jaWRvYCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaWRFdmVudG9TZWxlY2Npb25hZG8pIHsKICAgICAgICB0aGlzLiRlbWl0KCJkZXNTZWxlY2Npb25EZUV2ZW50byIpOwogICAgICB9CiAgICB9LAogICAgYWRkRXZlbnRvQ2FjaGUoZXZlbnRvKSB7CiAgICAgIGNvbnN0IG1pbGxpc0luaWNpb0V2ZW50byA9IG5ldyBEYXRlKGV2ZW50by5ob3JhcmlvSW5pY2lvKS5nZXRUaW1lKCk7CiAgICAgIGNvbnN0IG1pbGxpc0luaWNpb0RpYSA9IHRoaXMuZXN0ZURpYS5kYXRlLmdldFRpbWUoKTsKICAgICAgY29uc3QgbWlsbGlzRmluYWxEaWEgPSB0aGlzLmVzdGVEaWEuZGF0ZS5nZXRUaW1lKCkgKyA4NjQwMDAwMDsKCiAgICAgIGlmICgKICAgICAgICBtaWxsaXNJbmljaW9FdmVudG8gPCBtaWxsaXNJbmljaW9EaWEgfHwKICAgICAgICBtaWxsaXNJbmljaW9FdmVudG8gPiBtaWxsaXNGaW5hbERpYQogICAgICApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3QgdGlwb0V2ZW50byA9CiAgICAgICAgZXZlbnRvLl9fdHlwZW5hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyBldmVudG8uX190eXBlbmFtZS5zbGljZSgxKTsKICAgICAgdmFyIGluZm9RdWVyeSA9IG51bGw7CiAgICAgIGlmICh0aXBvRXZlbnRvID09PSAiZXZlbnRvUHVibGljbyIpIHsKICAgICAgICBpbmZvUXVlcnkgPSB7CiAgICAgICAgICBxdWVyeTogUVVFUllfRVZFTlRPU19QVUJMSUNPU19ESUEsCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgZGF0ZUluaWNpb0RpYTogdGhpcy5lc3RlRGlhLmRhdGUsCiAgICAgICAgICB9LAogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAodGlwb0V2ZW50byA9PT0gImV2ZW50b1BlcnNvbmFsIikgewogICAgICAgIGluZm9RdWVyeSA9IHsKICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9FVkVOVE9TX1BFUlNPTkFMRVNfRElBLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIGRhdGVJbmljaW9EaWE6IHRoaXMuZXN0ZURpYS5kYXRlLAogICAgICAgICAgICBpZFVzdWFyaW86IHRoaXMuaWRVc3VhcmlvVGFyZ2V0LAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKGBUaXBvIGV2ZW50byAke3RpcG9FdmVudG99IG5vIHJlY29ub2NpZG9gKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLiRhcG9sbG8ucHJvdmlkZXIuZGVmYXVsdENsaWVudDsKICAgICAgY29uc3QgY2FjaGUgPSBzdG9yZS5yZWFkUXVlcnkoewogICAgICAgIC4uLmluZm9RdWVyeSwKICAgICAgfSk7CiAgICAgIHZhciBudWV2b0NhY2hlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjYWNoZSkpOwogICAgICB2YXIgbGlzdGFFdmVudG9zQ2FjaGUgPSBudWxsOwogICAgICBpZiAodGlwb0V2ZW50byA9PT0gImV2ZW50b1B1YmxpY28iKSB7CiAgICAgICAgbGlzdGFFdmVudG9zQ2FjaGUgPSBudWV2b0NhY2hlLmV2ZW50b3NQdWJsaWNvc0RpYTsKICAgICAgfSBlbHNlIGlmICh0aXBvRXZlbnRvID09PSAiZXZlbnRvUGVyc29uYWwiKSB7CiAgICAgICAgbGlzdGFFdmVudG9zQ2FjaGUgPSBudWV2b0NhY2hlLmV2ZW50b3NQZXJzb25hbGVzRGlhOwogICAgICB9CiAgICAgIGNvbnN0IGluZGV4RSA9IGxpc3RhRXZlbnRvc0NhY2hlLmZpbmRJbmRleCgoZSkgPT4gZS5pZCA9PT0gZXZlbnRvLmlkKTsKICAgICAgaWYgKGluZGV4RSA9PT0gLTEpIHsKICAgICAgICBsaXN0YUV2ZW50b3NDYWNoZS5wdXNoKGV2ZW50byk7CgogICAgICAgIHN0b3JlLndyaXRlUXVlcnkoewogICAgICAgICAgLi4uaW5mb1F1ZXJ5LAogICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNyZWFyRXZlbnRvUHVibGljbyhpbmZvTnVldm9FdmVudG8pIHsKICAgICAgY29uc29sZS5sb2coCiAgICAgICAgYENyZWFuZG8gdW4gZXZlbnRvIHB1YmxpY28gY29uIGluZm8gJHtKU09OLnN0cmluZ2lmeShpbmZvTnVldm9FdmVudG8pfWAKICAgICAgKTsKCiAgICAgIHRoaXMuY3JlYW5kb0V2ZW50byA9IHRydWU7CiAgICAgIHRoaXMuJGFwb2xsbwogICAgICAgIC5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGdxbGAKICAgICAgICAgICAgbXV0YXRpb24gKCRpbmZvTnVldm9FdmVudG86IElucHV0Q3JlYXJFdmVudG9QdWJsaWNvKSB7CiAgICAgICAgICAgICAgY3JlYXJFdmVudG9QdWJsaWNvKGluZm9OdWV2b0V2ZW50bzogJGluZm9OdWV2b0V2ZW50bykgewogICAgICAgICAgICAgICAgLi4uZnJhZ0V2ZW50b1B1YmxpY28KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHtmcmFnbWVudG9FdmVudG9QdWJsaWNvfQogICAgICAgICAgYCwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBpbmZvTnVldm9FdmVudG8sCiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHsgZGF0YTogeyBjcmVhckV2ZW50b1B1YmxpY28gfSB9KSA9PiB7CiAgICAgICAgICB0aGlzLmNyZWFuZG9FdmVudG8gPSBmYWxzZTsKCiAgICAgICAgICB0aGlzLmFkZEV2ZW50b0NhY2hlKGNyZWFyRXZlbnRvUHVibGljbyk7CiAgICAgICAgICAgdGhpcy4kZW1pdCgiY2FtYmlvRXZlbnRvcyIpOwoKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJvcn1gKTsKICAgICAgICAgIHRoaXMuY3JlYW5kb0V2ZW50byA9IGZhbHNlOwogICAgICAgIH0pOwogICAgfSwKICAgIGNyZWFyRXZlbnRvUGVyc29uYWwoaW5mb051ZXZvRXZlbnRvKSB7CiAgICAgIGNvbnNvbGUubG9nKAogICAgICAgIGBDcmVhbmRvIHVuIGV2ZW50byBwZXJzb25hbCBjb24gaW5mbyAke0pTT04uc3RyaW5naWZ5KGluZm9OdWV2b0V2ZW50byl9YAogICAgICApOwogICAgICB0aGlzLmNyZWFuZG9FdmVudG8gPSB0cnVlOwogICAgICB0aGlzLiRhcG9sbG8KICAgICAgICAubXV0YXRlKHsKICAgICAgICAgIG11dGF0aW9uOiBncWxgCiAgICAgICAgICAgIG11dGF0aW9uICgkaW5mb0V2ZW50b1BlcnNvbmFsOiBJbnB1dENyZWFyRXZlbnRvUGVyc29uYWwpIHsKICAgICAgICAgICAgICBjcmVhckV2ZW50b1BlcnNvbmFsKGluZm9FdmVudG9QZXJzb25hbDogJGluZm9FdmVudG9QZXJzb25hbCkgewogICAgICAgICAgICAgICAgLi4uZnJhZ0V2ZW50b1BlcnNvbmFsCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICR7ZnJhZ21lbnRvRXZlbnRvUGVyc29uYWx9CiAgICAgICAgICBgLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIGluZm9FdmVudG9QZXJzb25hbDogewogICAgICAgICAgICAgIC4uLmluZm9OdWV2b0V2ZW50bywKICAgICAgICAgICAgICBpZFBlcnNvbmE6IHRoaXMuaWRVc3VhcmlvVGFyZ2V0LAogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICB9KQogICAgICAgIC50aGVuKCh7IGRhdGE6IHsgY3JlYXJFdmVudG9QZXJzb25hbCB9IH0pID0+IHsKICAgICAgICAgIHRoaXMuY3JlYW5kb0V2ZW50byA9IGZhbHNlOwogICAgICAgICAgdGhpcy5hZGRFdmVudG9DYWNoZShjcmVhckV2ZW50b1BlcnNvbmFsKTsKICAgICAgICAgICB0aGlzLiRlbWl0KCJjYW1iaW9FdmVudG9zIik7CgogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApOwogICAgICAgICAgdGhpcy5jcmVhbmRvRXZlbnRvID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICB9LAogICAgZGVsZXRlRXZlbnRvQ2FjaGUoZXZlbnRvKSB7CiAgICAgIGNvbnN0IHRpcG9FdmVudG8gPQogICAgICAgIGV2ZW50by5fX3R5cGVuYW1lLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgZXZlbnRvLl9fdHlwZW5hbWUuc2xpY2UoMSk7CgogICAgICBjb25zb2xlLmxvZyhgRGVsZXRpbmcgJHt0aXBvRXZlbnRvfSAke2V2ZW50by5ub21icmV9IGZyb20gY2FjaGVgKTsKCiAgICAgIHZhciBpbmZvUXVlcnkgPSBudWxsOwogICAgICBpZiAodGlwb0V2ZW50byA9PT0gImV2ZW50b1B1YmxpY28iKSB7CiAgICAgICAgaW5mb1F1ZXJ5ID0gewogICAgICAgICAgcXVlcnk6IFFVRVJZX0VWRU5UT1NfUFVCTElDT1NfRElBLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIGRhdGVJbmljaW9EaWE6IHRoaXMuZXN0ZURpYS5kYXRlLAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QZXJzb25hbCIpIHsKICAgICAgICBpbmZvUXVlcnkgPSB7CiAgICAgICAgICBxdWVyeTogUVVFUllfRVZFTlRPU19QRVJTT05BTEVTX0RJQSwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBkYXRlSW5pY2lvRGlhOiB0aGlzLmVzdGVEaWEuZGF0ZSwKICAgICAgICAgICAgaWRVc3VhcmlvOiB0aGlzLmlkVXN1YXJpb1RhcmdldCwKICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyhgVGlwbyBldmVudG8gJHt0aXBvRXZlbnRvfSBubyByZWNvbm9jaWRvYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlID0gc3RvcmUucmVhZFF1ZXJ5KHsKICAgICAgICAuLi5pbmZvUXVlcnksCiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKICAgICAgdmFyIGxpc3RhRXZlbnRvc0NhY2hlID0gbnVsbDsKICAgICAgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QdWJsaWNvIikgewogICAgICAgIGxpc3RhRXZlbnRvc0NhY2hlID0gbnVldm9DYWNoZS5ldmVudG9zUHVibGljb3NEaWE7CiAgICAgIH0gZWxzZSBpZiAodGlwb0V2ZW50byA9PT0gImV2ZW50b1BlcnNvbmFsIikgewogICAgICAgIGxpc3RhRXZlbnRvc0NhY2hlID0gbnVldm9DYWNoZS5ldmVudG9zUGVyc29uYWxlc0RpYTsKICAgICAgfQogICAgICBjb25zdCBpbmRleEUgPSBsaXN0YUV2ZW50b3NDYWNoZS5maW5kSW5kZXgoKGUpID0+IGUuaWQgPT09IGV2ZW50by5pZCk7CiAgICAgIGlmIChpbmRleEUgPiAtMSkgewogICAgICAgIGxpc3RhRXZlbnRvc0NhY2hlLnNwbGljZShpbmRleEUsIDEpOwogICAgICAgIHN0b3JlLndyaXRlUXVlcnkoewogICAgICAgICAgLi4uaW5mb1F1ZXJ5LAogICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBkaWFTZW1hbmEoKSB7CiAgICAgIGNvbnN0IG5vbWJyZXMgPSBbCiAgICAgICAgIkRvbWluZ28iLAogICAgICAgICJMdW5lcyIsCiAgICAgICAgIk1hcnRlcyIsCiAgICAgICAgIk1pw6lyY29sZXMiLAogICAgICAgICJKdWV2ZXMiLAogICAgICAgICJWaWVybmVzIiwKICAgICAgICAiU8OhYmFkbyIsCiAgICAgICAgIkRvbWluZ28iLAogICAgICBdOwogICAgICByZXR1cm4gbm9tYnJlc1t0aGlzLmVzdGVEaWEuZGF0ZS5nZXREYXkoKV07CiAgICB9LAogICAgZGlhWU1lcygpIHsKICAgICAgY29uc3QgbWVzZXMgPSBbCiAgICAgICAgIkVuZXJvIiwKICAgICAgICAiRmVicmVybyIsCiAgICAgICAgIk1hcnpvIiwKICAgICAgICAiQWJyaWwiLAogICAgICAgICJNYXlvIiwKICAgICAgICAiSnVuaW8iLAogICAgICAgICJKdWxpbyIsCiAgICAgICAgIkFnb3N0byIsCiAgICAgICAgIlNlcHRpZW1icmUiLAogICAgICAgICJPY3R1YnJlIiwKICAgICAgICAiTm92aWVtYnJlIiwKICAgICAgICAiRGljaWVtYnJlIiwKICAgICAgXTsKCiAgICAgIHJldHVybiAoCiAgICAgICAgdGhpcy5lc3RlRGlhLmRhdGUuZ2V0RGF0ZSgpICsKICAgICAgICAiIGRlICIgKwogICAgICAgIG1lc2VzW3RoaXMuZXN0ZURpYS5kYXRlLmdldE1vbnRoKCldCiAgICAgICk7CiAgICB9LAogICAgZXZlbnRvc1B1YmxpY29zVmlzaWJsZXMoKSB7CiAgICAgIGlmICh0aGlzLmVuZmFzaXMgPT09ICJldmVudG9zUHVibGljb3MiKSB7CiAgICAgICAgaWYgKHRoaXMubW9kb0V2ZW50b3NQdWJsaWNvc0V4dHJhbmplcm9zID09PSAiaW52aXNpYmxlcyIpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmV2ZW50b3NQdWJsaWNvc0RpYS5maWx0ZXIoCiAgICAgICAgICAgIChlKSA9PgogICAgICAgICAgICAgIGUuaWRQYXJlbnQgPT09IHRoaXMuaWRQYXJlbnQgfHwKICAgICAgICAgICAgICBlLmlkQWRtaW5pc3RyYWRvciA9PT0gdGhpcy5pZFVzdWFyaW9UYXJnZXQKICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0aGlzLmV2ZW50b3NQdWJsaWNvc0RpYTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lbmZhc2lzID09PSAiZXZlbnRvc1BlcnNvbmFsZXMiKSB7CiAgICAgICAgaWYgKHRoaXMudXN1YXJpb1ZlRXZlbnRvc1B1YmxpY29zKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5ldmVudG9zUHVibGljb3NEaWE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIHJldHVybiB0aGlzLmV2ZW50b3NQdWJsaWNvc0RpYS5maWx0ZXIoKGV2KSA9PgogICAgICAgICAgLy8gICB0aGlzLmV2ZW50b3NQZXJzb25hbGVzRGlhLnNvbWUoKGVwKSA9PiBlcC5pZEV2ZW50b01hcmNvID09PSBldi5pZCkKICAgICAgICAgIC8vICk7CiAgICAgICAgICByZXR1cm4gdGhpcy5ldmVudG9zUHVibGljb3NEaWEuZmlsdGVyKAogICAgICAgICAgICAoZXApID0+IGVwLmlkQWRtaW5pc3RyYWRvciA9PT0gdGhpcy5pZFVzdWFyaW9UYXJnZXQKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQogICAgfSwKICAgIGV2ZW50b3NQdWJsaWNvc1VzdWFyaW9UYXJnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmV2ZW50b3NQdWJsaWNvc0RpYS5maWx0ZXIoCiAgICAgICAgKGV2KSA9PiBldi5pZEFkbWluaXN0cmFkb3IgPT09IHRoaXMuaWRVc3VhcmlvVGFyZ2V0CiAgICAgICk7CiAgICB9LAogICAgZXN0aWxvU2l6ZUNvbnRlbmVkb3JFdmVudG9zKCkgewogICAgICBjb25zdCBhbHR1cmFFdmVudG9zID0gT2JqZWN0LnZhbHVlcyh0aGlzLmluZGljZU9mZnNldCkucmVkdWNlKAogICAgICAgIChhY2MsIGEpID0+IChhLnRvcCArIGEuaGVpZ2h0ID4gYWNjID8gYS50b3AgKyBhLmhlaWdodCA6IGFjYyksCiAgICAgICAgMAogICAgICApOwoKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogdGhpcy5ob3JhUHggKiAyNCArICJweCIsCiAgICAgICAgaGVpZ2h0OiBhbHR1cmFFdmVudG9zICsgNDUgKyAicHgiLAogICAgICB9OwogICAgfSwKICAgIGNhbnRpZGFkRXZlbnRvc1B1YmxpY29zKCkgewogICAgICByZXR1cm4gdGhpcy5ldmVudG9zUHVibGljb3NEaWEubGVuZ3RoOwogICAgfSwKICAgIGNhbnRpZGFkRXZlbnRvc1JlbGV2YW50ZXMoKSB7CiAgICAgIGlmICh0aGlzLmVuZmFzaXMgPT09ICJldmVudG9zUHVibGljb3MiKSB7CiAgICAgICAgaWYgKCF0aGlzLmlkUGFyZW50KSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5jYW50aWRhZEV2ZW50b3NQdWJsaWNvczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRvc1B1YmxpY29zRGlhLmZpbHRlcigKICAgICAgICAgICAgKHApID0+IHAuaWRQYXJlbnQgPT09IHRoaXMuaWRQYXJlbnQKICAgICAgICAgICkubGVuZ3RoOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmVuZmFzaXMgPT09ICJldmVudG9zUGVyc29uYWxlcyIpIHsKICAgICAgICBpZiAodGhpcy5pZFBhcmVudCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRvc1BlcnNvbmFsZXNEaWEuZmlsdGVyKAogICAgICAgICAgICAoZXYpID0+IGV2LmlkUGFyZW50ID09PSB0aGlzLmlkUGFyZW50CiAgICAgICAgICApLmxlbmd0aDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIHRoaXMuZXZlbnRvc1BlcnNvbmFsZXNEaWEubGVuZ3RoICsKICAgICAgICAgIHRoaXMuZXZlbnRvc1B1YmxpY29zVXN1YXJpb1RhcmdldC5sZW5ndGgKICAgICAgICApOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAwOwogICAgICB9CiAgICB9LAogICAgaW5kaWNlT2Zmc2V0KCkgewogICAgICBjb25zdCBzaXplQmFycmEgPSAxNTsKICAgICAgY29uc3Qgc2l6ZUJsb3F1ZSA9IDEwMDsKICAgICAgY29uc3QgbWFyZ2luUm93cyA9IDU7CiAgICAgIGNvbnN0IGxpbmVhRXZlbnRvc1B1YmxpY29zQXNpc3RpZG9zID0gMzA7CiAgICAgIC8vIGNvbnNvbGUubG9nKAogICAgICAvLyAgIGAlYyBJbmljaWFuZG8gY2FsY3VsbyBkZSBpbmRpY2UgZGUgb2Zmc2V0YCwKICAgICAgLy8gICAiYmFja2dyb3VuZDogIzIyMjsgY29sb3I6ICNiYWRhNTUiCiAgICAgIC8vICk7CiAgICAgIHZhciBpbmRpY2UgPSB7fTsKCiAgICAgIGlmICghdGhpcy51c3VhcmlvTG9nZWFkbykgewogICAgICAgIGNvbnNvbGUubG9nKGBDYW5jZWxhbmRvIMOtbmRpY2Ugb2Zmc2V0YCk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHRoaXMudG9kb3NFdmVudG9zUGVyc29uYWxlc0RpYS5mb3JFYWNoKChldikgPT4gewogICAgICAgIGxldCBoZWlnaHRFdmVudG8gPSBzaXplQmxvcXVlOwogICAgICAgIGxldCBjbGFzZUV2ZW50byA9ICJibG9xdWUiOwogICAgICAgIGxldCB0b3AgPSBtYXJnaW5Sb3dzOwoKICAgICAgICBpZiAodGhpcy5lbmZhc2lzID09PSAiZXZlbnRvc1BlcnNvbmFsZXMiKSB7CiAgICAgICAgICBpZiAodGhpcy5pZFBhcmVudCkgewogICAgICAgICAgICBpZiAoZXYuaWRQYXJlbnQgIT0gdGhpcy5pZFBhcmVudCkgewogICAgICAgICAgICAgIGhlaWdodEV2ZW50byA9IHNpemVCYXJyYTsKICAgICAgICAgICAgICBjbGFzZUV2ZW50byA9ICJiYXJyYSI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaGVpZ2h0RXZlbnRvID0gc2l6ZUJhcnJhOwogICAgICAgICAgY2xhc2VFdmVudG8gPSAiYmFycmEiOwogICAgICAgIH0KCiAgICAgICAgaW5kaWNlW2V2LmlkXSA9IHsKICAgICAgICAgIGV2ZW50bzogZXYsCiAgICAgICAgICB0b3AsCiAgICAgICAgICBoZWlnaHQ6IGhlaWdodEV2ZW50bywKICAgICAgICAgIGJvcmRlQm90OiB0b3AgKyBoZWlnaHRFdmVudG8sCiAgICAgICAgICBjbGFzZTogY2xhc2VFdmVudG8sCiAgICAgICAgfTsKICAgICAgfSk7CgogICAgICB2YXIgbGlzdGFFdmVudG9zUHVibGljb3MgPSBKU09OLnBhcnNlKAogICAgICAgIEpTT04uc3RyaW5naWZ5KHRoaXMuZXZlbnRvc1B1YmxpY29zVmlzaWJsZXMpCiAgICAgICk7CiAgICAgIGxpc3RhRXZlbnRvc1B1YmxpY29zLnNvcnQoKGEsIGIpID0+IHsKICAgICAgICB2YXIgcmVzID0gMDsKICAgICAgICBpZiAoYS5pZEFkbWluaXN0cmFkb3IgPT09IHRoaXMuaWRVc3VhcmlvVGFyZ2V0KSB7CiAgICAgICAgICByZXMrKzsKICAgICAgICB9IGVsc2UgaWYgKAogICAgICAgICAgdGhpcy5ldmVudG9zUGVyc29uYWxlc0RpYS5zb21lKChlKSA9PiBlLmlkRXZlbnRvTWFyY28gPT09IGEuaWQpCiAgICAgICAgKSB7CiAgICAgICAgICByZXMrKzsKICAgICAgICB9CiAgICAgICAgaWYgKGIuaWRBZG1pbmlzdHJhZG9yID09PSB0aGlzLmlkVXN1YXJpb1RhcmdldCkgewogICAgICAgICAgcmVzLS07CiAgICAgICAgfSBlbHNlIGlmICgKICAgICAgICAgIHRoaXMuZXZlbnRvc1BlcnNvbmFsZXNEaWEuc29tZSgoZSkgPT4gZS5pZEV2ZW50b01hcmNvID09PSBiLmlkKQogICAgICAgICkgewogICAgICAgICAgcmVzLS07CiAgICAgICAgfQogICAgICAgIHJldHVybiAtcmVzOwogICAgICB9KTsKICAgICAgLy8gY29uc29sZS5sb2coCiAgICAgIC8vICAgYEV2ZW50b3Mgc29ydGVkOiAke2xpc3RhRXZlbnRvc1B1YmxpY29zLm1hcCgoZSkgPT4gZS5ub21icmUpfWAKICAgICAgLy8gKTsKCiAgICAgIGxpc3RhRXZlbnRvc1B1YmxpY29zLmZvckVhY2goKGV2KSA9PiB7CiAgICAgICAgLy8gY29uc29sZS5sb2coYEl0ZXJhbmRvIGVuICR7ZXYubm9tYnJlfWApOwogICAgICAgIGxldCBldmVudG9Bc2lzdGVVc3VhcmlvVGFyZ2V0ID0gdGhpcy5ldmVudG9zUGVyc29uYWxlc0RpYS5zb21lKAogICAgICAgICAgKGVwKSA9PiBlcC5pZEV2ZW50b01hcmNvID09PSBldi5pZAogICAgICAgICk7CiAgICAgICAgbGV0IGhlaWdodEV2ZW50byA9IHNpemVCbG9xdWU7CiAgICAgICAgbGV0IGNsYXNlRXZlbnRvID0gImJsb3F1ZSI7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5lbmZhc2lzID09PSAiZXZlbnRvc1B1YmxpY29zIiAmJgogICAgICAgICAgZXYuaWRQYXJlbnQgIT0gdGhpcy5pZFBhcmVudCAmJgogICAgICAgICAgdGhpcy5tb2RvRXZlbnRvc1B1YmxpY29zRXh0cmFuamVyb3MgIT0gImZ1bGwiCiAgICAgICAgKSB7CiAgICAgICAgICBoZWlnaHRFdmVudG8gPSBzaXplQmFycmE7CiAgICAgICAgICBjbGFzZUV2ZW50byA9ICJiYXJyYSI7CiAgICAgICAgfQogICAgICAgIC8vIGNvbnNvbGUubG9nKAogICAgICAgIC8vICAgYGNhbnRpZGFkIGRlIGVudHJpZXMgZW4gZWwgaW5kaWNlICR7CiAgICAgICAgLy8gICAgIE9iamVjdC5lbnRyaWVzKGluZGljZSkubWFwKChlKSA9PiBlWzFdKS5sZW5ndGgKICAgICAgICAvLyAgIH1gCiAgICAgICAgLy8gKTsKCiAgICAgICAgbGV0IHRvcCA9IDA7CiAgICAgICAgaWYgKHRoaXMuZW5mYXNpcyA9PT0gImV2ZW50b3NQZXJzb25hbGVzIiAmJiBldmVudG9Bc2lzdGVVc3VhcmlvVGFyZ2V0KSB7CiAgICAgICAgICB0b3AgPSBsaW5lYUV2ZW50b3NQdWJsaWNvc0FzaXN0aWRvczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGV0IGV2ZW50b3NDb2xpc2lvbiA9IE9iamVjdC5lbnRyaWVzKGluZGljZSkKICAgICAgICAgICAgLm1hcCgoZSkgPT4gZVsxXSkKICAgICAgICAgICAgLmZpbHRlcigodCkgPT4gewogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBDb21wYXJhbmRvIGNvbiAke3QuZXZlbnRvLm5vbWJyZX1gKTsKICAgICAgICAgICAgICBjb25zdCBpbmljaW9EZW50cm8gPQogICAgICAgICAgICAgICAgdC5ldmVudG8uaG9yYXJpb0luaWNpbyA+IGV2LmhvcmFyaW9JbmljaW8gJiYKICAgICAgICAgICAgICAgIHQuZXZlbnRvLmhvcmFyaW9JbmljaW8gPCBldi5ob3JhcmlvRmluYWw7CiAgICAgICAgICAgICAgY29uc3QgZmluYWxEZW50cm8gPQogICAgICAgICAgICAgICAgdC5ldmVudG8uaG9yYXJpb0ZpbmFsID4gZXYuaG9yYXJpb0luaWNpbyAmJgogICAgICAgICAgICAgICAgdC5ldmVudG8uaG9yYXJpb0ZpbmFsIDwgZXYuaG9yYXJpb0ZpbmFsOwoKICAgICAgICAgICAgICBjb25zdCBzb2JyZXBvbmUgPQogICAgICAgICAgICAgICAgdC5ldmVudG8uaG9yYXJpb0luaWNpbyA8PSBldi5ob3JhcmlvSW5pY2lvICYmCiAgICAgICAgICAgICAgICB0LmV2ZW50by5ob3JhcmlvRmluYWwgPj0gZXYuaG9yYXJpb0ZpbmFsOwoKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgSW5pY2lvIGRlbnRybzogJHtpbmljaW9EZW50cm99YCk7CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEZpbmFsIGRlbnRybzogJHtmaW5hbERlbnRyb31gKTsKCiAgICAgICAgICAgICAgY29uc3QgY29saXNpb24gPSBpbmljaW9EZW50cm8gfHwgZmluYWxEZW50cm8gfHwgc29icmVwb25lOwogICAgICAgICAgICAgIC8vIGlmIChjb2xpc2lvbikgewogICAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2coYGNvbGlzaW9uYCk7CiAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgIHJldHVybiBjb2xpc2lvbjsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgLy8gY29uc29sZS5sb2coYCR7ZXZlbnRvc0NvbGlzaW9uLmxlbmd0aH0gZXZlbnRvcyBlbiBjb2xpc2nDs25gKTsKCiAgICAgICAgICBsZXQgYm9yZGVCb3RDb2xpc2lvbiA9IGV2ZW50b3NDb2xpc2lvbi5yZWR1Y2UoCiAgICAgICAgICAgIChhY2MsIGUpID0+IChlLmJvcmRlQm90ID4gYWNjID8gZS5ib3JkZUJvdCA6IGFjYyksCiAgICAgICAgICAgIDAKICAgICAgICAgICk7CgogICAgICAgICAgdG9wID0gYm9yZGVCb3RDb2xpc2lvbiArIG1hcmdpblJvd3M7CiAgICAgICAgfQoKICAgICAgICAvLyBjb25zb2xlLmxvZyhgUXVlZGEgZW4gJHt0b3B9ICsgJHtoZWlnaHRFdmVudG99YCk7CiAgICAgICAgaW5kaWNlW2V2LmlkXSA9IHsKICAgICAgICAgIGV2ZW50bzogZXYsCiAgICAgICAgICB0b3A6IHRvcCwKICAgICAgICAgIGhlaWdodDogaGVpZ2h0RXZlbnRvLAogICAgICAgICAgYm9yZGVCb3Q6IHRvcCArIGhlaWdodEV2ZW50byArIHNpemVCYXJyYSwKICAgICAgICAgIGNsYXNlOiBjbGFzZUV2ZW50bywKICAgICAgICB9OwogICAgICB9KTsKICAgICAgcmV0dXJuIGluZGljZTsKICAgIH0sCiAgICB0b2Rvc0V2ZW50b3NQZXJzb25hbGVzRGlhKCkgewogICAgICByZXR1cm4gdGhpcy5ldmVudG9zUGVyc29uYWxlc0RpYS5jb25jYXQoCiAgICAgICAgdGhpcy5ldmVudG9zUGVyc29uYWxlc0RlUGFyZW50RGlhLmZpbHRlcigKICAgICAgICAgIChlcHApID0+CiAgICAgICAgICAgICF0aGlzLmV2ZW50b3NQZXJzb25hbGVzRGlhLm1hcCgoZXApID0+IGVwLmlkKS5pbmNsdWRlcyhlcHAuaWQpCiAgICAgICAgKQogICAgICApOwogICAgfSwKICAgIGVzdGlsb1NpemVIb3JhKCkgewogICAgICByZXR1cm4gewogICAgICAgIHdpZHRoOiB0aGlzLmhvcmFQeCArICJweCIsCiAgICAgIH07CiAgICB9LAogICAgZG93bmxvYWRpbmdEYXRhKCkgewogICAgICByZXR1cm4gKAogICAgICAgICh0aGlzLiRhcG9sbG8ucXVlcmllcy5ldmVudG9zUGVyc29uYWxlc0RlUGFyZW50RGlhICYmCiAgICAgICAgICB0aGlzLiRhcG9sbG8ucXVlcmllcy5ldmVudG9zUGVyc29uYWxlc0RlUGFyZW50RGlhLmxvYWRpbmcpIHx8CiAgICAgICAgKHRoaXMuJGFwb2xsby5xdWVyaWVzLmV2ZW50b3NQdWJsaWNvc0RpYSAmJgogICAgICAgICAgdGhpcy4kYXBvbGxvLnF1ZXJpZXMuZXZlbnRvc1B1YmxpY29zRGlhLmxvYWRpbmcpIHx8CiAgICAgICAgKHRoaXMuJGFwb2xsby5xdWVyaWVzLmV2ZW50b3NQZXJzb25hbGVzRGlhICYmCiAgICAgICAgICB0aGlzLiRhcG9sbG8ucXVlcmllcy5ldmVudG9zUGVyc29uYWxlc0RpYS5sb2FkaW5nKQogICAgICApOwogICAgfSwKICB9LAogIHdhdGNoOiB7fSwKICBtb3VudGVkKCkgewogICAgY29uc3QgaG9yYUFjdHVhbCA9IG5ldyBEYXRlKCkuZ2V0SG91cnMoKTsKICAgIGNvbnNvbGUubG9nKGBTY3JvbGxpbmcgaW50byAke2hvcmFBY3R1YWx9YCk7CiAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgIHRoaXMuJHJlZnMubGFiZWxzSG9yYXNbOF0uc2Nyb2xsSW50b1ZpZXcoewogICAgICAgIGJsb2NrOiAibmVhcmVzdCIsCiAgICAgICAgaW5saW5lOiAic3RhcnQiLAogICAgICB9KTsKICAgIH0pOwogIH0sCn07Cg=="},{"version":3,"sources":["DiaCalendario.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DiaCalendario.vue","sourceRoot":"src/components/utilidades","sourcesContent":["<template>\n  <div class=\"diaCalendario\" :class=\"{ abierto }\">\n    <div id=\"barraSuperior\">\n      <div id=\"bloqueTituloDia\" @click=\"$emit('regresar')\">\n        <div id=\"nombreDia\" :class=\"{ hoy }\">\n          {{ diaSemana }}\n        </div>\n        <div id=\"fechaDia\">\n          {{ diaYMes }}\n        </div>\n        <div id=\"cantidadesEventos\">\n          {{\n            cantidadEventosRelevantes\n              ? \"(\" + cantidadEventosRelevantes + \")\"\n              : \"\"\n          }}\n        </div>\n      </div>\n    </div>\n\n    <loading texto=\"\" v-show=\"downloadingData\" />\n    <div id=\"contenedorContenido\">\n      <div id=\"barraHoras\">\n        <div\n          ref=\"labelsHoras\"\n          class=\"hora\"\n          :style=\"[estiloSizeHora]\"\n          v-for=\"hora of 24\"\n          :key=\"'hora' + (hora - 1)\"\n        >\n          {{ hora - 1 }}:00\n        </div>\n      </div>\n      <div\n        id=\"contenedorEventos\"\n        ref=\"contenedorEventos\"\n        v-show=\"!downloadingData\"\n        :style=\"[estiloSizeContenedorEventos]\"\n        @click.self=\"clickContenedorEventos\"\n      >\n        <evento-publico-calendario\n          :horaPx=\"horaPx\"\n          v-for=\"eventoPublico of eventosPublicosVisibles\"\n          :key=\"eventoPublico.id\"\n          :esteEvento=\"eventoPublico\"\n          :extranjero=\"(!idParent || idParent != eventoPublico.idParent)\"\n          :idUsuarioTarget=\"idUsuarioTarget\"\n          :seleccionado=\"idEventoSeleccionado === eventoPublico.id\"\n          :infoOffset=\"indiceOffset[eventoPublico.id]\"\n          :diaCalendarioOver=\"esteDia\"\n          :enfasis=\"enfasis\"\n          :idParent=\"idParent\"\n          :tipoParent=\"tipoParent\"\n          @meElimine=\"deleteEventoCache(eventoPublico); $emit('cambioEventos')\"\n          @click.native=\"$emit('clickEnEvento', eventoPublico)\"\n          @meCambiaronDia=\"deleteEventoCache(eventoPublico);$emit('cambioEventos')\"\n          @creadoEventoPersonal=\"addEventoCache($event);$emit('cambioEventos');\"\n        />\n        <evento-personal-calendario\n          :horaPx=\"horaPx\"\n          v-for=\"eventoPersonal of todosEventosPersonalesDia || []\"\n          :key=\"eventoPersonal.id\"\n          :esteEvento=\"eventoPersonal\"\n          :seleccionado=\"idEventoSeleccionado === eventoPersonal.id\"\n          :infoOffset=\"indiceOffset[eventoPersonal.id]\"\n          :diaCalendarioOver=\"esteDia\"\n          :enfasis=\"enfasis\"\n          :extranjero=\"\n            idUsuarioTarget != eventoPersonal.idPersona &&\n            !eventoPersonal.idsParticipantes.includes(idUsuarioTarget)\n          \"          \n          @meElimine=\"deleteEventoCache(eventoPersonal);$emit('cambioEventos')\"\n          @click.native=\"$emit('clickEnEvento', eventoPersonal)\"\n          @meCambiaronDia=\"\n            deleteEventoCache(eventoPersonal);$emit('cambioEventos');            \n          \"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport {\n  fragmentoEventoPersonal,\n  fragmentoEventoPublico,\n} from \"./fragsCalendario.js\";\nimport EventoPublicoCalendario from \"./EventoPublicoCalendario.vue\";\nimport EventoPersonalCalendario from \"./EventoPersonalCalendario.vue\";\nimport Loading from \"./Loading.vue\";\n\nconst QUERY_EVENTOS_PUBLICOS_DIA = gql`\n  query ($dateInicioDia: Date!) {\n    eventosPublicosDia(dateInicioDia: $dateInicioDia) {\n      ...fragEventoPublico\n    }\n  }\n  ${fragmentoEventoPublico}\n`;\n\nconst QUERY_EVENTOS_PERSONALES_DIA = gql`\n  query ($dateInicioDia: Date!, $idUsuario: ID!) {\n    eventosPersonalesDia(dateInicioDia: $dateInicioDia, idUsuario: $idUsuario) {\n      ...fragEventoPersonal\n    }\n  }\n  ${fragmentoEventoPersonal}\n`;\n\nconst QUERY_EVENTOS_COLISIONANTES_DIA = gql`\n  query ($dateInicioDia: Date!, $idParent: ID!, $tipoParent: String!) {\n    eventosPersonalesDeParentDia(\n      dateInicioDia: $dateInicioDia\n      idParent: $idParent\n      tipoParent: $tipoParent\n    ) {\n      ...fragEventoPersonal\n    }\n  }\n  ${fragmentoEventoPersonal}\n`;\n\nexport default {\n  components: { EventoPublicoCalendario, EventoPersonalCalendario, Loading },\n  name: \"DiaCalendario\",\n  apollo: {\n    eventosPublicosDia: {\n      query: QUERY_EVENTOS_PUBLICOS_DIA,\n      variables() {\n        return {\n          dateInicioDia: this.esteDia.date,\n        };\n      },\n      fetchPolicy: \"cache-and-network\",\n    },\n    eventosPersonalesDia: {\n      query: QUERY_EVENTOS_PERSONALES_DIA,\n      variables() {\n        return {\n          dateInicioDia: this.esteDia.date,\n          idUsuario: this.idUsuarioTarget,\n        };\n      },\n      skip() {\n        return !this.usuarioLogeado;\n      },\n      fetchPolicy: \"cache-and-network\",\n    },\n    eventosPersonalesDeParentDia: {\n      query: QUERY_EVENTOS_COLISIONANTES_DIA,\n      variables() {\n        return {\n          dateInicioDia: this.esteDia.date,\n          idParent: this.idParent,\n          tipoParent: this.tipoParent,\n        };\n      },\n      skip() {\n        return (\n          this.tipoParent != \"nodoSolidaridad\" ||\n          !this.usuarioLogeado ||\n          !this.idParent\n        );\n      },\n      fetchPolicy: \"cache-and-network\",\n    },\n  },\n  props: {\n    hoy: Boolean,\n    esteDia: Object,\n    eventoSiendoCreado: Object,\n    horaPx: Number,\n    scrollXCalendario: Number,\n    idParent: String,\n    idEventoSeleccionado: String,\n    idUsuarioTarget: String,\n    tipoParent: String,\n    enfasis: String,\n    modoEventosPublicosExtranjeros: String,\n    usuarioVeEventosPublicos: Boolean,\n  },\n  data() {\n    return {\n      eventosPublicosDia: [],\n      eventosPersonalesDia: [],\n      eventosPersonalesDeParentDia: [],\n\n      abierto: false,\n\n      creandoEvento: false,\n    };\n  },\n  methods: {\n    clickContenedorEventos(e) {\n      console.log(`Click en el contenedor de eventos`);\n      if (this.eventoSiendoCreado) {\n        const margen = 60 * 60000; //60 minutos\n        var infoNuevoEvento = JSON.parse(\n          JSON.stringify(this.eventoSiendoCreado)\n        );\n        this.$emit(\"iniciaCreacionEvento\");\n        const posContenedorEventos =\n          this.$refs.contenedorEventos.getBoundingClientRect();\n        const posX = e.pageX - posContenedorEventos.left;\n\n        const timeClicked = posX / this.horaPx;\n        var minutosClicked = Math.round(\n          (timeClicked - Math.floor(timeClicked)) * 60\n        );\n        minutosClicked = Math.floor(minutosClicked / 15) * 15; ///Set en múltiplos de 15\n\n        const timeClickedFormatted = {\n          horas: Math.floor(timeClicked),\n          minutos: minutosClicked,\n        };\n        const dateClicked =\n          this.esteDia.date.getTime() +\n          timeClickedFormatted.horas * 60 * 60000 +\n          timeClickedFormatted.minutos * 60000;\n        console.log(\n          `En ${posX} -> ${timeClickedFormatted.horas}: ${timeClickedFormatted.minutos}`\n        );\n\n        console.log(\n          `Date centralh: ${\n            this.esteDia.date.getTime() +\n            timeClickedFormatted.horas +\n            timeClickedFormatted.minutos * 60000\n          }`\n        );\n\n        var dateInicio = dateClicked;\n        var dateFinal = dateClicked + margen;\n\n        console.log(\n          `Quedará entre: ${new Date(dateInicio)} y ${new Date(dateFinal)}`\n        );\n\n        infoNuevoEvento.horarioInicio = new Date(dateInicio);\n        infoNuevoEvento.horarioFinal = new Date(dateFinal);\n        if (infoNuevoEvento.tipoEvento === \"eventoPublico\") {\n          delete infoNuevoEvento.tipoEvento;\n          this.crearEventoPublico(infoNuevoEvento);\n        } else if (infoNuevoEvento.tipoEvento === \"eventoPersonal\") {\n          delete infoNuevoEvento.tipoEvento;\n          this.crearEventoPersonal(infoNuevoEvento);\n        } else {\n          console.log(`Tipo ${infoNuevoEvento.tipoEvento} no reconocido`);\n        }\n      } else if (this.idEventoSeleccionado) {\n        this.$emit(\"desSeleccionDeEvento\");\n      }\n    },\n    addEventoCache(evento) {\n      const millisInicioEvento = new Date(evento.horarioInicio).getTime();\n      const millisInicioDia = this.esteDia.date.getTime();\n      const millisFinalDia = this.esteDia.date.getTime() + 86400000;\n\n      if (\n        millisInicioEvento < millisInicioDia ||\n        millisInicioEvento > millisFinalDia\n      ) {\n        return;\n      }\n      const tipoEvento =\n        evento.__typename.charAt(0).toLowerCase() + evento.__typename.slice(1);\n      var infoQuery = null;\n      if (tipoEvento === \"eventoPublico\") {\n        infoQuery = {\n          query: QUERY_EVENTOS_PUBLICOS_DIA,\n          variables: {\n            dateInicioDia: this.esteDia.date,\n          },\n        };\n      } else if (tipoEvento === \"eventoPersonal\") {\n        infoQuery = {\n          query: QUERY_EVENTOS_PERSONALES_DIA,\n          variables: {\n            dateInicioDia: this.esteDia.date,\n            idUsuario: this.idUsuarioTarget,\n          },\n        };\n      } else {\n        console.log(`Tipo evento ${tipoEvento} no reconocido`);\n        return;\n      }\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        ...infoQuery,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      var listaEventosCache = null;\n      if (tipoEvento === \"eventoPublico\") {\n        listaEventosCache = nuevoCache.eventosPublicosDia;\n      } else if (tipoEvento === \"eventoPersonal\") {\n        listaEventosCache = nuevoCache.eventosPersonalesDia;\n      }\n      const indexE = listaEventosCache.findIndex((e) => e.id === evento.id);\n      if (indexE === -1) {\n        listaEventosCache.push(evento);\n\n        store.writeQuery({\n          ...infoQuery,\n          data: nuevoCache,\n        });\n      }\n    },\n    crearEventoPublico(infoNuevoEvento) {\n      console.log(\n        `Creando un evento publico con info ${JSON.stringify(infoNuevoEvento)}`\n      );\n\n      this.creandoEvento = true;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($infoNuevoEvento: InputCrearEventoPublico) {\n              crearEventoPublico(infoNuevoEvento: $infoNuevoEvento) {\n                ...fragEventoPublico\n              }\n            }\n            ${fragmentoEventoPublico}\n          `,\n          variables: {\n            infoNuevoEvento,\n          },\n        })\n        .then(({ data: { crearEventoPublico } }) => {\n          this.creandoEvento = false;\n\n          this.addEventoCache(crearEventoPublico);\n           this.$emit(\"cambioEventos\");\n\n        })\n        .catch((error) => {\n          console.log(`Error: ${error}`);\n          this.creandoEvento = false;\n        });\n    },\n    crearEventoPersonal(infoNuevoEvento) {\n      console.log(\n        `Creando un evento personal con info ${JSON.stringify(infoNuevoEvento)}`\n      );\n      this.creandoEvento = true;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($infoEventoPersonal: InputCrearEventoPersonal) {\n              crearEventoPersonal(infoEventoPersonal: $infoEventoPersonal) {\n                ...fragEventoPersonal\n              }\n            }\n            ${fragmentoEventoPersonal}\n          `,\n          variables: {\n            infoEventoPersonal: {\n              ...infoNuevoEvento,\n              idPersona: this.idUsuarioTarget,\n            },\n          },\n        })\n        .then(({ data: { crearEventoPersonal } }) => {\n          this.creandoEvento = false;\n          this.addEventoCache(crearEventoPersonal);\n           this.$emit(\"cambioEventos\");\n\n        })\n        .catch((error) => {\n          console.log(`Error: ${error}`);\n          this.creandoEvento = false;\n        });\n    },\n    deleteEventoCache(evento) {\n      const tipoEvento =\n        evento.__typename.charAt(0).toLowerCase() + evento.__typename.slice(1);\n\n      console.log(`Deleting ${tipoEvento} ${evento.nombre} from cache`);\n\n      var infoQuery = null;\n      if (tipoEvento === \"eventoPublico\") {\n        infoQuery = {\n          query: QUERY_EVENTOS_PUBLICOS_DIA,\n          variables: {\n            dateInicioDia: this.esteDia.date,\n          },\n        };\n      } else if (tipoEvento === \"eventoPersonal\") {\n        infoQuery = {\n          query: QUERY_EVENTOS_PERSONALES_DIA,\n          variables: {\n            dateInicioDia: this.esteDia.date,\n            idUsuario: this.idUsuarioTarget,\n          },\n        };\n      } else {\n        console.log(`Tipo evento ${tipoEvento} no reconocido`);\n        return;\n      }\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        ...infoQuery,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      var listaEventosCache = null;\n      if (tipoEvento === \"eventoPublico\") {\n        listaEventosCache = nuevoCache.eventosPublicosDia;\n      } else if (tipoEvento === \"eventoPersonal\") {\n        listaEventosCache = nuevoCache.eventosPersonalesDia;\n      }\n      const indexE = listaEventosCache.findIndex((e) => e.id === evento.id);\n      if (indexE > -1) {\n        listaEventosCache.splice(indexE, 1);\n        store.writeQuery({\n          ...infoQuery,\n          data: nuevoCache,\n        });\n      }\n    },\n  },\n  computed: {\n    diaSemana() {\n      const nombres = [\n        \"Domingo\",\n        \"Lunes\",\n        \"Martes\",\n        \"Miércoles\",\n        \"Jueves\",\n        \"Viernes\",\n        \"Sábado\",\n        \"Domingo\",\n      ];\n      return nombres[this.esteDia.date.getDay()];\n    },\n    diaYMes() {\n      const meses = [\n        \"Enero\",\n        \"Febrero\",\n        \"Marzo\",\n        \"Abril\",\n        \"Mayo\",\n        \"Junio\",\n        \"Julio\",\n        \"Agosto\",\n        \"Septiembre\",\n        \"Octubre\",\n        \"Noviembre\",\n        \"Diciembre\",\n      ];\n\n      return (\n        this.esteDia.date.getDate() +\n        \" de \" +\n        meses[this.esteDia.date.getMonth()]\n      );\n    },\n    eventosPublicosVisibles() {\n      if (this.enfasis === \"eventosPublicos\") {\n        if (this.modoEventosPublicosExtranjeros === \"invisibles\") {\n          return this.eventosPublicosDia.filter(\n            (e) =>\n              e.idParent === this.idParent ||\n              e.idAdministrador === this.idUsuarioTarget\n          );\n        } else {\n          return this.eventosPublicosDia;\n        }\n      } else if (this.enfasis === \"eventosPersonales\") {\n        if (this.usuarioVeEventosPublicos) {\n          return this.eventosPublicosDia;\n        } else {\n          // return this.eventosPublicosDia.filter((ev) =>\n          //   this.eventosPersonalesDia.some((ep) => ep.idEventoMarco === ev.id)\n          // );\n          return this.eventosPublicosDia.filter(\n            (ep) => ep.idAdministrador === this.idUsuarioTarget\n          );\n        }\n      } else {\n        return [];\n      }\n    },\n    eventosPublicosUsuarioTarget() {\n      return this.eventosPublicosDia.filter(\n        (ev) => ev.idAdministrador === this.idUsuarioTarget\n      );\n    },\n    estiloSizeContenedorEventos() {\n      const alturaEventos = Object.values(this.indiceOffset).reduce(\n        (acc, a) => (a.top + a.height > acc ? a.top + a.height : acc),\n        0\n      );\n\n      return {\n        width: this.horaPx * 24 + \"px\",\n        height: alturaEventos + 45 + \"px\",\n      };\n    },\n    cantidadEventosPublicos() {\n      return this.eventosPublicosDia.length;\n    },\n    cantidadEventosRelevantes() {\n      if (this.enfasis === \"eventosPublicos\") {\n        if (!this.idParent) {\n          return this.cantidadEventosPublicos;\n        } else {\n          return this.eventosPublicosDia.filter(\n            (p) => p.idParent === this.idParent\n          ).length;\n        }\n      } else if (this.enfasis === \"eventosPersonales\") {\n        if (this.idParent) {\n          return this.eventosPersonalesDia.filter(\n            (ev) => ev.idParent === this.idParent\n          ).length;\n        }\n        return (\n          this.eventosPersonalesDia.length +\n          this.eventosPublicosUsuarioTarget.length\n        );\n      } else {\n        return 0;\n      }\n    },\n    indiceOffset() {\n      const sizeBarra = 15;\n      const sizeBloque = 100;\n      const marginRows = 5;\n      const lineaEventosPublicosAsistidos = 30;\n      // console.log(\n      //   `%c Iniciando calculo de indice de offset`,\n      //   \"background: #222; color: #bada55\"\n      // );\n      var indice = {};\n\n      if (!this.usuarioLogeado) {\n        console.log(`Cancelando índice offset`);\n        return null;\n      }\n\n      this.todosEventosPersonalesDia.forEach((ev) => {\n        let heightEvento = sizeBloque;\n        let claseEvento = \"bloque\";\n        let top = marginRows;\n\n        if (this.enfasis === \"eventosPersonales\") {\n          if (this.idParent) {\n            if (ev.idParent != this.idParent) {\n              heightEvento = sizeBarra;\n              claseEvento = \"barra\";\n            }\n          }\n        } else {\n          heightEvento = sizeBarra;\n          claseEvento = \"barra\";\n        }\n\n        indice[ev.id] = {\n          evento: ev,\n          top,\n          height: heightEvento,\n          bordeBot: top + heightEvento,\n          clase: claseEvento,\n        };\n      });\n\n      var listaEventosPublicos = JSON.parse(\n        JSON.stringify(this.eventosPublicosVisibles)\n      );\n      listaEventosPublicos.sort((a, b) => {\n        var res = 0;\n        if (a.idAdministrador === this.idUsuarioTarget) {\n          res++;\n        } else if (\n          this.eventosPersonalesDia.some((e) => e.idEventoMarco === a.id)\n        ) {\n          res++;\n        }\n        if (b.idAdministrador === this.idUsuarioTarget) {\n          res--;\n        } else if (\n          this.eventosPersonalesDia.some((e) => e.idEventoMarco === b.id)\n        ) {\n          res--;\n        }\n        return -res;\n      });\n      // console.log(\n      //   `Eventos sorted: ${listaEventosPublicos.map((e) => e.nombre)}`\n      // );\n\n      listaEventosPublicos.forEach((ev) => {\n        // console.log(`Iterando en ${ev.nombre}`);\n        let eventoAsisteUsuarioTarget = this.eventosPersonalesDia.some(\n          (ep) => ep.idEventoMarco === ev.id\n        );\n        let heightEvento = sizeBloque;\n        let claseEvento = \"bloque\";\n        if (\n          this.enfasis === \"eventosPublicos\" &&\n          ev.idParent != this.idParent &&\n          this.modoEventosPublicosExtranjeros != \"full\"\n        ) {\n          heightEvento = sizeBarra;\n          claseEvento = \"barra\";\n        }\n        // console.log(\n        //   `cantidad de entries en el indice ${\n        //     Object.entries(indice).map((e) => e[1]).length\n        //   }`\n        // );\n\n        let top = 0;\n        if (this.enfasis === \"eventosPersonales\" && eventoAsisteUsuarioTarget) {\n          top = lineaEventosPublicosAsistidos;\n        } else {\n          let eventosColision = Object.entries(indice)\n            .map((e) => e[1])\n            .filter((t) => {\n              // console.log(`Comparando con ${t.evento.nombre}`);\n              const inicioDentro =\n                t.evento.horarioInicio > ev.horarioInicio &&\n                t.evento.horarioInicio < ev.horarioFinal;\n              const finalDentro =\n                t.evento.horarioFinal > ev.horarioInicio &&\n                t.evento.horarioFinal < ev.horarioFinal;\n\n              const sobrepone =\n                t.evento.horarioInicio <= ev.horarioInicio &&\n                t.evento.horarioFinal >= ev.horarioFinal;\n\n              // console.log(`Inicio dentro: ${inicioDentro}`);\n              // console.log(`Final dentro: ${finalDentro}`);\n\n              const colision = inicioDentro || finalDentro || sobrepone;\n              // if (colision) {\n              //   console.log(`colision`);\n              // }\n              return colision;\n            });\n\n          // console.log(`${eventosColision.length} eventos en colisión`);\n\n          let bordeBotColision = eventosColision.reduce(\n            (acc, e) => (e.bordeBot > acc ? e.bordeBot : acc),\n            0\n          );\n\n          top = bordeBotColision + marginRows;\n        }\n\n        // console.log(`Queda en ${top} + ${heightEvento}`);\n        indice[ev.id] = {\n          evento: ev,\n          top: top,\n          height: heightEvento,\n          bordeBot: top + heightEvento + sizeBarra,\n          clase: claseEvento,\n        };\n      });\n      return indice;\n    },\n    todosEventosPersonalesDia() {\n      return this.eventosPersonalesDia.concat(\n        this.eventosPersonalesDeParentDia.filter(\n          (epp) =>\n            !this.eventosPersonalesDia.map((ep) => ep.id).includes(epp.id)\n        )\n      );\n    },\n    estiloSizeHora() {\n      return {\n        width: this.horaPx + \"px\",\n      };\n    },\n    downloadingData() {\n      return (\n        (this.$apollo.queries.eventosPersonalesDeParentDia &&\n          this.$apollo.queries.eventosPersonalesDeParentDia.loading) ||\n        (this.$apollo.queries.eventosPublicosDia &&\n          this.$apollo.queries.eventosPublicosDia.loading) ||\n        (this.$apollo.queries.eventosPersonalesDia &&\n          this.$apollo.queries.eventosPersonalesDia.loading)\n      );\n    },\n  },\n  watch: {},\n  mounted() {\n    const horaActual = new Date().getHours();\n    console.log(`Scrolling into ${horaActual}`);\n    this.$nextTick(() => {\n      this.$refs.labelsHoras[8].scrollIntoView({\n        block: \"nearest\",\n        inline: \"start\",\n      });\n    });\n  },\n};\n</script>\n\n<style scoped>\n#contenedorEventos {\n  min-height: 100px;\n  background-color: var(--grisHover);\n  padding: 20px 0px;\n  position: relative;\n}\n#barraSuperior {\n  display: flex;\n  font-family: Salsa, cursive;\n  align-items: center;\n  height: 25px;\n}\n#contenedorContenido {\n  width: 100%;\n  overflow: scroll;\n  height: 80vh;\n}\n#barraHoras {\n  display: flex;\n  overflow: visible;\n  padding: 14px 0px;\n}\n#barraHoras .hora {\n  font-size: 10px;\n  opacity: 0.4;\n  position: relative;\n  overflow: visible;\n  flex-shrink: 0;\n}\n#bloqueTituloDia {\n  display: flex;\n  align-items: center;\n  margin-left: 1vw;\n}\n#nombreDia {\n  margin-right: 2vw;\n  font-size: 10px;\n}\n#nombreDia.hoy {\n  color: red;\n}\n#fechaDia {\n  font-size: 10px;\n  opacity: 0.5;\n}\n#cantidadesEventos {\n  margin-left: 10px;\n  font-size: 10px;\n}\n</style>"]}]}