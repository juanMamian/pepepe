{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/atlasConocimiento/ItemRepaso.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/atlasConocimiento/ItemRepaso.vue","mtime":1648741729541},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgTG9hZGluZyBmcm9tICIuLi91dGlsaWRhZGVzL0xvYWRpbmcudnVlIjsKaW1wb3J0IEl0ZXJhY2lvblJlcGFzbyBmcm9tICIuL0l0ZXJhY2lvblJlcGFzby52dWUiOwppbXBvcnQgeyBRVUVSWV9EQVRPU19VU1VBUklPX05PRE9TIH0gZnJvbSAiLi9BdGxhc0Nvbm9jaW1pZW50by52dWUiOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgSXRlcmFjaW9uUmVwYXNvLCBMb2FkaW5nIH0sCiAgbmFtZTogIkl0ZW1SZXBhc28iLAogIHByb3BzOiB7CiAgICBlc3RlUmVwYXNvOiBPYmplY3QsCiAgICBtb3N0cmFyUmVwYXNvczogQm9vbGVhbgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNyZWFuZG9JdGVyYWNpb246IGZhbHNlLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNyZWFySXRlcmFjaW9uKCkgewogICAgICB2YXIgaW50ZXJ2YWxvID0gbnVsbDsKICAgICAgdGhpcy5jcmVhbmRvSXRlcmFjaW9uID0gdHJ1ZTsKICAgICAgdGhpcy4kYXBvbGxvCiAgICAgICAgLm11dGF0ZSh7CiAgICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgICBtdXRhdGlvbiAoJGlkVXN1YXJpbzogSUQhLCAkaWROb2RvOiBJRCEsICRpbnRlcnZhbG86IEludCkgewogICAgICAgICAgICAgIGNyZWFySXRlcmFjaW9uUmVwYXNvTm9kb0Nvbm9jaW1pZW50b1VzdWFyaW8oCiAgICAgICAgICAgICAgICBpZFVzdWFyaW86ICRpZFVzdWFyaW8KICAgICAgICAgICAgICAgIGlkTm9kbzogJGlkTm9kbwogICAgICAgICAgICAgICAgaW50ZXJ2YWxvOiAkaW50ZXJ2YWxvCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBpZAogICAgICAgICAgICAgICAgaXRlcmFjaW9uZXNSZXBhc28gewogICAgICAgICAgICAgICAgICBpZAogICAgICAgICAgICAgICAgICBpbnRlcnZhbG8KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIGAsCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgaWRVc3VhcmlvOiB0aGlzLnVzdWFyaW8uaWQsCiAgICAgICAgICAgIGlkTm9kbzogdGhpcy5lc3RlUmVwYXNvLmlkTm9kbywKICAgICAgICAgICAgaW50ZXJ2YWxvOiBpbnRlcnZhbG8sCiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5jcmVhbmRvSXRlcmFjaW9uID0gZmFsc2U7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICB0aGlzLmNyZWFuZG9JdGVyYWNpb24gPSBmYWxzZTsKICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJvcn1gKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBlbGltaW5hckl0ZXJhY2lvbkNhY2hlKGlkSXRlcmFjaW9uKSB7ICAgICAgCiAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlID0gc3RvcmUucmVhZFF1ZXJ5KHsKICAgICAgICBxdWVyeTogUVVFUllfREFUT1NfVVNVQVJJT19OT0RPUywKICAgICAgfSk7CiAgICAgIHZhciBudWV2b0NhY2hlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjYWNoZSkpOwogICAgICB2YXIgZWxEYXRvTm9kbyA9IG51ZXZvQ2FjaGUueW8uYXRsYXMuZGF0b3NOb2Rvcy5maW5kKAogICAgICAgIChkbikgPT4gZG4uaWQgPT09IHRoaXMuZXN0ZVJlcGFzby5pZAogICAgICApOwogICAgICB2YXIgaW5kZXhJID0gZWxEYXRvTm9kby5pdGVyYWNpb25lc1JlcGFzby5maW5kSW5kZXgoKGkpID0+IGkuaWQgPT09IGlkSXRlcmFjaW9uKTsKICAgICAgaWYgKGluZGV4SSA+IC0xKSB7CiAgICAgICAgZWxEYXRvTm9kby5pdGVyYWNpb25lc1JlcGFzby5zcGxpY2UoaW5kZXhJLCAxKTsKICAgICAgICBzdG9yZS53cml0ZVF1ZXJ5KHsKICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9EQVRPU19VU1VBUklPX05PRE9TLAogICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyhgTGEgaXRlcmFjacOzbiBubyBlc3RhYmEgZW4gY2FjaMOpYCk7CiAgICAgIH0KICAgIH0sCiAgfSwKICBjb21wdXRlZDp7CiAgICBjb2xvckJhcnJhU3VwZXJpb3IoKXsKICAgICAgdmFyIGNvbG9yPSJ0cmFuc3BhcmVudCIKICAgICAgaWYodGhpcy5tb3N0cmFyUmVwYXNvcyl7CiAgICAgICAgY29sb3I9InZhcigtLW1haW5Db2xvcikiOwogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBjb2xvcgogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCl7CiAgICB0aGlzLiRlbWl0KCJpbmljaWFkbyIpOwogIH0KfTsK"},{"version":3,"sources":["ItemRepaso.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ItemRepaso.vue","sourceRoot":"src/components/atlasConocimiento","sourcesContent":["<template>\n  <div class=\"itemRepaso\">\n    <div id=\"barraSuperior\" :style=\"[colorBarraSuperior]\">\n      <div id=\"nombre\">\n        {{ esteRepaso.nombreNodo }}\n      </div>\n      <div id=\"bloqueBotones\" class=\"contenedorControles\">\n        <div\n          class=\"boton\"\n          title=\"Abrir\"\n          @click=\"\n            $router.push({\n              name: 'visorNodoConocimiento',\n              params: { idNodo: esteRepaso.idNodo },\n            })\n          \"\n        >\n          <img src=\"@/assets/iconos/expand.svg\" alt=\"Expandir\" />\n        </div>\n        <div class=\"boton\" title=\"Ver en el atlas\" @click=\"$emit('centrarEnNodo')\">\n          <img src=\"@/assets/iconos/nodos.svg\" alt=\"Nodos\" />\n        </div>\n        <div\n          class=\"boton\"\n          title=\"Programar repasos\"\n          @click=\"$emit('toggleAbierto')\"\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n          <path\n            d=\"M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z\"\n            :fill=\"esteRepaso.porcentajeIntervaloTranscurrido>=100?'var(--atlasConocimientoRepaso)':''\"\n          />\n        </svg>\n        </div>\n      </div>\n    </div>\n    <div id=\"zonaIteraciones\" v-show=\"mostrarRepasos\">\n      <div id=\"listaIteraciones\">\n        <iteracion-repaso\n          v-for=\"(iteracion, index) of esteRepaso.iteracionesRepaso\"\n          :key=\"iteracion.id\"\n          :primero=\"index===0\"\n          :porcentajeIntervaloTranscurrido=\"esteRepaso.porcentajeIntervaloTranscurrido\"\n          :urgente=\"index===0 && Date.now()>(new Date(esteRepaso.estudiado).getTime()+iteracion.intervalo)\"\n          :estaIteracion=\"iteracion\"\n          :idNodo=\"esteRepaso.idNodo\"\n          @meElimine=\"eliminarIteracionCache(iteracion.id)\"\n        />\n        <div\n        class=\"boton\"\n        title=\"Crear nuevo repaso\"\n        id=\"botonCrearIteracionRepaso\"\n        v-show=\"!creandoIteracion\"\n        @click=\"crearIteracion\"\n      >\n        <img src=\"@/assets/iconos/plusCircle.svg\" alt=\"Plus\" />\n      </div>\n      <loading texto=\"\" v-show=\"creandoIteracion\" />\n      </div>\n      \n    </div>\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport Loading from \"../utilidades/Loading.vue\";\nimport IteracionRepaso from \"./IteracionRepaso.vue\";\nimport { QUERY_DATOS_USUARIO_NODOS } from \"./AtlasConocimiento.vue\";\n\nexport default {\n  components: { IteracionRepaso, Loading },\n  name: \"ItemRepaso\",\n  props: {\n    esteRepaso: Object,\n    mostrarRepasos: Boolean\n  },\n  data() {\n    return {\n      creandoIteracion: false,\n    };\n  },\n  methods: {\n    crearIteracion() {\n      var intervalo = null;\n      this.creandoIteracion = true;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($idUsuario: ID!, $idNodo: ID!, $intervalo: Int) {\n              crearIteracionRepasoNodoConocimientoUsuario(\n                idUsuario: $idUsuario\n                idNodo: $idNodo\n                intervalo: $intervalo\n              ) {\n                id\n                iteracionesRepaso {\n                  id\n                  intervalo\n                }\n              }\n            }\n          `,\n          variables: {\n            idUsuario: this.usuario.id,\n            idNodo: this.esteRepaso.idNodo,\n            intervalo: intervalo,\n          },\n        })\n        .then(() => {\n          this.creandoIteracion = false;\n        })\n        .catch((error) => {\n          this.creandoIteracion = false;\n          console.log(`Error: ${error}`);\n        });\n    },\n    eliminarIteracionCache(idIteracion) {      \n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      var elDatoNodo = nuevoCache.yo.atlas.datosNodos.find(\n        (dn) => dn.id === this.esteRepaso.id\n      );\n      var indexI = elDatoNodo.iteracionesRepaso.findIndex((i) => i.id === idIteracion);\n      if (indexI > -1) {\n        elDatoNodo.iteracionesRepaso.splice(indexI, 1);\n        store.writeQuery({\n          query: QUERY_DATOS_USUARIO_NODOS,\n          data: nuevoCache,\n        });\n      } else {\n        console.log(`La iteración no estaba en caché`);\n      }\n    },\n  },\n  computed:{\n    colorBarraSuperior(){\n      var color=\"transparent\"\n      if(this.mostrarRepasos){\n        color=\"var(--mainColor)\";\n      }\n      return {\n        backgroundColor: color\n      }\n    }\n  },\n  mounted(){\n    this.$emit(\"iniciado\");\n  }\n};\n</script>\n\n<style scoped>\n#barraSuperior {\n  display: flex;\n  padding: 20px 5px;\n  padding-left: 15px;\n  align-items: center;\n  font-family: Salsa, cursive;\n}\n.contenedorControles {\n  margin-left: auto;\n}\n#listaIteraciones {\n  display: flex;\n  flex-wrap: wrap;\n  padding: 20px 5px;\n  background-color: rgb(216, 216, 216);\n  align-items: center;\n}\n#botonCrearIteracionRepaso{\n  height: 28px;\n  margin: 0px 10px;\n}\n</style>"]}]}