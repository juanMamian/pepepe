{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/ListaEventosEspacio.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/ListaEventosEspacio.vue","mtime":1644587546118},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgeyBmcmFnbWVudG9FdmVudG9QdWJsaWNvIH0gZnJvbSAiLi91dGlsaWRhZGVzL2ZyYWdzQ2FsZW5kYXJpbyI7CmltcG9ydCBFdmVudG9JdGVtTGlzdGEgZnJvbSAiLi9FdmVudG9JdGVtTGlzdGEudnVlIjsKaW1wb3J0IExvYWRpbmcgZnJvbSAiLi91dGlsaWRhZGVzL0xvYWRpbmcudnVlIjsKCmNvbnN0IFFVRVJZX0VWRU5UT1NfUFVCTElDT1NfRVNQQUNJTyA9IGdxbGAKICBxdWVyeSAoJGlkRXNwYWNpbzogSUQhKSB7CiAgICBldmVudG9zUHVibGljb3NFc3BhY2lvKGlkRXNwYWNpbzogJGlkRXNwYWNpbykgewogICAgICAuLi5mcmFnRXZlbnRvUHVibGljbwogICAgfQogIH0KICAke2ZyYWdtZW50b0V2ZW50b1B1YmxpY299CmA7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBFdmVudG9JdGVtTGlzdGEsIExvYWRpbmcgfSwKICBwcm9wczogewogICAgaWRFc3BhY2lvOiBTdHJpbmcsCiAgfSwKICBuYW1lOiAiTGlzdGFFdmVudG9zRXNwYWNpbyIsCiAgYXBvbGxvOiB7CiAgICBldmVudG9zUHVibGljb3NFc3BhY2lvOiB7CiAgICAgIHF1ZXJ5OiBRVUVSWV9FVkVOVE9TX1BVQkxJQ09TX0VTUEFDSU8sCiAgICAgIHZhcmlhYmxlcygpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWRFc3BhY2lvOiB0aGlzLmlkRXNwYWNpbywKICAgICAgICB9OwogICAgICB9LAogICAgICBmZXRjaFBvbGljeTogImNhY2hlLWFuZC1uZXR3b3JrIiwKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaWRFdmVudG9TZWxlY2Npb25hZG86IG51bGwsCiAgICAgIGV2ZW50b3NQdWJsaWNvc0VzcGFjaW86IFtdLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlbGV0ZUV2ZW50b0NhY2hlKGV2ZW50bykgewogICAgICBjb25zdCB0aXBvRXZlbnRvID0KICAgICAgICBldmVudG8uX190eXBlbmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIGV2ZW50by5fX3R5cGVuYW1lLnNsaWNlKDEpOwogICAgICB2YXIgaW5mb1F1ZXJ5ID0gbnVsbDsKICAgICAgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QdWJsaWNvIikgewogICAgICAgIGluZm9RdWVyeSA9IHsKICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9FVkVOVE9TX1BVQkxJQ09TX0VTUEFDSU8sCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgaWRFc3BhY2lvOiB0aGlzLmlkRXNwYWNpbywKICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgfSBlbHNlIGlmICh0aXBvRXZlbnRvID09PSAiZXZlbnRvUGVyc29uYWwiKSB7CiAgICAgICAgY29uc29sZS5sb2coYGFkZCBjYWNoZSBldmVudG9zIHBlcnNvbmFsZXMgbm90IGRldmVsb3BlZGApOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyhgVGlwbyBldmVudG8gJHt0aXBvRXZlbnRvfSBubyByZWNvbm9jaWRvYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlID0gc3RvcmUucmVhZFF1ZXJ5KHsKICAgICAgICAuLi5pbmZvUXVlcnksCiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKICAgICAgdmFyIGxpc3RhRXZlbnRvc0NhY2hlID0gbnVsbDsKICAgICAgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QdWJsaWNvIikgewogICAgICAgIGxpc3RhRXZlbnRvc0NhY2hlID0gbnVldm9DYWNoZS5ldmVudG9zUHVibGljb3NFc3BhY2lvOwogICAgICB9IGVsc2UgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QZXJzb25hbCIpIHsKICAgICAgICBsaXN0YUV2ZW50b3NDYWNoZSA9IG51ZXZvQ2FjaGUuZXZlbnRvc1BlcnNvbmFsZXNFc3BhY2lvOwogICAgICB9CiAgICAgIGNvbnN0IGluZGV4RSA9IGxpc3RhRXZlbnRvc0NhY2hlLmZpbmRJbmRleCgoZSkgPT4gZS5pZCA9PT0gZXZlbnRvLmlkKTsKICAgICAgaWYgKGluZGV4RSA+IC0xKSB7CiAgICAgICAgbGlzdGFFdmVudG9zQ2FjaGUuc3BsaWNlKGluZGV4RSwgMSk7CgogICAgICAgIHN0b3JlLndyaXRlUXVlcnkoewogICAgICAgICAgLi4uaW5mb1F1ZXJ5LAogICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGFkZEV2ZW50b0NhY2hlKGV2ZW50bykgewogICAgICBjb25zdCB0aXBvRXZlbnRvID0KICAgICAgICBldmVudG8uX190eXBlbmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIGV2ZW50by5fX3R5cGVuYW1lLnNsaWNlKDEpOwogICAgICB2YXIgaW5mb1F1ZXJ5ID0gbnVsbDsKICAgICAgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QdWJsaWNvIikgewogICAgICAgIGluZm9RdWVyeSA9IHsKICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9FVkVOVE9TX1BVQkxJQ09TX0VTUEFDSU8sCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgaWRFc3BhY2lvOiB0aGlzLmlkRXNwYWNpbywKICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgfSBlbHNlIGlmICh0aXBvRXZlbnRvID09PSAiZXZlbnRvUGVyc29uYWwiKSB7CiAgICAgICAgY29uc29sZS5sb2coYGFkZCBjYWNoZSBldmVudG9zIHBlcnNvbmFsZXMgbm90IGRldmVsb3BlZGApOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyhgVGlwbyBldmVudG8gJHt0aXBvRXZlbnRvfSBubyByZWNvbm9jaWRvYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlID0gc3RvcmUucmVhZFF1ZXJ5KHsKICAgICAgICAuLi5pbmZvUXVlcnksCiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKICAgICAgdmFyIGxpc3RhRXZlbnRvc0NhY2hlID0gbnVsbDsKICAgICAgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QdWJsaWNvIikgewogICAgICAgIGxpc3RhRXZlbnRvc0NhY2hlID0gbnVldm9DYWNoZS5ldmVudG9zUHVibGljb3NFc3BhY2lvOwogICAgICB9IGVsc2UgaWYgKHRpcG9FdmVudG8gPT09ICJldmVudG9QZXJzb25hbCIpIHsKICAgICAgICBsaXN0YUV2ZW50b3NDYWNoZSA9IG51ZXZvQ2FjaGUuZXZlbnRvc1BlcnNvbmFsZXNFc3BhY2lvOwogICAgICB9CiAgICAgIGNvbnN0IGluZGV4RSA9IGxpc3RhRXZlbnRvc0NhY2hlLmZpbmRJbmRleCgoZSkgPT4gZS5pZCA9PT0gZXZlbnRvLmlkKTsKICAgICAgaWYgKGluZGV4RSA9PT0gLTEpIHsKICAgICAgICBsaXN0YUV2ZW50b3NDYWNoZS5wdXNoKGV2ZW50byk7CgogICAgICAgIHN0b3JlLndyaXRlUXVlcnkoewogICAgICAgICAgLi4uaW5mb1F1ZXJ5LAogICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBldmVudG9zUHVibGljb3NFc3BhY2lvT3JkZW5hZG9zKCkgewogICAgICByZXR1cm4gWy4uLnRoaXMuZXZlbnRvc1B1YmxpY29zRXNwYWNpb10uc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiAoCiAgICAgICAgICBuZXcgRGF0ZShhLmhvcmFyaW9JbmljaW8pLmdldFRpbWUoKSAtCiAgICAgICAgICBuZXcgRGF0ZShiLmhvcmFyaW9JbmljaW8pLmdldFRpbWUoKQogICAgICAgICk7CiAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["ListaEventosEspacio.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ListaEventosEspacio.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"listaEventosEspacio\">\n    <loading texto=\"\" v-show=\"$apollo.queries.eventosPublicosEspacio.loading\" />\n    <evento-item-lista\n      :esteEvento=\"evento\"\n      v-for=\"evento of eventosPublicosEspacioOrdenados\"\n      :key=\"evento.id\"\n      :seleccionado=\"idEventoSeleccionado === evento.id\"\n      @meElimine=\"\n        deleteEventoCache(evento);        \n      \"\n    />\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport { fragmentoEventoPublico } from \"./utilidades/fragsCalendario\";\nimport EventoItemLista from \"./EventoItemLista.vue\";\nimport Loading from \"./utilidades/Loading.vue\";\n\nconst QUERY_EVENTOS_PUBLICOS_ESPACIO = gql`\n  query ($idEspacio: ID!) {\n    eventosPublicosEspacio(idEspacio: $idEspacio) {\n      ...fragEventoPublico\n    }\n  }\n  ${fragmentoEventoPublico}\n`;\n\nexport default {\n  components: { EventoItemLista, Loading },\n  props: {\n    idEspacio: String,\n  },\n  name: \"ListaEventosEspacio\",\n  apollo: {\n    eventosPublicosEspacio: {\n      query: QUERY_EVENTOS_PUBLICOS_ESPACIO,\n      variables() {\n        return {\n          idEspacio: this.idEspacio,\n        };\n      },\n      fetchPolicy: \"cache-and-network\",\n    },\n  },\n  data() {\n    return {\n      idEventoSeleccionado: null,\n      eventosPublicosEspacio: [],\n    };\n  },\n  methods: {\n    deleteEventoCache(evento) {\n      const tipoEvento =\n        evento.__typename.charAt(0).toLowerCase() + evento.__typename.slice(1);\n      var infoQuery = null;\n      if (tipoEvento === \"eventoPublico\") {\n        infoQuery = {\n          query: QUERY_EVENTOS_PUBLICOS_ESPACIO,\n          variables: {\n            idEspacio: this.idEspacio,\n          },\n        };\n      } else if (tipoEvento === \"eventoPersonal\") {\n        console.log(`add cache eventos personales not developed`);\n        return;\n      } else {\n        console.log(`Tipo evento ${tipoEvento} no reconocido`);\n        return;\n      }\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        ...infoQuery,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      var listaEventosCache = null;\n      if (tipoEvento === \"eventoPublico\") {\n        listaEventosCache = nuevoCache.eventosPublicosEspacio;\n      } else if (tipoEvento === \"eventoPersonal\") {\n        listaEventosCache = nuevoCache.eventosPersonalesEspacio;\n      }\n      const indexE = listaEventosCache.findIndex((e) => e.id === evento.id);\n      if (indexE > -1) {\n        listaEventosCache.splice(indexE, 1);\n\n        store.writeQuery({\n          ...infoQuery,\n          data: nuevoCache,\n        });\n      }\n    },\n    addEventoCache(evento) {\n      const tipoEvento =\n        evento.__typename.charAt(0).toLowerCase() + evento.__typename.slice(1);\n      var infoQuery = null;\n      if (tipoEvento === \"eventoPublico\") {\n        infoQuery = {\n          query: QUERY_EVENTOS_PUBLICOS_ESPACIO,\n          variables: {\n            idEspacio: this.idEspacio,\n          },\n        };\n      } else if (tipoEvento === \"eventoPersonal\") {\n        console.log(`add cache eventos personales not developed`);\n        return;\n      } else {\n        console.log(`Tipo evento ${tipoEvento} no reconocido`);\n        return;\n      }\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        ...infoQuery,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      var listaEventosCache = null;\n      if (tipoEvento === \"eventoPublico\") {\n        listaEventosCache = nuevoCache.eventosPublicosEspacio;\n      } else if (tipoEvento === \"eventoPersonal\") {\n        listaEventosCache = nuevoCache.eventosPersonalesEspacio;\n      }\n      const indexE = listaEventosCache.findIndex((e) => e.id === evento.id);\n      if (indexE === -1) {\n        listaEventosCache.push(evento);\n\n        store.writeQuery({\n          ...infoQuery,\n          data: nuevoCache,\n        });\n      }\n    },\n  },\n  computed: {\n    eventosPublicosEspacioOrdenados() {\n      return [...this.eventosPublicosEspacio].sort((a, b) => {\n        return (\n          new Date(a.horarioInicio).getTime() -\n          new Date(b.horarioInicio).getTime()\n        );\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.listaEventosEspacio {\n  overflow-y: scroll;\n  overflow-x: hidden;\n}\n.eventoItemLista {\n  margin: 15px 0px;\n}\n</style>"]}]}