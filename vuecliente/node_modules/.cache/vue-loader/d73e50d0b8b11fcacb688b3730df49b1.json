{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/usuario/NotificacionActividadForos.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/usuario/NotificacionActividadForos.vue","mtime":1643654906679},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgeyBRVUVSWV9ZTyB9IGZyb20gIi4uLy4uL0FwcC52dWUiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJOb3RpZmljYWNpb25BY3RpdmlkYWRGb3JvcyIsCiAgcHJvcHM6IHsKICAgIGVzdGFOb3RpZmljYWNpb246IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICBkZWZhdWx0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9LAogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIHZpc2l0YXIoKSB7CiAgICAgIHZhciBlbmxhY2UgPSAiLyI7CiAgICAgIGVubGFjZSArPQogICAgICAgIHRoaXMuZXN0YU5vdGlmaWNhY2lvbi50aXBvUGFyZW50ICsgIi8iICsgdGhpcy5lc3RhTm90aWZpY2FjaW9uLmlkUGFyZW50OwoKICAgICAgaWYgKHRoaXMuZXN0YU5vdGlmaWNhY2lvbi50aXBvUGFyZW50ID09ICJsaWJybyIpIHsKICAgICAgICBjb25zb2xlLmxvZyhgRXMgZWwgZW5sYWNlIGEgdW4gbGlicm9gKTsKICAgICAgICB2YXIgZW5sYWNlTGlicm8gPXRoaXMudGFsbGVyQ3VlbnRvc1VybCsnP3Q9Jyt0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbisiJmw9Iit0aGlzLmVzdGFOb3RpZmljYWNpb24uaWRQYXJlbnQ7CiAgICAgICAgY29uc29sZS5sb2coYEFicmllbmRvIGVubGFjZTogJHtlbmxhY2VMaWJyb31gKTsKICAgICAgICB3aW5kb3cub3BlbihlbmxhY2VMaWJybywgIl9ibGFuayIpOwogICAgICAgIHRoaXMuZWxpbWluYXJzZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZWxpbWluYXJzZSgpOwogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKGVubGFjZSkuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgZGUgbmF2ZWdhY2nDs246ICR7ZXJyb3IubWVzc2FnZS5zdWJzdHIoMCwgMjgpfWApOwogICAgICAgICAgaWYgKGVycm9yLm1lc3NhZ2Uuc3Vic3RyKDAsIDI4KSA9PSAiQXZvaWRlZCByZWR1bmRhbnQgbmF2aWdhdGlvbiIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yIHBvciBuYXZlZ2FjacOzbmApOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZWxpbWluYXJzZSgpIHsKICAgICAgbGV0IGlkUGFyZW50ID0gdGhpcy5lc3RhTm90aWZpY2FjaW9uLmlkUGFyZW50OwogICAgICBjb25zb2xlLmxvZyhgRWxpbWluYW5kb3NlOiAke2lkUGFyZW50fWApOwogICAgICB0aGlzLiRhcG9sbG8ubXV0YXRlKHsKICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgbXV0YXRpb24oJGlkUGFyZW50OiBJRCEpIHsKICAgICAgICAgICAgZWxpbWluYXJOb3RpZmljYWNpb25BY3RpdmlkYWRGb3JvcyhpZFBhcmVudDogJGlkUGFyZW50KQogICAgICAgICAgfQogICAgICAgIGAsCiAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICBpZFBhcmVudCwKICAgICAgICB9LAogICAgICAgIHVwZGF0ZTogKHN0b3JlLCB7IGRhdGE6IHsgZWxpbWluYXJOb3RpZmljYWNpb25BY3RpdmlkYWRGb3JvcyB9IH0pID0+IHsKICAgICAgICAgIGlmIChlbGltaW5hck5vdGlmaWNhY2lvbkFjdGl2aWRhZEZvcm9zKSB7CiAgICAgICAgICAgIGxldCBjYWNoZSA9IHN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgICAgICAgcXVlcnk6IFFVRVJZX1lPLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbGV0IG51ZXZvQ2FjaGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7CiAgICAgICAgICAgIGxldCBpbmRleE4gPSBudWV2b0NhY2hlLnlvLm5vdGlmaWNhY2lvbmVzQWN0aXZpZGFkRm9yb3MuZmluZEluZGV4KAogICAgICAgICAgICAgIChuKSA9PiBuLmlkUGFyZW50ID09IGlkUGFyZW50CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChpbmRleE4gPiAtMSkgewogICAgICAgICAgICAgIG51ZXZvQ2FjaGUueW8ubm90aWZpY2FjaW9uZXNBY3RpdmlkYWRGb3Jvcy5zcGxpY2UoaW5kZXhOLCAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzdG9yZS53cml0ZVF1ZXJ5KHsKICAgICAgICAgICAgICBxdWVyeTogUVVFUllfWU8sCiAgICAgICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgfSk7CiAgICB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIG1lbnNhamU6IGZ1bmN0aW9uICgpIHsKICAgICAgbGV0IHRpcG9UYXJnZXQgPSB0aGlzLmVzdGFOb3RpZmljYWNpb24udGlwb1BhcmVudDsKICAgICAgaWYgKHRpcG9UYXJnZXQgPT0gIm5vZG9Db25vY2ltaWVudG8iKSB0aXBvVGFyZ2V0ID0gIm5vZG8gZGUgY29ub2NpbWllbnRvIjsKICAgICAgbGV0IHBhbGFicmFUYXJnZXQgPSAiPHNwYW4gc3R5bGU9J2NvbG9yOnJlZCc+IiArIHRpcG9UYXJnZXQgKyAiPC9zcGFuPiI7CiAgICAgIHZhciBtZW5zYWplID0KICAgICAgICAiSGF5IG51ZXZhcyByZXNwdWVzdGFzIGVuIGxvcyBmb3JvcyBkZWwgIiArCiAgICAgICAgcGFsYWJyYVRhcmdldCArCiAgICAgICAgIiAiICsKICAgICAgICB0aGlzLmVzdGFOb3RpZmljYWNpb24ubm9tYnJlUGFyZW50OwoKICAgICAgcmV0dXJuIG1lbnNhamU7CiAgICB9LAogICAgdGFsbGVyQ3VlbnRvc1VybCgpIHsKICAgICAgcmV0dXJuIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAicHJvZHVjdGlvbiIKICAgICAgICA/ICJodHRwczovL3BlLXBlLXBlLmhlcm9rdWFwcC5jb20vdGFsbGVyQ3VlbnRvcyIKICAgICAgICA6ICJodHRwOi8vbG9jYWxob3N0OjgwODEiOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["NotificacionActividadForos.vue"],"names":[],"mappings":";;;;;;;;;;;;AAYA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"NotificacionActividadForos.vue","sourceRoot":"src/components/usuario","sourcesContent":["<template>\n  <div class=\"notificacionActividadForos\" @click=\"visitar\">\n    <img\n      src=\"@/assets/iconos/conversacion.png\"\n      alt=\"Conversación\"\n      id=\"iconoConversacion\"\n    />\n    <div id=\"texto\" v-html=\"mensaje\"></div>\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport { QUERY_YO } from \"../../App.vue\";\n\nexport default {\n  name: \"NotificacionActividadForos\",\n  props: {\n    estaNotificacion: {\n      type: Object,\n      default: function () {\n        return {};\n      },\n    },\n  },\n  methods: {\n    visitar() {\n      var enlace = \"/\";\n      enlace +=\n        this.estaNotificacion.tipoParent + \"/\" + this.estaNotificacion.idParent;\n\n      if (this.estaNotificacion.tipoParent == \"libro\") {\n        console.log(`Es el enlace a un libro`);\n        var enlaceLibro =this.tallerCuentosUrl+'?t='+this.$store.state.token+\"&l=\"+this.estaNotificacion.idParent;\n        console.log(`Abriendo enlace: ${enlaceLibro}`);\n        window.open(enlaceLibro, \"_blank\");\n        this.eliminarse();\n      } else {\n        this.eliminarse();\n        this.$router.push(enlace).catch((error) => {\n          console.log(`Error de navegación: ${error.message.substr(0, 28)}`);\n          if (error.message.substr(0, 28) == \"Avoided redundant navigation\") {\n            console.log(`Error por navegación`);\n          }\n        });\n      }\n    },\n    eliminarse() {\n      let idParent = this.estaNotificacion.idParent;\n      console.log(`Eliminandose: ${idParent}`);\n      this.$apollo.mutate({\n        mutation: gql`\n          mutation($idParent: ID!) {\n            eliminarNotificacionActividadForos(idParent: $idParent)\n          }\n        `,\n        variables: {\n          idParent,\n        },\n        update: (store, { data: { eliminarNotificacionActividadForos } }) => {\n          if (eliminarNotificacionActividadForos) {\n            let cache = store.readQuery({\n              query: QUERY_YO,\n            });\n            let nuevoCache = JSON.parse(JSON.stringify(cache));\n            let indexN = nuevoCache.yo.notificacionesActividadForos.findIndex(\n              (n) => n.idParent == idParent\n            );\n            if (indexN > -1) {\n              nuevoCache.yo.notificacionesActividadForos.splice(indexN, 1);\n            }\n            store.writeQuery({\n              query: QUERY_YO,\n              data: nuevoCache,\n            });\n          }\n        },\n      });\n    },\n  },\n  computed: {\n    mensaje: function () {\n      let tipoTarget = this.estaNotificacion.tipoParent;\n      if (tipoTarget == \"nodoConocimiento\") tipoTarget = \"nodo de conocimiento\";\n      let palabraTarget = \"<span style='color:red'>\" + tipoTarget + \"</span>\";\n      var mensaje =\n        \"Hay nuevas respuestas en los foros del \" +\n        palabraTarget +\n        \" \" +\n        this.estaNotificacion.nombreParent;\n\n      return mensaje;\n    },\n    tallerCuentosUrl() {\n      return process.env.NODE_ENV === \"production\"\n        ? \"https://pe-pe-pe.herokuapp.com/tallerCuentos\"\n        : \"http://localhost:8081\";\n    },\n  },\n};\n</script>\n\n<style scoped>\n.notificacionActividadForos {\n  width: 300px;\n  height: 130px;\n  border: 1px solid rgb(0, 58, 105);\n  background-color: rgb(58, 175, 243);\n  display: grid;\n  grid-template-columns: 100px 1fr;\n  grid-template-rows: 15px 1fr;\n  grid-template-areas:\n    \"info info\"\n    \"imagen texto\";\n  align-items: center;\n  justify-items: center;\n  cursor: pointer;\n}\n.notificacionActividadForos:hover {\n  background-color: rgb(119, 196, 241);\n}\n#info {\n  grid-area: info;\n  font-size: 11px;\n  color: white;\n}\n#iconoConversacion {\n  grid-area: imagen;\n  width: 70px;\n  height: 70px;\n  border-radius: 50%;\n}\n#texto {\n  grid-area: texto;\n}\n.textoTarget {\n  color: white;\n}\n</style>"]}]}