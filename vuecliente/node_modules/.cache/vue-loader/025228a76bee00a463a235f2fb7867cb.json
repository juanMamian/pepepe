{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/atlasSolidaridad/ventanaLista/ventanaLista.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/atlasSolidaridad/ventanaLista/ventanaLista.vue","mtime":1643654906499},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMb2FkaW5nIGZyb20gJy4uLy4uL3V0aWxpZGFkZXMvTG9hZGluZy52dWUnOwppbXBvcnQgeyBNaXhpbkF0bGFzU29saWRhcmlkYWQgfSBmcm9tICcuLi9NaXhpbkF0bGFzU29saWRhcmlkYWQnOwppbXBvcnQgQnVzY2Fkb3JOb2RvcyBmcm9tICIuL0J1c2NhZG9yTm9kb3MudnVlIjsKaW1wb3J0IExpc3RhTm9kb3MgZnJvbSAiLi9MaXN0YU5vZG9zLnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBMaXN0YU5vZG9zLCBCdXNjYWRvck5vZG9zLCBMb2FkaW5nIH0sCiAgbmFtZTogIlZlbnRhbmFMaXN0YSIsCiAgcHJvcHM6IHsgICAgCiAgICBpZE5vZG9Sb290OiBTdHJpbmcsCiAgICB0aXBvTm9kb1Jvb3Q6U3RyaW5nLAogICAgY2VycmFibGU6IEJvb2xlYW4sICAgICAgICAKICB9LCAgCiAgbWl4aW5zOltNaXhpbkF0bGFzU29saWRhcmlkYWRdLCAgCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlkTm9kb1NlbGVjY2lvbmFkbzogbnVsbCwKICAgICAgbGlzdGFTZWxlY2Npb25hZGE6IG51bGwsCiAgICAgIHZlckNvbXBsZXRhZG9zOiB0cnVlLAogICAgICBtb2RvTGlzdGE6ICJ0b2RvIiwgICAgICAKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBkZXNwbGVnYXJDYXNjYWRhSGFjaWFOb2RvKGlkTm9kbykgewogICAgICB0aGlzLiRyZWZzLmxpc3RhTm9kb3MuZGVzcGxlZ2FyQ2FzY2FkYUhhY2lhTm9kbyhpZE5vZG8pOwogICAgfSwKICAgIAogICAgdXBkYXRlSW5mb05vZG9zRXZlclJlbmRlcmVkKGlkc05vZG9zUmVuZGVyZWQpewogICAgICBjb25zdCBudWV2b3M9aWRzTm9kb3NSZW5kZXJlZC5maWx0ZXIoaWQ9PiF0aGlzLmluZm9Ob2Rvc0V2ZXJSZW5kZXJlZC5tYXAobmVyPT5uZXIuaWQpLmluY2x1ZGVzKGlkKSk7CiAgICAgIGNvbnN0IG51ZXZvc0luZm9zPW51ZXZvcy5tYXAoaWQ9PntyZXR1cm4ge2lkLCB0aXBvOidub2RvU29saWRhcmlkYWQnfX0pCiAgICAgIHRoaXMuaW5mb05vZG9zRXZlclJlbmRlcmVkLnB1c2goLi4ubnVldm9zSW5mb3MpCiAgICB9LCAgICAgICAKICB9LAogIGNvbXB1dGVkOiB7CiAgICBub2RvU2VsZWNjaW9uYWRvKCkgewogICAgICBpZiAoIXRoaXMuaWROb2RvU2VsZWNjaW9uYWRvKSByZXR1cm4gbnVsbDsKICAgICAgcmV0dXJuIHRoaXMudG9kb3NOb2Rvcy5maW5kKChuKSA9PiBuLmlkID09PSB0aGlzLmlkTm9kb1NlbGVjY2lvbmFkbyk7CiAgICB9LAogICAgZGVzY2VuZGllbnRlc05vZG9TZWxlY2Npb25hZG8oKSB7CiAgICAgIGlmICghdGhpcy5ub2RvU2VsZWNjaW9uYWRvKSByZXR1cm4gbnVsbDsKICAgICAgY29uc3QgbWF4TmVzdGluZyA9IDU7CiAgICAgIHZhciBuZXN0aW5nID0gMDsKICAgICAgdmFyIGlkTm9kb3NDdXJyZW50Tml2ZWwgPSBbdGhpcy5ub2RvU2VsZWNjaW9uYWRvLmlkXTsKICAgICAgdmFyIG5vZG9zRGVzY2VuZGllbnRlcyA9IFtdOwogICAgICB3aGlsZSAoaWROb2Rvc0N1cnJlbnROaXZlbC5sZW5ndGggPiAwICYmIG5lc3RpbmcgPCBtYXhOZXN0aW5nKSB7CiAgICAgICAgY29uc29sZS5sb2coYERlc2NlbmRpZW50ZXNgKTsKICAgICAgICBuZXN0aW5nKys7CiAgICAgICAgbGV0IG5vZG9zQ3VycmVudE5pdmVsID0gdGhpcy50b2Rvc05vZG9zLmZpbHRlcigobikgPT4KICAgICAgICAgIGlkTm9kb3NDdXJyZW50Tml2ZWwuaW5jbHVkZXMobi5pZCkKICAgICAgICApOwogICAgICAgIHZhciByZXF1ZXJpbWVudG9zID0gW107CiAgICAgICAgbm9kb3NDdXJyZW50Tml2ZWwuZm9yRWFjaCgoY3VycmVudE5vZG8pID0+IHsKICAgICAgICAgIGN1cnJlbnROb2RvLnZpbmN1bG9zCiAgICAgICAgICAgIC5maWx0ZXIoKHYpID0+IHYudGlwbyA9PT0gInJlcXVpZXJlIikKICAgICAgICAgICAgLm1hcCgodikgPT4gdi5pZFJlZikKICAgICAgICAgICAgLmZvckVhY2goKGlkVikgPT4gewogICAgICAgICAgICAgIGxldCBpbmRleFYgPSByZXF1ZXJpbWVudG9zLmluZGV4T2YoaWRWKTsKICAgICAgICAgICAgICBpZiAoaW5kZXhWID09PSAtMSkgewogICAgICAgICAgICAgICAgcmVxdWVyaW1lbnRvcy5wdXNoKGlkVik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICBub2Rvc0Rlc2NlbmRpZW50ZXMgPSBub2Rvc0Rlc2NlbmRpZW50ZXMuY29uY2F0KHJlcXVlcmltZW50b3MpOwogICAgICAgIGlkTm9kb3NDdXJyZW50Tml2ZWwgPSByZXF1ZXJpbWVudG9zOwogICAgICB9CiAgICAgIHJldHVybiBub2Rvc0Rlc2NlbmRpZW50ZXM7CiAgICB9LCAgIAogICAgdXN1YXJpb1Jlc3BvbnNhYmxlQW1wbGlvTm9kb1Jvb3QoKXsKICAgICAgaWYgKCF0aGlzLnVzdWFyaW9Mb2dlYWRvIHx8ICF0aGlzLnVzdWFyaW8gfHwgIXRoaXMudXN1YXJpby5pZCB8fCAhdGhpcy5ub2RvUm9vdCkKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiAoCiAgICAgICAgdGhpcy5ub2RvUm9vdC5yZXNwb25zYWJsZXNBbXBsaW8gJiYKICAgICAgICB0aGlzLm5vZG9Sb290LnJlc3BvbnNhYmxlc0FtcGxpby5pbmNsdWRlcyh0aGlzLnVzdWFyaW8uaWQpCiAgICAgICk7CiAgICB9CiAgfSwKICB3YXRjaDp7CiAgICBub2RvUm9vdCgpewogICAgICBpZih0aGlzLm5vZG9Sb290KXsKICAgICAgICB2YXIgbnVldm9JbmZvPXsKICAgICAgICAgIGlkOnRoaXMubm9kb1Jvb3QuaWQsCiAgICAgICAgICB0aXBvOiB0aGlzLm5vZG9Sb290Ll9fdHlwZW5hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkrIHRoaXMubm9kb1Jvb3QuX190eXBlbmFtZS5zbGljZSgxKQogICAgICAgIH0KICAgICAgICB0aGlzLmluZm9Ob2Rvc0V2ZXJSZW5kZXJlZC5wdXNoKG51ZXZvSW5mbykKICAgICAgfQogICAgfQogIH0KICAKfTsK"},{"version":3,"sources":["ventanaLista.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"ventanaLista.vue","sourceRoot":"src/components/atlasSolidaridad/ventanaLista","sourcesContent":["<template>\n  <div\n    class=\"ventanaLista\"\n    @mouseup.stop=\"\"\n    @mousedown.stop=\"\"\n    @touchmove.stop=\"\"\n    @touchstart.stop=\"\"\n    @touchend.stop=\"\"\n  >\n    <div id=\"barraSuperior\">\n      <buscador-nodos :listaIdsNodosRelevantes=\"nodosSolidaridad.map(n=>n.id)\"/>\n      <div id=\"bloqueBotonesControl\">\n        <div id=\"zonaVerNodos\" class=\"zonaControl\">\n          <div\n            class=\"botonVerNodos\"\n            @click=\"verCompletados = !verCompletados\"\n            id=\"botonVerCompletados\"\n            :title=\"\n              verCompletados\n                ? 'Ocultar nodos completados'\n                : 'Mostrar nodos completados'\n            \"\n            :style=\"{\n              borderColor: verCompletados ? '#858585' : 'transparent',\n              opacity: verCompletados ? 1 : 0.3,\n            }\"\n          ></div>\n        </div>\n        <img\n          src=\"@/assets/iconos/equis.svg\"\n          alt=\"cerrar\"\n          title=\"Cerrar ventana de lista\"\n          id=\"botonCerrar\"\n          v-if=\"cerrable\"\n          @click.stop=\"$emit('cerrarme')\"\n        />\n      </div>\n    </div>\n    <loading v-show=\"$apollo.queries.nodoRoot.loading || idsNodosNeedingFetchMore.includes(idNodoRoot)\"/>\n    <lista-nodos\n      :todosNodos=\"nodosSolidaridad\"\n      class=\"lista\"\n      ref=\"listaNodos\"\n      :idNodoSeleccionado=\"idNodoSeleccionado\"\n      :verCompletados=\"verCompletados\"\n      :modoLista=\"modoLista\"\n      :idNodoRoot=\"idNodoRoot\"\n      :tipoNodoRoot=\"tipoNodoRoot\"\n      :nodoRoot=\"nodoRoot\"\n      :idsNodosNeedingFetchMore=\"idsNodosNeedingFetchMore\"\n      :indiceNodosUnder=\"indiceNodosUnder\"\n      :usuarioResponsableAmplioNodoRoot=\"usuarioResponsableAmplioNodoRoot\"\n      @nodoSeleccionado=\"idNodoSeleccionado = $event\"\n      @click.native.self=\"idNodoSeleccionado = null\"\n      @nodosRenderizados=\"updateInfoNodosEverRendered\"\n      @nodoEliminado=\"removeNodoFromNodosSolidaridad($event)\"\n      @nodoSolidaridadCreado=\"addNodoToNodosSolidaridad($event)\"\n    />\n  </div>\n</template>\n\n<script>\nimport Loading from '../../utilidades/Loading.vue';\nimport { MixinAtlasSolidaridad } from '../MixinAtlasSolidaridad';\nimport BuscadorNodos from \"./BuscadorNodos.vue\";\nimport ListaNodos from \"./ListaNodos.vue\";\n\nexport default {\n  components: { ListaNodos, BuscadorNodos, Loading },\n  name: \"VentanaLista\",\n  props: {    \n    idNodoRoot: String,\n    tipoNodoRoot:String,\n    cerrable: Boolean,        \n  },  \n  mixins:[MixinAtlasSolidaridad],  \n  data() {\n    return {\n      idNodoSeleccionado: null,\n      listaSeleccionada: null,\n      verCompletados: true,\n      modoLista: \"todo\",      \n    };\n  },\n  methods: {\n    desplegarCascadaHaciaNodo(idNodo) {\n      this.$refs.listaNodos.desplegarCascadaHaciaNodo(idNodo);\n    },\n    \n    updateInfoNodosEverRendered(idsNodosRendered){\n      const nuevos=idsNodosRendered.filter(id=>!this.infoNodosEverRendered.map(ner=>ner.id).includes(id));\n      const nuevosInfos=nuevos.map(id=>{return {id, tipo:'nodoSolidaridad'}})\n      this.infoNodosEverRendered.push(...nuevosInfos)\n    },       \n  },\n  computed: {\n    nodoSeleccionado() {\n      if (!this.idNodoSeleccionado) return null;\n      return this.todosNodos.find((n) => n.id === this.idNodoSeleccionado);\n    },\n    descendientesNodoSeleccionado() {\n      if (!this.nodoSeleccionado) return null;\n      const maxNesting = 5;\n      var nesting = 0;\n      var idNodosCurrentNivel = [this.nodoSeleccionado.id];\n      var nodosDescendientes = [];\n      while (idNodosCurrentNivel.length > 0 && nesting < maxNesting) {\n        console.log(`Descendientes`);\n        nesting++;\n        let nodosCurrentNivel = this.todosNodos.filter((n) =>\n          idNodosCurrentNivel.includes(n.id)\n        );\n        var requerimentos = [];\n        nodosCurrentNivel.forEach((currentNodo) => {\n          currentNodo.vinculos\n            .filter((v) => v.tipo === \"requiere\")\n            .map((v) => v.idRef)\n            .forEach((idV) => {\n              let indexV = requerimentos.indexOf(idV);\n              if (indexV === -1) {\n                requerimentos.push(idV);\n              }\n            });\n        });\n        nodosDescendientes = nodosDescendientes.concat(requerimentos);\n        idNodosCurrentNivel = requerimentos;\n      }\n      return nodosDescendientes;\n    },   \n    usuarioResponsableAmplioNodoRoot(){\n      if (!this.usuarioLogeado || !this.usuario || !this.usuario.id || !this.nodoRoot)\n        return false;\n      return (\n        this.nodoRoot.responsablesAmplio &&\n        this.nodoRoot.responsablesAmplio.includes(this.usuario.id)\n      );\n    }\n  },\n  watch:{\n    nodoRoot(){\n      if(this.nodoRoot){\n        var nuevoInfo={\n          id:this.nodoRoot.id,\n          tipo: this.nodoRoot.__typename.charAt(0).toLowerCase()+ this.nodoRoot.__typename.slice(1)\n        }\n        this.infoNodosEverRendered.push(nuevoInfo)\n      }\n    }\n  }\n  \n};\n</script>\n\n<style scoped>\n.ventanaLista {\n  top: 0;\n  overflow-y: hidden;\n  z-index: 50;\n  min-height: 100px;\n  min-width: 50%;\n  max-height: 100%;\n\n  font-family: Poppins, Helvetica, Arial, sans-serif;\n  display: grid;\n  grid-template-rows: auto 1fr;\n  row-gap: 0px;\n}\n#buscadorNodos {\n  z-index: 1;\n}\n#barraSuperior {\n  display: flex;\n  padding-top: 20px;\n  box-sizing: border-box;\n  align-items:flex-start;\n  min-height: 60px;\n}\n#bloqueBotonesControl{\n  margin-left: auto;\n  margin-top: 0px;\n  display: flex;\n  align-items: center;\n}\n#botonCerrar {\n  margin-right: 15px;\n  margin-left: 5px;\n  opacity: 0.7;\n  width: 20px;\n  height: 20px;\n  cursor: pointer;\n}\n#botonCerrar:hover {\n  opacity: 1;\n}\n\n.zonaControl {\n  margin-right: 5px;\n  padding: 5px;\n  display: flex;\n  align-items: center;\n}\n\n.botonVerNodos {\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  margin: 0px 10px;\n  cursor: pointer;\n  border-style: solid;\n  border-width: 1px;\n}\n\n#botonVerCompletados {\n  background-color: var(--atlasVerde);\n}\n</style>"]}]}