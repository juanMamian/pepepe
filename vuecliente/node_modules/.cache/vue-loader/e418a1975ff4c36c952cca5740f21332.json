{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/Espacios.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/Espacios.vue","mtime":1674484905018},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgRXNwYWNpbyBmcm9tICIuL0VzcGFjaW8udnVlIjsKaW1wb3J0IExvYWRpbmcgZnJvbSAiLi91dGlsaWRhZGVzL0xvYWRpbmcudnVlIjsKaW1wb3J0IE9yZ2FuaXphZG9ySG9yYXJpb1NlbWFuYWwgZnJvbSAiLi9jYWxlbmRhcmlvL09yZ2FuaXphZG9ySG9yYXJpb1NlbWFuYWwudnVlIjsKaW1wb3J0IHsgZnJhZ21lbnRvRXNwYWNpbyB9IGZyb20gIi4vZnJhZ3MiOwoKY29uc3QgUVVFUllfRVNQQUNJT1MgPSBncWxgCiAgcXVlcnkgewogICAgdG9kb3NFc3BhY2lvcyB7CiAgICAgIC4uLmZyYWdFc3BhY2lvCiAgICB9CiAgfQogICR7ZnJhZ21lbnRvRXNwYWNpb30KYDsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IEVzcGFjaW8sIExvYWRpbmcsIE9yZ2FuaXphZG9ySG9yYXJpb1NlbWFuYWwgfSwKICBwcm9wczogewogICAgeW86IE9iamVjdCwKICB9LAogIGFwb2xsbzogewogICAgdG9kb3NFc3BhY2lvczogewogICAgICBxdWVyeTogUVVFUllfRVNQQUNJT1MsCiAgICB9LAogIH0sCiAgbmFtZTogIkVzcGFjaW9zIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdG9kb3NFc3BhY2lvczogW10sCgogICAgICB2ZXJUb2RvczogZmFsc2UsCiAgICAgIGNyZWFuZG9Fc3BhY2lvOiBmYWxzZSwKCiAgICAgIG1vc3RyYW5kb0VzcGFjaW9zOiBmYWxzZSwKICAgICAgbW9zdHJhbmRvT3JnYW5pemFkb3JTZW1hbmFsOiBmYWxzZSwKCiAgICAgIG1vc3RyYW5kb0NvbmZpZ3VyYWNpb246IGZhbHNlLAogICAgICB0aXBvTW9zdHJhckVzcGFjaW9zOiAibWlvcyIsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgY3JlYXJOdWV2b0VzcGFjaW8oKSB7CiAgICAgIHRoaXMuY3JlYW5kb0VzcGFjaW8gPSB0cnVlOwoKICAgICAgdGhpcy4kYXBvbGxvCiAgICAgICAgLm11dGF0ZSh7CiAgICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgICBtdXRhdGlvbiAoJGluZm86IElucHV0Q3JlYXJFc3BhY2lvKSB7CiAgICAgICAgICAgICAgY3JlYXJFc3BhY2lvKGluZm86ICRpbmZvKSB7CiAgICAgICAgICAgICAgICAuLi5mcmFnRXNwYWNpbwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAke2ZyYWdtZW50b0VzcGFjaW99CiAgICAgICAgICBgLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIGluZm86IHsKICAgICAgICAgICAgICBpZEFkbWluaXN0cmFkb3I6IHRoaXMudXN1YXJpby5pZCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgfSkKICAgICAgICAudGhlbigoeyBkYXRhOiB7IGNyZWFyRXNwYWNpbyB9IH0pID0+IHsKICAgICAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgICAgICBjb25zdCBjYWNoZSA9IHN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9FU1BBQ0lPUywKICAgICAgICAgIH0pOwogICAgICAgICAgY29uc3QgbnVldm9DYWNoZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKCiAgICAgICAgICBjb25zdCBpbmRleEUgPSBudWV2b0NhY2hlLnRvZG9zRXNwYWNpb3MuZmluZEluZGV4KAogICAgICAgICAgICAoZSkgPT4gZS5pZCA9PT0gY3JlYXJFc3BhY2lvLmlkCiAgICAgICAgICApOwogICAgICAgICAgaWYgKGluZGV4RSA9PT0gLTEpIHsKICAgICAgICAgICAgbnVldm9DYWNoZS50b2Rvc0VzcGFjaW9zLnB1c2goY3JlYXJFc3BhY2lvKTsKICAgICAgICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgICAgICAgcXVlcnk6IFFVRVJZX0VTUEFDSU9TLAogICAgICAgICAgICAgIGRhdGE6IG51ZXZvQ2FjaGUsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYEVsIGVzcGFjaW8geWEgZXN0YWJhIGVuIGNhY2jDqWApOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5jcmVhbmRvRXNwYWNpbyA9IGZhbHNlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApOwogICAgICAgICAgdGhpcy5jcmVhbmRvRXNwYWNpbyA9IGZhbHNlOwogICAgICAgIH0pOwogICAgfSwKICAgIGVsaW1pbmFyRXNwYWNpb0NhY2hlKGlkRXNwYWNpbykgewogICAgICBjb25zdCBzdG9yZSA9IHRoaXMuJGFwb2xsby5wcm92aWRlci5kZWZhdWx0Q2xpZW50OwogICAgICBjb25zdCBjYWNoZSA9IHN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0VTUEFDSU9TLAogICAgICB9KTsKICAgICAgdmFyIG51ZXZvQ2FjaGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7CiAgICAgIGNvbnN0IGluZGV4RSA9IG51ZXZvQ2FjaGUudG9kb3NFc3BhY2lvcy5maW5kSW5kZXgoCiAgICAgICAgKGUpID0+IGUuaWQgPT09IGlkRXNwYWNpbwogICAgICApOwogICAgICBpZiAoaW5kZXhFID4gLTEpIHsKICAgICAgICBudWV2b0NhY2hlLnRvZG9zRXNwYWNpb3Muc3BsaWNlKGluZGV4RSwgMSk7CiAgICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgICBxdWVyeTogUVVFUllfRVNQQUNJT1MsCiAgICAgICAgICBkYXRhOiBudWV2b0NhY2hlLAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgbWFuZWphckNyZWFjaW9uRXZlbnRvcyhldmVudG9zKSB7CiAgICAgIGNvbnNvbGUubG9nKAogICAgICAgIGBNYW5lamFuZG8gbGEgcmVwZXRpY2lvbiBkZSBsb3MgZXZlbnRvcyBkZSB1biBlc3BhY2lvIGNvbiBpZCAke2V2ZW50b3NbMF0uaWRQYXJlbnR9YAogICAgICApOwogICAgfSwKICAgIGhhbmRsZUNhbWJpb0ZlY2hhRXZlbnRvKCkgewogICAgICBjb25zb2xlLmxvZyhgSGFuZGxpbmdgKTsKICAgIH0sCiAgfSwKICBjb21wdXRlZDogewogICAgdXN1YXJpb1Byb2ZlKCkgewogICAgICBpZiAoIXRoaXMudXN1YXJpb0xvZ2VhZG8pIHJldHVybiBmYWxzZTsKCiAgICAgIHJldHVybiB0aGlzLnVzdWFyaW8ucGVybWlzb3MuaW5jbHVkZXMoIm1hZXN0cmFWaWRhLXByb2Zlc29yIik7CiAgICB9LAogICAgZXNwYWNpb3NWaXNpYmxlcygpIHsKICAgICAgaWYgKHRoaXMudGlwb01vc3RyYXJFc3BhY2lvcz09PSd0b2RvcycpCiAgICAgICAgcmV0dXJuIHRoaXMuZXNwYWNpb3NVc3VhcmlvLmNvbmNhdCh0aGlzLmVzcGFjaW9zTm9Vc3VhcmlvKTsKICAgICAgcmV0dXJuIHRoaXMuZXNwYWNpb3NVc3VhcmlvOwogICAgfSwKICAgIGVzcGFjaW9zVXN1YXJpbygpIHsKICAgICAgaWYgKCF0aGlzLnVzdWFyaW9Mb2dlYWRvKSByZXR1cm4gW107CiAgICAgIHJldHVybiB0aGlzLnRvZG9zRXNwYWNpb3MuZmlsdGVyKAogICAgICAgIChlKSA9PiBlLmlkQWRtaW5pc3RyYWRvciA9PT0gdGhpcy51c3VhcmlvLmlkCiAgICAgICk7CiAgICB9LAogICAgZXNwYWNpb3NOb1VzdWFyaW8oKSB7CiAgICAgIGlmICghdGhpcy51c3VhcmlvTG9nZWFkbykgcmV0dXJuIHRoaXMudG9kb3NFc3BhY2lvczsKICAgICAgcmV0dXJuIHRoaXMudG9kb3NFc3BhY2lvcy5maWx0ZXIoCiAgICAgICAgKGUpID0+IGUuaWRBZG1pbmlzdHJhZG9yICE9IHRoaXMudXN1YXJpby5pZAogICAgICApOwogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICBtb3N0cmFuZG9Pcmdhbml6YWRvclNlbWFuYWwobW9zdHJhbmRvKSB7CiAgICAgIGlmIChtb3N0cmFuZG8pIHsKICAgICAgICB0aGlzLiRyZWZzLm9yZ2FuaXphZG9yU2VtYW5hbC4kYXBvbGxvLnF1ZXJpZXMuZXNwYWNpb3MucmVmZXRjaCgpOwogICAgICB9CiAgICB9LAogIH0sCiAgYmVmb3JlUm91dGVMZWF2ZSh0bywgZnJvbSwgbmV4dCkgewogICAgaWYgKHRoaXMuJHJlZnMub3JnYW5pemFkb3JTZW1hbmFsLmNoZWNrVmVudGFuYUJsb3F1ZSgpKSB7CiAgICAgIGNvbnNvbGUubG9nKCJIYWLDrWEgYmxvcXVlIGVuIHZlbnRhbmEiKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIG5leHQoKTsKICB9LAp9Owo="},{"version":3,"sources":["Espacios.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Espacios.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"espacios\">\n    <router-view\n      id=\"visorVentanaEventoPublico\"\n      @meRepetiPeriodicamente=\"manejarCreacionEventos\"\n      @eventoCambioFecha=\"manejarCreacionEventos([$event])\"\n    >\n    </router-view>\n    \n\n    <div class=\"barraSeccion\" @click=\"mostrandoEspacios = !mostrandoEspacios\">\n      <img\n        src=\"@/assets/iconos/angleDown.svg\"\n        style=\"height: 20px\"\n        alt=\"Abrir\"\n        :style=\"[{ transform: mostrandoEspacios ? 'none' : 'rotate(-90deg)' }]\"\n      />\n      Espacios\n\n      <div class=\"contenedorControles\" v-show=\"mostrandoEspacios\" @click.stop=\"\" style=\"margin-left: auto\">\n        <div\n          class=\"boton\"\n          @click=\"mostrandoConfiguracion = !mostrandoConfiguracion\"\n        >\n          <img src=\"@/assets/iconos/cog.svg\" alt=\"Config\" style=\"\" />\n        </div>\n        <div\n          class=\"boton\"\n          @click.stop=\"crearNuevoEspacio\"\n          v-show=\"mostrandoEspacios && !creandoEspacio\"\n        >\n          <img src=\"@/assets/iconos/plusCircle.svg\" alt=\"Crear\" style=\"\" />\n        </div>\n        <loading texto=\"\" v-show=\"creandoEspacio\" />\n      </div>\n    </div>\n\n    <div class=\"zonaConfiguracion\" v-show=\"mostrandoConfiguracion && mostrandoEspacios\">\n      <div class=\"barraSeccion\">\n        Configuración\n      </div>\n      <div class=\"contenedorBloquesConfiguracion\">\n        <div class=\"bloqueConfiguracion\">\n          <div class=\"campoConfiguracion\">\n            Mostrar: \n            <label for=\"checkMostrarTodosEspacios\"\n              >Mis espacios</label\n            >\n            <input\n              type=\"radio\"\n              name=\"checkMostrarTodosEspacios\"\n              id=\"checkMostrarTodosEspacios\"\n              ref=\"checkMostrarTodosEspacios\"\n              value=\"mios\"\n              v-model=\"tipoMostrarEspacios\"\n            />\n\n            <label for=\"checkMostrarTodosEspacios\"\n              >Todos los espacios</label\n            >\n            <input\n              type=\"radio\"\n              name=\"checkMostrarTodosEspacios\"\n              id=\"checkMostrarTodosEspacios\"\n              ref=\"checkMostrarTodosEspacios\"\n              value=\"todos\"\n              v-model=\"tipoMostrarEspacios\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div id=\"listaEspacios\" v-show=\"mostrandoEspacios\">\n      <div\n        class=\"anuncioZonaVacia\"\n        v-if=\"!espaciosVisibles || espaciosVisibles.length < 1\"\n      >\n        Aún no hay espacios\n      </div>\n      <espacio\n        v-for=\"espacio of espaciosVisibles\"\n        ref=\"espacios\"\n        :key=\"espacio.id\"\n        :esteEspacio=\"espacio\"\n        @meElimine=\"eliminarEspacioCache(espacio.id)\"\n      />\n    </div>\n\n    <div\n      class=\"barraSeccion\"\n      @click=\"mostrandoOrganizadorSemanal = !mostrandoOrganizadorSemanal\"\n    >\n      <img\n        src=\"@/assets/iconos/angleDown.svg\"\n        style=\"height: 20px\"\n        alt=\"Abrir\"\n        :style=\"[\n          {\n            transform: mostrandoOrganizadorSemanal ? 'none' : 'rotate(-90deg)',\n          },\n        ]\"\n      />\n      Calendario semanal\n    </div>\n\n    <organizador-horario-semanal\n      v-show=\"mostrandoOrganizadorSemanal\"\n      ref=\"organizadorSemanal\"\n      :yo=\"yo\"\n    />\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport Espacio from \"./Espacio.vue\";\nimport Loading from \"./utilidades/Loading.vue\";\nimport OrganizadorHorarioSemanal from \"./calendario/OrganizadorHorarioSemanal.vue\";\nimport { fragmentoEspacio } from \"./frags\";\n\nconst QUERY_ESPACIOS = gql`\n  query {\n    todosEspacios {\n      ...fragEspacio\n    }\n  }\n  ${fragmentoEspacio}\n`;\n\nexport default {\n  components: { Espacio, Loading, OrganizadorHorarioSemanal },\n  props: {\n    yo: Object,\n  },\n  apollo: {\n    todosEspacios: {\n      query: QUERY_ESPACIOS,\n    },\n  },\n  name: \"Espacios\",\n  data() {\n    return {\n      todosEspacios: [],\n\n      verTodos: false,\n      creandoEspacio: false,\n\n      mostrandoEspacios: false,\n      mostrandoOrganizadorSemanal: false,\n\n      mostrandoConfiguracion: false,\n      tipoMostrarEspacios: \"mios\",\n    };\n  },\n  methods: {\n    crearNuevoEspacio() {\n      this.creandoEspacio = true;\n\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($info: InputCrearEspacio) {\n              crearEspacio(info: $info) {\n                ...fragEspacio\n              }\n            }\n            ${fragmentoEspacio}\n          `,\n          variables: {\n            info: {\n              idAdministrador: this.usuario.id,\n            },\n          },\n        })\n        .then(({ data: { crearEspacio } }) => {\n          const store = this.$apollo.provider.defaultClient;\n          const cache = store.readQuery({\n            query: QUERY_ESPACIOS,\n          });\n          const nuevoCache = JSON.parse(JSON.stringify(cache));\n\n          const indexE = nuevoCache.todosEspacios.findIndex(\n            (e) => e.id === crearEspacio.id\n          );\n          if (indexE === -1) {\n            nuevoCache.todosEspacios.push(crearEspacio);\n            store.writeQuery({\n              query: QUERY_ESPACIOS,\n              data: nuevoCache,\n            });\n          } else {\n            console.log(`El espacio ya estaba en caché`);\n          }\n          this.creandoEspacio = false;\n        })\n        .catch((error) => {\n          console.log(`Error: ${error}`);\n          this.creandoEspacio = false;\n        });\n    },\n    eliminarEspacioCache(idEspacio) {\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_ESPACIOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      const indexE = nuevoCache.todosEspacios.findIndex(\n        (e) => e.id === idEspacio\n      );\n      if (indexE > -1) {\n        nuevoCache.todosEspacios.splice(indexE, 1);\n        store.writeQuery({\n          query: QUERY_ESPACIOS,\n          data: nuevoCache,\n        });\n      }\n    },\n    manejarCreacionEventos(eventos) {\n      console.log(\n        `Manejando la repeticion de los eventos de un espacio con id ${eventos[0].idParent}`\n      );\n    },\n    handleCambioFechaEvento() {\n      console.log(`Handling`);\n    },\n  },\n  computed: {\n    usuarioProfe() {\n      if (!this.usuarioLogeado) return false;\n\n      return this.usuario.permisos.includes(\"maestraVida-profesor\");\n    },\n    espaciosVisibles() {\n      if (this.tipoMostrarEspacios==='todos')\n        return this.espaciosUsuario.concat(this.espaciosNoUsuario);\n      return this.espaciosUsuario;\n    },\n    espaciosUsuario() {\n      if (!this.usuarioLogeado) return [];\n      return this.todosEspacios.filter(\n        (e) => e.idAdministrador === this.usuario.id\n      );\n    },\n    espaciosNoUsuario() {\n      if (!this.usuarioLogeado) return this.todosEspacios;\n      return this.todosEspacios.filter(\n        (e) => e.idAdministrador != this.usuario.id\n      );\n    },\n  },\n  watch: {\n    mostrandoOrganizadorSemanal(mostrando) {\n      if (mostrando) {\n        this.$refs.organizadorSemanal.$apollo.queries.espacios.refetch();\n      }\n    },\n  },\n  beforeRouteLeave(to, from, next) {\n    if (this.$refs.organizadorSemanal.checkVentanaBloque()) {\n      console.log(\"Había bloque en ventana\");\n      return;\n    }\n\n    next();\n  },\n};\n</script>\n\n<style scoped>\n#barraControles {\n  display: flex;\n  flex-direction: row-reverse;\n  padding: 10px 20px;\n}\n\n.botonControl {\n  width: 20px;\n  height: 20px;\n}\n#listaEspacios {\n  margin: 20px;\n  width: min(600px, 95vw);\n  margin-bottom: 100px;\n}\n.espacio {\n  margin: 10px 0px;\n}\n.espacio:hover {\n  background-color: var(--grisHover);\n}\n</style>"]}]}