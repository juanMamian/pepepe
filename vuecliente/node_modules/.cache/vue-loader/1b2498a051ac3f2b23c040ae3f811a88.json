{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/proyecto/NodoTrabajo.vue?vue&type=style&index=0&id=67e287a1&scoped=true&lang=css&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/proyecto/NodoTrabajo.vue","mtime":1643654906679},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5ub2RvVHJhYmFqbyB7CiAgCiAgcG9zaXRpb246IGFic29sdXRlOwogIGJvcmRlci1yYWRpdXM6IDVweDsKICBib3JkZXI6IDFweCBzb2xpZCByZ2IoMCwgOTQsIDk0KTsgIAogIGJhY2tncm91bmQtY29sb3I6IHJnYigyMzAsIDI0NywgMjQ3KTsKICBjdXJzb3I6IHBvaW50ZXI7CiAgCn0KLnNlbGVjY2lvbmFkbyB7CiAgYm9yZGVyLXdpZHRoOiAycHg7CiAgYm9yZGVyLWNvbG9yOiBwdXJwbGU7Cn0KI25vbWJyZSB7ICAKICB1c2VyLXNlbGVjdDogbm9uZTsKICAKfQouaWNvbm9UcmFiYWpvIHsKIAogIGJvcmRlci1yYWRpdXM6IDUwJTsKICBwYWRkaW5nOiAzcHg7Cn0KLmljb25vQ29tcGxldGFkbyB7CiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDQ0LCAxMzYsIDQ0KTsKfQojbWVudUNvbnRleHR1YWwgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDExMCU7CiAgbGVmdDogMTEwJTsKICBtaW4td2lkdGg6IDE0MHB4OwogIHotaW5kZXg6IDEwOwogIGJhY2tncm91bmQtY29sb3I6IHJnYigxNzcsIDE3NywgMTU5KTsKICBib3gtc2hhZG93OiAwIDJweCAycHggMCByZ2JhKDAsIDAsIDAsIDAuMTQpLCAwIDNweCAxcHggLTJweCByZ2JhKDAsIDAsIDAsIDAuMiksCiAgICAwIDFweCA1cHggMCByZ2JhKDAsIDAsIDAsIDAuMTIpOwp9Ci5ib3Rvbk1lbnVDeCB7CiAgY3Vyc29yOiBwb2ludGVyOwogIGZvbnQtc2l6ZTogMTRweDsKICBwYWRkaW5nOiA1cHggMTBweDsKfQouc2VjY2lvbk1lbnVDeCB7CiAgZm9udC1zaXplOiAxNXB4OwogIGNvbG9yOiByZ2IoNzEsIDcxLCA3MSk7CiAgcGFkZGluZzogNXB4IDEwcHg7Cn0KLmJvdG9uTWVudUN4OmhvdmVyIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiBncmF5Owp9Ci5iQWJyaXJOb2RvIHsKICBwYWRkaW5nOiAzcHg7CiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDE2OCwgMjIxLCAyMjMpOwogIGJvcmRlci1yYWRpdXM6IDUwJTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiA1MCU7CiAgbGVmdDogMTA1JTsKICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7CiAgY3Vyc29yOiBwb2ludGVyOwogIHdpZHRoOiAyNXB4OwogIGhlaWdodDogMjVweDsKfQouYkFicmlyTm9kbzpob3ZlciB7CiAgYmFja2dyb3VuZC1jb2xvcjogY2FkZXRibHVlOwp9Cg=="},{"version":3,"sources":["NodoTrabajo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgQA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"NodoTrabajo.vue","sourceRoot":"src/components/proyecto","sourcesContent":["<template>\n  <div\n    class=\"nodoTrabajo\"\n    :class=\"{ seleccionado }\"\n    :style=\"[estiloPosicion, estiloZeta, estiloSize]\"\n    @mousedown.left=\"agarrado = true\"\n    @mouseup.left=\"guardarPosicion\"\n    @mousemove=\"arrastrarNodo\"\n  >\n    <img\n      src=\"@/assets/iconos/maximizar.png\"\n      alt=\"abrir\"\n      class=\"bAbrirNodo\"\n      title=\"Ampliar información\"\n      v-show=\"seleccionado\"\n      @click.left.stop=\"$emit('meAbrieron')\"\n    />\n\n    <div class=\"zonaNombre\">\n      <div id=\"nombre\">\n        <img\n          src=\"@/assets/iconos/iconoTrabajo.png\"\n          alt=\"\"\n          class=\"iconoTrabajo\"\n          draggable=\"false\"\n          :style=\"{width: Math.round(17*factorZoom)+'px'}\"\n          :class=\"{\n            iconoCompletado: esteTrabajo.estadoDesarrollo === 'completado',\n          }\"\n        />\n        {{ esteTrabajo.nombre }}\n      </div>\n    </div>\n\n    <div id=\"menuContextual\" v-show=\"menuCx\">\n      <template\n        v-if=\"\n          idNodoSeleccionado != null &&\n          idNodoSeleccionado != esteTrabajo.id &&\n          (usuarioSuperadministrador == true || usuarioResponsableProyecto)\n        \"\n      >\n        <div class=\"seccionMenuCx\">El elemento seleccionado...</div>\n        <div\n          class=\"botonMenuCx\"\n          @click.stop=\"crearRequerimento(idNodoSeleccionado, esteTrabajo.id)\"\n        >\n          Requiere este elemento\n        </div>\n        <div\n          class=\"botonMenuCx\"\n          @click.stop=\"eliminarVinculo(idNodoSeleccionado, esteTrabajo.id)\"\n        >\n          Desconectar\n        </div>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\n\nexport default {\n  name: \"NodoTrabajo\",  \n  data() {\n    return {     \n      agarrado: false,\n      arrastrandoNodo: 0,\n      umbralArrastreNodo: 10,\n      posicion: {\n        x: 0,\n        y: 0,\n      },\n      montado: false,\n\n      widthBase:150,\n      heightBase:100,\n    };\n  },\n  props: {\n    esteTrabajo: Object,\n    idProyecto: String,\n    idNodoSeleccionado: String,\n    usuarioResponsableProyecto: Boolean,\n    seleccionado: Boolean,\n    posDummy: Object,\n    menuCx: Boolean,\n    centroVista:Object,\n    factorZoom:Number,\n  },\n  methods: {\n    arrastrarNodo(e) {\n      if (\n        !this.agarrado ||\n        (this.usuarioResponsableProyecto === false &&\n          this.usuarioSuperadministrador === false)\n      ) {\n        return;\n      }\n      this.arrastrandoNodo =\n        this.arrastrandoNodo + Math.abs(e.movementX) + Math.abs(e.movementY);\n      if (this.arrastrandoNodo < this.umbralArrastreNodo) {\n        return;\n      }\n      var contenedor = this.$parent.$el;\n      let posContenedor = contenedor.getBoundingClientRect();\n      let nuevoTop = Math.round(\n        ((e.clientY - posContenedor.top)/this.factorZoom)+this.centroVista.y\n      );\n      let nuevoLeft = Math.round(\n        ((e.clientX - posContenedor.left)/this.factorZoom)+this.centroVista.x\n      );\n\n      const stepPosx = 25;\n      const stepPosy = 15;      \n\n      nuevoLeft = nuevoLeft-(nuevoLeft%stepPosx);\n      nuevoTop = nuevoTop - (nuevoTop%stepPosy);\n\n\n      this.$set(this.posicion, \"x\", nuevoLeft);\n      this.$set(this.posicion, \"y\", nuevoTop);\n\n     \n    },\n    guardarPosicion() {\n      if (this.arrastrandoNodo < this.umbralArrastreNodo) {\n        this.agarrado = false;\n        return;\n      }\n      this.arrastrandoNodo = 0;\n      this.agarrado = false;\n\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation(\n              $idTrabajo: ID!\n              $idProyecto: ID!\n              $nuevaPosicion: CoordsInput\n            ) {\n              setPosicionTrabajoProyecto(\n                idProyecto: $idProyecto\n                idTrabajo: $idTrabajo\n                nuevaPosicion: $nuevaPosicion\n              ) {\n                id\n                coords {                  \n                  x\n                  y                  \n                }\n              }\n            }\n          `,\n          variables: {\n            idProyecto: this.idProyecto,\n            idTrabajo: this.esteTrabajo.id,\n            nuevaPosicion: this.posicion,\n          },\n        })\n        .then(() => {\n          console.log(`Posición guardada`);\n          this.emitirMiInfo();\n        })\n        .catch((error) => {\n          console.log(`Error. E: ${error}`);\n        });\n    },\n    emitirMiInfo() {\n      var info = {\n        id: this.esteTrabajo.id,\n        posicion: this.esteTrabajo.coords,\n        vinculos: this.esteTrabajo.vinculos,\n      };\n      this.$emit(\"miInfo\", info);\n    },\n    crearRequerimento(idNodoRequiere, idNodoRequerido) {\n      console.log(\n        `Se fijara que ${idNodoRequiere} requiere a ${idNodoRequerido}`\n      );\n      this.$emit(\"crearRequerimento\", { idNodoRequiere, idNodoRequerido });\n    },\n    eliminarVinculo(idNodoRequiere, idNodoRequerido) {\n      console.log(\n        `Se fijara que ${idNodoRequiere} ya no requiere a ${idNodoRequerido}`\n      );\n      this.$emit(\"eliminarVinculo\", { idNodoRequiere, idNodoRequerido });\n    },\n  },\n  computed: {\n    estiloPosicion() {\n      if (this.montado) {\n        return {\n          top: ((this.posicion.y -this.centroVista.y)*this.factorZoom) - this.$el.offsetHeight / 2 + \"px\",\n          left: ((this.posicion.x - this.centroVista.x)*this.factorZoom) - this.$el.offsetWidth / 2 + \"px\",\n        };\n      }\n      return {\n        top: \"0px\",\n        left: \"0px\",\n      };\n    },\n    estiloZeta() {\n      let valorZ = 0;\n\n      if (this.arrastrandoNodo == true || this.seleccionado == true) {\n        valorZ = 100;\n      }\n      if (this.menuCx) {\n        valorZ = 200;\n      }\n      return {\n        zIndex: valorZ,\n      };\n    },\n    estiloSize(){\n      return {\n        width: Math.round(this.widthBase*(this.factorZoom))+\"px\",\n        height: Math.round(this.heightBase*(this.factorZoom))+\"px\",\n        fontSize:Math.round(14*this.factorZoom)+\"px\",\n        padding:Math.round(5*this.factorZoom)+'px'\n      }\n    }\n  },\n  watch: {\n    esteTrabajo() {\n      this.$set(\n        this.posicion,\n        \"x\",\n        this.esteTrabajo.coords.x\n      );\n      this.$set(\n        this.posicion,\n        \"y\",\n        this.esteTrabajo.coords.y\n      );\n    },\n  },\n  mounted() {\n    this.montado = true;\n    this.$set(\n        this.posicion,\n        \"x\",\n        this.esteTrabajo.coords.x\n      );\n      this.$set(\n        this.posicion,\n        \"y\",\n        this.esteTrabajo.coords.y\n      );\n  },\n};\n</script>\n\n<style scoped>\n.nodoTrabajo {\n  \n  position: absolute;\n  border-radius: 5px;\n  border: 1px solid rgb(0, 94, 94);  \n  background-color: rgb(230, 247, 247);\n  cursor: pointer;\n  \n}\n.seleccionado {\n  border-width: 2px;\n  border-color: purple;\n}\n#nombre {  \n  user-select: none;\n  \n}\n.iconoTrabajo {\n \n  border-radius: 50%;\n  padding: 3px;\n}\n.iconoCompletado {\n  background-color: rgb(44, 136, 44);\n}\n#menuContextual {\n  position: absolute;\n  top: 110%;\n  left: 110%;\n  min-width: 140px;\n  z-index: 10;\n  background-color: rgb(177, 177, 159);\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n.botonMenuCx {\n  cursor: pointer;\n  font-size: 14px;\n  padding: 5px 10px;\n}\n.seccionMenuCx {\n  font-size: 15px;\n  color: rgb(71, 71, 71);\n  padding: 5px 10px;\n}\n.botonMenuCx:hover {\n  background-color: gray;\n}\n.bAbrirNodo {\n  padding: 3px;\n  background-color: rgb(168, 221, 223);\n  border-radius: 50%;\n  position: absolute;\n  top: 50%;\n  left: 105%;\n  transform: translateY(-50%);\n  cursor: pointer;\n  width: 25px;\n  height: 25px;\n}\n.bAbrirNodo:hover {\n  background-color: cadetblue;\n}\n</style>"]}]}