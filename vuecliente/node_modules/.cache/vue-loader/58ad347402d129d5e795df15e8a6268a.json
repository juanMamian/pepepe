{"remainingRequest":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vida1/webpj/pepepe/vuecliente/src/components/atlasConocimiento/AtlasConocimiento.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vida1/webpj/pepepe/vuecliente/src/components/atlasConocimiento/AtlasConocimiento.vue","mtime":1650228128900},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vida1/webpj/pepepe/vuecliente/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgTm9kb0Nvbm9jaW1pZW50byBmcm9tICIuL05vZG9Db25vY2ltaWVudG8udnVlIjsKaW1wb3J0IEJ1c2NhZG9yTm9kb3NDb25vY2ltaWVudG8gZnJvbSAiLi9CdXNjYWRvck5vZG9zQ29ub2NpbWllbnRvLnZ1ZSI7CmltcG9ydCBMb2FkaW5nIGZyb20gIi4uL3V0aWxpZGFkZXMvTG9hZGluZy52dWUiOwppbXBvcnQgUGFuZWxDb25qdW50b3NOb2RvcyBmcm9tICIuL1BhbmVsQ29uanVudG9zTm9kb3MudnVlIjsKaW1wb3J0IEVubGFjZXNOb2RvQ29ub2NpbWllbnRvIGZyb20gIi4vRW5sYWNlc05vZG9Db25vY2ltaWVudG8udnVlIjsKaW1wb3J0IHsgZnJhZ21lbnRvRGF0b05vZG9Db25vY2ltaWVudG8gfSBmcm9tICIuL2ZyYWdzQXRsYXNDb25vY2ltaWVudG8iOwpjb25zdCBkZWJvdW5jZSA9IHJlcXVpcmUoImRlYm91bmNlIik7Cgpjb25zdCBmcmFnbWVudG9Ob2RvQ29ub2NpbWllbnRvID0gZ3FsYAogIGZyYWdtZW50IGZyYWdOb2RvQ29ub2NpbWllbnRvIG9uIE5vZG9Db25vY2ltaWVudG8gewogICAgaWQKICAgIG5vbWJyZQogICAgZGVzY3JpcGNpb24KICAgIGV4cGVydG9zCiAgICBjbGFzZXMgewogICAgICBpZAogICAgICBub21icmUKICAgICAgaWRFeHBlcnRvCiAgICAgIGludGVyZXNhZG9zCiAgICB9CiAgICBjb29yZHNNYW51YWxlcyB7CiAgICAgIHgKICAgICAgeQogICAgfQogICAgY29vcmRzIHsKICAgICAgeAogICAgICB5CiAgICB9CiAgICBhdXRvQ29vcmRzIHsKICAgICAgeAogICAgICB5CiAgICB9CiAgICBjZW50cm9NYXNhIHsKICAgICAgeAogICAgICB5CiAgICB9CiAgICBzdHVjawogICAgYW5ndWxvCiAgICBwdW50YWplCiAgICB2aW5jdWxvcyB7CiAgICAgIGlkCiAgICAgIGlkUmVmCiAgICAgIHJvbAogICAgICB0aXBvCiAgICB9CiAgICBmdWVyemFDZW50cm9NYXNhIHsKICAgICAgZnVlcnphCiAgICAgIGRpcmVjY2lvbgogICAgfQogICAgZnVlcnphQ29saXNpb24gewogICAgICBmdWVyemEKICAgICAgZGlyZWNjaW9uCiAgICB9CiAgfQpgOwoKY29uc3QgUVVFUllfTk9ET1MgPSBncWxgCiAgcXVlcnkgdG9kb3NOb2RvcyB7CiAgICB0b2Rvc05vZG9zIHsKICAgICAgLi4uZnJhZ05vZG9Db25vY2ltaWVudG8KICAgIH0KICB9CiAgJHtmcmFnbWVudG9Ob2RvQ29ub2NpbWllbnRvfQpgOwoKZXhwb3J0IGNvbnN0IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MgPSBncWxgCiAgcXVlcnkgewogICAgeW8gewogICAgICBpZAogICAgICBhdGxhcyB7CiAgICAgICAgZGF0b3NOb2RvcyB7CiAgICAgICAgICAuLi5mcmFnRGF0b05vZG9Db25vY2ltaWVudG8KICAgICAgICB9CiAgICAgICAgY29uZmlndXJhY2lvbiB7CiAgICAgICAgICBtb2RvCiAgICAgICAgfQogICAgICAgIGlkTm9kb1RhcmdldAogICAgICAgIGNvbGVjY2lvbmVzIHsKICAgICAgICAgIGlkCiAgICAgICAgICBub21icmUKICAgICAgICAgIGlkc05vZG9zCiAgICAgICAgICBub2RvcyB7CiAgICAgICAgICAgIGlkCiAgICAgICAgICAgIG5vbWJyZQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICAke2ZyYWdtZW50b0RhdG9Ob2RvQ29ub2NpbWllbnRvfQpgOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIE5vZG9Db25vY2ltaWVudG8sCiAgICBCdXNjYWRvck5vZG9zQ29ub2NpbWllbnRvLAogICAgTG9hZGluZywKICAgIFBhbmVsQ29uanVudG9zTm9kb3MsCiAgICBFbmxhY2VzTm9kb0Nvbm9jaW1pZW50bywKICB9LAogIG5hbWU6ICJBdGxhc0Nvbm9jaW1pZW50byIsCiAgYXBvbGxvOiB7CiAgICB0b2Rvc05vZG9zOiB7CiAgICAgIHF1ZXJ5OiBRVUVSWV9OT0RPUywKICAgICAgcmVzdWx0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5kaWJ1amFyVmluY3Vsb3NHcmlzZXMoKTsKICAgICAgfSwKICAgICAgcG9sbEludGVydmFsKCkgewogICAgICAgIHJldHVybiB0aGlzLmNhbGxpbmdQb3NpY2lvbmVzID8gNTAwMCA6IG51bGw7CiAgICAgIH0sCiAgICAgIHVwZGF0ZSh7IHRvZG9zTm9kb3MgfSkgewogICAgICAgIHRoaXMubm9kb3NEZXNjYXJnYWRvcyA9IHRydWU7CiAgICAgICAgdmFyIG51ZXZvVG9kb3NOb2RvcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodG9kb3NOb2RvcykpOwogICAgICAgIG51ZXZvVG9kb3NOb2Rvcy5mb3JFYWNoKChub2RvKSA9PiB7CiAgICAgICAgICBub2RvLmNvb3Jkc01hbnVhbGVzID0gbm9kby5hdXRvQ29vcmRzOwogICAgICAgICAgbm9kby5jb29yZHMgPSBub2RvLmF1dG9Db29yZHM7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG51ZXZvVG9kb3NOb2RvczsKICAgICAgfSwKICAgICAgZmV0Y2hQb2xpY3koKSB7CiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAicHJvZHVjdGlvbiIpIHsKICAgICAgICAgIHJldHVybiAiY2FjaGUtZmlyc3QiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gImNhY2hlLWFuZC1uZXR3b3JrIjsKICAgICAgICB9CiAgICAgIH0sCiAgICB9LAogICAgeW86IHsKICAgICAgcXVlcnk6IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MsCiAgICAgIHNraXAoKSB7CiAgICAgICAgcmV0dXJuICF0aGlzLnVzdWFyaW9Mb2dlYWRvIHx8IHRoaXMudG9kb3NOb2Rvcy5sZW5ndGggPCAxOwogICAgICB9LAogICAgfSwKICAgIGNvbmZpZ3VyYWNpb25BdGxhczogewogICAgICBxdWVyeTogZ3FsYAogICAgICAgIHF1ZXJ5ICgkbm9tYnJlQXRsYXM6IFN0cmluZyEpIHsKICAgICAgICAgIGNvbmZpZ3VyYWNpb25BdGxhcyhub21icmVBdGxhczogJG5vbWJyZUF0bGFzKSB7CiAgICAgICAgICAgIGlkCiAgICAgICAgICAgIHBvc2ljaW9uYW5kbwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgYCwKICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgbm9tYnJlQXRsYXM6ICJjb25vY2ltaWVudG8iLAogICAgICB9LAogICAgICBmZXRjaFBvbGljeTogIm5ldHdvcmstb25seSIsCiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNvbmZpZ3VyYWNpb25BdGxhczogewogICAgICAgIHBvc2ljaW9uYW5kbzogZmFsc2UsCiAgICAgIH0sCiAgICAgIGhvdmVyZWQ6IGZhbHNlLAogICAgICB0b2Rvc05vZG9zOiBbXSwKICAgICAgbm9kb3NEZXNjYXJnYWRvczogZmFsc2UsCiAgICAgIHBvc2ljaW9uQ3JlYW5kb05vZG86IG51bGwsCiAgICAgIGlkTm9kb1NlbGVjY2lvbmFkbzogbnVsbCwKICAgICAgaWROb2RvTWVudUN4OiBudWxsLAogICAgICBpZHNOZWNlc2FyaW9zUGFyYVRhcmdldDogW10sCiAgICAgIGVudmlhbmRvUXVlcnlNb2RvOiBmYWxzZSwKICAgICAgbW9kb0F0bGFzOiAiZXN0dWRpYW50ZSIsCiAgICAgIGVudmlhbmRvUXVlcnlUYXJnZXQ6IGZhbHNlLAoKICAgICAgcmVkaWJ1amFyRW5sYWNlc05vZG9zOiAwLAoKICAgICAgeW86IHsKICAgICAgICBhdGxhczogewogICAgICAgICAgZGF0b3NOb2RvczogW10sCiAgICAgICAgICBjb25maWd1cmFjaW9uOiB7CiAgICAgICAgICAgIG1vZG86ICJlc3R1ZGlhbnRlIiwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgfSwKCiAgICAgIGNlbnRyb1Zpc3RhRGVjaW1hbDogewogICAgICAgIHg6IDIxOCwKICAgICAgICB5OiAzOSwKICAgICAgfSwKICAgICAgc2hvd2luZ1pvb21JbmZvOiBmYWxzZSwKICAgICAgem9vbTogODAsCiAgICAgIG1pblpvb206IDIwLAogICAgICBtYXhab29tOiAyMDAsCiAgICAgIHBpbmNoaW5nOiBmYWxzZSwKICAgICAgbGFzdFBpbmNoRGlzdGFuY2U6IDAsCiAgICAgIGFjdHVhbGl6YXJUcmF6b3M6IDAsCiAgICAgIHBhbm5pbmdWaXN0YTogZmFsc2UsCiAgICAgIHZpc3RhUGFubmVkOiBmYWxzZSwKCiAgICAgIGFjdHVhbGl6YXJWaW5jdWxvc0dyaXNlczogMCwKCiAgICAgIHVsdGltb1RvdWNoWDogMCwKICAgICAgdWx0aW1vVG91Y2hZOiAwLAoKICAgICAgY2VycmFyQnVzcXVlZGE6IDAsCgogICAgICBjYWxsaW5nUG9zaWNpb25lczogZmFsc2UsCgogICAgICBtb3N0cmFuZG9NZW51Q29udGV4dHVhbDogZmFsc2UsCiAgICAgIG9mZnNldE1lbnVDb250ZXh0dWFsOiB7CiAgICAgICAgdG9wOiAiMHB4IiwKICAgICAgICBsZWZ0OiAiMHB4IiwKICAgICAgfSwKICAgICAgZW52aWFuZG9RdWVyeUNvbmZpZ3VyYWNpb25BdGxhczogZmFsc2UsCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlkc05vZG9zT2JqZXRpdm9zKCkgewogICAgICBpZiAoIXRoaXMueW8gfHwgIXRoaXMueW8uYXRsYXMgfHwgIXRoaXMueW8uYXRsYXMuZGF0b3NOb2RvcykgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy55by5hdGxhcy5kYXRvc05vZG9zCiAgICAgICAgLmZpbHRlcigobikgPT4gbi5vYmpldGl2byA9PSB0cnVlKQogICAgICAgIC5tYXAoKG4pID0+IG4uaWROb2RvKTsKICAgIH0sCiAgICBub2Rvc09iamV0aXZvKCkgewogICAgICBpZiAoIXRoaXMudG9kb3NOb2RvcykgcmV0dXJuIFtdOwogICAgICByZXR1cm4gdGhpcy50b2Rvc05vZG9zLmZpbHRlcigobikgPT4KICAgICAgICB0aGlzLmlkc05vZG9zT2JqZXRpdm9zLmluY2x1ZGVzKG4uaWQpCiAgICAgICk7CiAgICB9LAogICAgbm9kb1NlbGVjY2lvbmFkbzogZnVuY3Rpb24gKCkgewogICAgICBpZiAoIXRoaXMuaWROb2RvU2VsZWNjaW9uYWRvKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMudG9kb3NOb2Rvcy5maW5kKChuKSA9PiBuLmlkID09PSB0aGlzLmlkTm9kb1NlbGVjY2lvbmFkbyk7CiAgICB9LAogICAgaWRVc3VhcmlvOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c3VhcmlvLmlkOwogICAgfSwKICAgIHVzdWFyaW9BZG1pbmlzdHJhZG9yQXRsYXM6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzLiRzdG9yZS5zdGF0ZS51c3VhcmlvLnBlcm1pc29zKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c3VhcmlvLnBlcm1pc29zLmluY2x1ZGVzKCJhdGxhc0FkbWluaXN0cmFkb3IiKQogICAgICAgID8gdHJ1ZQogICAgICAgIDogZmFsc2U7CiAgICB9LAogICAgaWROb2RvVGFyZ2V0KCkgewogICAgICBpZiAoIXRoaXMueW8gfHwgIXRoaXMueW8uYXRsYXMpIHJldHVybiBudWxsOwogICAgICByZXR1cm4gdGhpcy55by5hdGxhcy5pZE5vZG9UYXJnZXQ7CiAgICB9LAogICAgbm9kb1RhcmdldCgpIHsKICAgICAgaWYgKCF0aGlzLmlkTm9kb1RhcmdldCkgcmV0dXJuIG51bGw7CiAgICAgIHJldHVybiB0aGlzLnRvZG9zTm9kb3MuZmluZCgobikgPT4gbi5pZCA9PT0gdGhpcy5pZE5vZG9UYXJnZXQpOwogICAgfSwKICAgIGlkc05vZG9zQXByZW5kaWRvcygpIHsKICAgICAgcmV0dXJuIHRoaXMueW8uYXRsYXMuZGF0b3NOb2RvcwogICAgICAgIC5maWx0ZXIoKG4pID0+IG4uYXByZW5kaWRvID09IHRydWUpCiAgICAgICAgLm1hcCgobikgPT4gbi5pZE5vZG8pOwogICAgfSwKICAgIGRhdG9zTm9kb3NFc3R1ZGlhZG9zKCkgewogICAgICByZXR1cm4gdGhpcy55by5hdGxhcy5kYXRvc05vZG9zLmZpbHRlcigKICAgICAgICAobikgPT4gIW4uYXByZW5kaWRvICYmIG4uZXN0dWRpYWRvCiAgICAgICk7CiAgICB9LAogICAgaWRzTm9kb3NFc3R1ZGlhZG9zKCkgewogICAgICByZXR1cm4gdGhpcy5kYXRvc05vZG9zRXN0dWRpYWRvcy5tYXAoKG5lKSA9PiBuZS5pZE5vZG8pOwogICAgfSwKICAgIGRhdG9zTm9kb3NSZXBhc2FyKCkgewogICAgICBpZiAoIXRoaXMueW8gfHwgIXRoaXMueW8uYXRsYXMgfHwgIXRoaXMueW8uYXRsYXMuZGF0b3NOb2RvcykgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMueW8uYXRsYXMuZGF0b3NOb2Rvcy5maWx0ZXIoCiAgICAgICAgKGRuKSA9PgogICAgICAgICAgIWRuLmFwcmVuZGlkbyAmJgogICAgICAgICAgZG4uZXN0dWRpYWRvICYmCiAgICAgICAgICBkbi5pdGVyYWNpb25lc1JlcGFzbyAmJgogICAgICAgICAgZG4uaXRlcmFjaW9uZXNSZXBhc28ubGVuZ3RoID4gMAogICAgICApOwogICAgfSwKICAgIGRhdG9zTm9kb3NVcmdlbnRlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuZGF0b3NOb2Rvc1JlcGFzYXIuZmlsdGVyKChkbikgPT4gewogICAgICAgIGNvbnN0IHBhc2FkbyA9CiAgICAgICAgICBuZXcgRGF0ZShkbi5lc3R1ZGlhZG8pLmdldFRpbWUoKSArIGRuLml0ZXJhY2lvbmVzUmVwYXNvWzBdLmludGVydmFsbyA8CiAgICAgICAgICBEYXRlLm5vdygpOwogICAgICAgIHJldHVybiBwYXNhZG87CiAgICAgIH0pOwogICAgfSwKICAgIGRhdG9zTm9kb3NGcmVzY29zKCkgewogICAgICByZXR1cm4gdGhpcy5kYXRvc05vZG9zRXN0dWRpYWRvcy5maWx0ZXIoKGRuKSA9PiB7CiAgICAgICAgY29uc3QgZGF0ZUVzdHVkaWFkbyA9IG5ldyBEYXRlKGRuLmVzdHVkaWFkbyk7CiAgICAgICAgaWYgKCFkbi5pdGVyYWNpb25lc1JlcGFzbyB8fCBkbi5pdGVyYWNpb25lc1JlcGFzby5sZW5ndGggPCAxKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIERhdGUubm93KCkgPAogICAgICAgICAgZGF0ZUVzdHVkaWFkby5nZXRUaW1lKCkgKyBkbi5pdGVyYWNpb25lc1JlcGFzb1swXS5pbnRlcnZhbG8KICAgICAgICApOwogICAgICB9KTsKICAgIH0sCiAgICBpZHNOb2Rvc0ZyZXNjb3MoKSB7CiAgICAgIHJldHVybiB0aGlzLmRhdG9zTm9kb3NGcmVzY29zLm1hcCgobmYpID0+IG5mLmlkTm9kbyk7CiAgICB9LAogICAgaWRzTm9kb3NQcmVzZW50ZXNDYWJlemEoKSB7CiAgICAgIHJldHVybiB0aGlzLmlkc05vZG9zRnJlc2NvcwogICAgICAgIC5maWx0ZXIoKGlkTmUpID0+ICF0aGlzLmlkc05vZG9zQXByZW5kaWRvcy5pbmNsdWRlcyhpZE5lKSkKICAgICAgICAuY29uY2F0KHRoaXMuaWRzTm9kb3NBcHJlbmRpZG9zKTsKICAgIH0sCiAgICBjZW50cm9WaXN0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB4OiBNYXRoLnJvdW5kKHRoaXMuY2VudHJvVmlzdGFEZWNpbWFsLngpLAogICAgICAgIHk6IE1hdGgucm91bmQodGhpcy5jZW50cm9WaXN0YURlY2ltYWwueSksCiAgICAgIH07CiAgICB9LAogICAgZmFjdG9yWm9vbSgpIHsKICAgICAgcmV0dXJuIE51bWJlcigodGhpcy56b29tIC8gMTAwKS50b0ZpeGVkKDIpKTsKICAgIH0sCiAgICBlc3F1aW5hc0RpYWdyYW1hKCkgewogICAgICBjb25zdCBtYXhYID0gdGhpcy50b2Rvc05vZG9zLnJlZHVjZSgKICAgICAgICAoYWNjLCBuKSA9PiAobi5hdXRvQ29vcmRzLnggPiBhY2MgPyBuLmF1dG9Db29yZHMueCA6IGFjYyksCiAgICAgICAgMAogICAgICApOwogICAgICBjb25zdCBtYXhZID0gdGhpcy50b2Rvc05vZG9zLnJlZHVjZSgKICAgICAgICAoYWNjLCBuKSA9PiAobi5hdXRvQ29vcmRzLnkgPiBhY2MgPyBuLmF1dG9Db29yZHMueSA6IGFjYyksCiAgICAgICAgMAogICAgICApOwogICAgICBjb25zdCBtaW5YID0gdGhpcy50b2Rvc05vZG9zLnJlZHVjZSgKICAgICAgICAoYWNjLCBuKSA9PiAobi5hdXRvQ29vcmRzLnggPCBhY2MgPyBuLmF1dG9Db29yZHMueCA6IGFjYyksCiAgICAgICAgMAogICAgICApOwogICAgICBjb25zdCBtaW5ZID0gdGhpcy50b2Rvc05vZG9zLnJlZHVjZSgKICAgICAgICAoYWNjLCBuKSA9PiAobi5hdXRvQ29vcmRzLnkgPCBhY2MgPyBuLmF1dG9Db29yZHMueSA6IGFjYyksCiAgICAgICAgMAogICAgICApOwoKICAgICAgcmV0dXJuIHsKICAgICAgICB4MTogbWluWCwKICAgICAgICB5MTogbWluWSwKCiAgICAgICAgeDI6IG1heFgsCiAgICAgICAgeTI6IG1heFksCiAgICAgIH07CiAgICB9LAogICAgb2Zmc2V0Q29udGVuZWRvck5vZG9zKCkgewogICAgICBjb25zdCBhbmNobyA9IHRoaXMuZXNxdWluYXNEaWFncmFtYS54MiAtIHRoaXMuZXNxdWluYXNEaWFncmFtYS54MTsKICAgICAgY29uc3QgYWx0byA9IHRoaXMuZXNxdWluYXNEaWFncmFtYS55MiAtIHRoaXMuZXNxdWluYXNEaWFncmFtYS55MTsKICAgICAgcmV0dXJuIHsKICAgICAgICAvLyBsZWZ0OiAtKHRoaXMuY2VudHJvVmlzdGEueCAqIHRoaXMuZmFjdG9yWm9vbSkgKyAicHgiLAogICAgICAgIC8vIHRvcDogLSh0aGlzLmNlbnRyb1Zpc3RhLnkgKiB0aGlzLmZhY3Rvclpvb20pICsgInB4IiwKCiAgICAgICAgd2lkdGg6IGFuY2hvICogdGhpcy5mYWN0b3Jab29tICsgInB4IiwKICAgICAgICBoZWlnaHQ6IGFsdG8gKiB0aGlzLmZhY3Rvclpvb20gKyAicHgiLAogICAgICB9OwogICAgfSwKICAgIG5vZG9zQ29uUmVxdWVyaW1lbnRvcygpIHsKICAgICAgdmFyIG5yID0gdGhpcy50b2Rvc05vZG9zLmZpbHRlcigobikgPT4gbi52aW5jdWxvcy5sZW5ndGggPiAwKTsKCiAgICAgIHJldHVybiBucjsKICAgIH0sCiAgICBub2Rvc1JlbmRlcigpIHsKICAgICAgaWYgKHRoaXMuaWROb2RvVGFyZ2V0KSB7CiAgICAgICAgcmV0dXJuIHRoaXMudG9kb3NOb2RvcwogICAgICAgICAgLmZpbHRlcigobikgPT4gdGhpcy5pZHNOZWNlc2FyaW9zUGFyYVRhcmdldC5pbmNsdWRlcyhuLmlkKSkKICAgICAgICAgIC5jb25jYXQoW3RoaXMudG9kb3NOb2Rvcy5maW5kKChuKSA9PiB0aGlzLmlkTm9kb1RhcmdldCA9PT0gbi5pZCldKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy50b2Rvc05vZG9zOwogICAgfSwKICAgIGlkc1RvZG9zTm9kb3NSZW5kZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZG9zUmVuZGVyLm1hcCgobikgPT4gbi5pZCk7CiAgICB9LAogICAgb2Zmc2V0TG9hZGluZ0NyZWFuZG9Ob2RvKCkgewogICAgICBpZiAoIXRoaXMucG9zaWNpb25DcmVhbmRvTm9kbykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGNvbnN0IGxlZnQgPQogICAgICAgICh0aGlzLnBvc2ljaW9uQ3JlYW5kb05vZG8ueCAtIHRoaXMuZXNxdWluYXNEaWFncmFtYS54MSkgKgogICAgICAgIHRoaXMuZmFjdG9yWm9vbTsKICAgICAgY29uc3QgdG9wID0KICAgICAgICAodGhpcy5wb3NpY2lvbkNyZWFuZG9Ob2RvLnkgLSB0aGlzLmVzcXVpbmFzRGlhZ3JhbWEueTEpICoKICAgICAgICB0aGlzLmZhY3Rvclpvb207CiAgICAgIHJldHVybiB7CiAgICAgICAgbGVmdDogbGVmdCArICJweCIsCiAgICAgICAgdG9wOiB0b3AgKyAicHgiLAogICAgICB9OwogICAgfSwKICAgIG5vZG9BYmllcnRvKCkgewogICAgICBjb25zb2xlLmxvZygiVmVyaWZpY2FuZG8gcGF0aCBuYW1lIik7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuJHJvdXRlLm5hbWUpOwoKICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLm5hbWUgPT09ICJ2aXNvck5vZG9Db25vY2ltaWVudG8iOwogICAgfSwKICAgIG5vZG9zQ29uZWN0YWRvc0FsU2VsZWNjaW9uYWRvKCkgewogICAgICBpZiAoIXRoaXMubm9kb1NlbGVjY2lvbmFkbykgcmV0dXJuIFtdOwogICAgICByZXR1cm4gdGhpcy50b2Rvc05vZG9zLmZpbHRlcigobikgPT4KICAgICAgICB0aGlzLm5vZG9TZWxlY2Npb25hZG8udmluY3Vsb3Muc29tZSgodikgPT4gdi5pZFJlZiA9PT0gbi5pZCkKICAgICAgKTsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBpbmljaWFyQ2FsbGluZ1Bvc2ljaW9uZXMoKSB7CiAgICAgIHZhciBjaWNsb3MgPSBwcm9tcHQoIsK/Q3VhbnRvcyBjaWNsb3M/Iik7CiAgICAgIGlmIChpc05hTihjaWNsb3MpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjaWNsb3MgPSBNYXRoLnJvdW5kKGNpY2xvcyk7CiAgICAgIGlmIChjaWNsb3MgPCAxKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKGBFbnZpYW5kbyByZXBvc2ljaW9uYW1pZW50byBkZSAke2NpY2xvc30gY2ljbG9zYCk7CiAgICAgIHRoaXMuY2FsbGluZ1Bvc2ljaW9uZXMgPSB0cnVlOwoKICAgICAgdGhpcy4kYXBvbGxvCiAgICAgICAgLm11dGF0ZSh7CiAgICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgICBtdXRhdGlvbiAoJGNpY2xvczogSW50ISkgewogICAgICAgICAgICAgIHBvc2ljaW9uYXJOb2Rvc0Nvbm9jaW1pZW50b0J5RnVlcnphcyhjaWNsb3M6ICRjaWNsb3MpCiAgICAgICAgICAgIH0KICAgICAgICAgIGAsCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgY2ljbG9zLAogICAgICAgICAgfSwKICAgICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuY2FsbGluZ1Bvc2ljaW9uZXMgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIHRoaXMuY2FsbGluZ1Bvc2ljaW9uZXMgPSBmYWxzZTsKICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJvcn1gKTsKICAgICAgICB9KTsKICAgIH0sCiAgICB0b2dnbGVQb3NpY2lvbmFtaWVudG8oKSB7CiAgICAgIHRoaXMuZW52aWFuZG9RdWVyeUNvbmZpZ3VyYWNpb25BdGxhcyA9IHRydWU7CiAgICAgIHRoaXMuJGFwb2xsbwogICAgICAgIC5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGdxbGAKICAgICAgICAgICAgbXV0YXRpb24gKCRub21icmVBdGxhczogU3RyaW5nISkgewogICAgICAgICAgICAgIHRvZ2dsZVBvc2ljaW9uYW1pZW50b0F1dG9tYXRpY29BdGxhcyhub21icmVBdGxhczogJG5vbWJyZUF0bGFzKSB7CiAgICAgICAgICAgICAgICBpZAogICAgICAgICAgICAgICAgcG9zaWNpb25hbmRvCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICBgLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIG5vbWJyZUF0bGFzOiAiY29ub2NpbWllbnRvIiwKICAgICAgICAgIH0sCiAgICAgICAgfSkKICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLmVudmlhbmRvUXVlcnlDb25maWd1cmFjaW9uQXRsYXMgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICB0aGlzLmVudmlhbmRvUXVlcnlDb25maWd1cmFjaW9uQXRsYXMgPSBmYWxzZTsKICAgICAgICB9KTsKICAgIH0sCiAgICBhYnJpck1lbnVDb250ZXh0dWFsKGUpIHsKICAgICAgbGV0IHBvc0RpYWdyYW1hID0gdGhpcy4kcmVmcy5jb250ZW5lZG9yRGlhZ3JhbWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogICAgICBsZXQgdG9wQ2xpY2sgPSBNYXRoLnJvdW5kKGUucGFnZVkgLSBwb3NEaWFncmFtYS50b3ApOwogICAgICBsZXQgbGVmdENsaWNrID0gTWF0aC5yb3VuZChlLnBhZ2VYIC0gcG9zRGlhZ3JhbWEubGVmdCk7CgogICAgICB0aGlzLiRzZXQodGhpcy5vZmZzZXRNZW51Q29udGV4dHVhbCwgInRvcCIsIHRvcENsaWNrICsgInB4Iik7CiAgICAgIHRoaXMuJHNldCh0aGlzLm9mZnNldE1lbnVDb250ZXh0dWFsLCAibGVmdCIsIGxlZnRDbGljayArICJweCIpOwogICAgICB0aGlzLm1vc3RyYW5kb01lbnVDb250ZXh0dWFsID0gdHJ1ZTsKICAgICAgLy90aGlzLmNyZWFyTm9kbyh7eDogbGVmdENsaWNrLCB5OiB0b3BDbGlja30pOwogICAgfSwKICAgIGNyZWFyTm9kb0VuTWVudUNvbnRleHR1YWwoKSB7CiAgICAgIGNvbnN0IHBvc0NvbnRlbmVkb3JOb2RvcyA9CiAgICAgICAgdGhpcy4kcmVmcy5jb250ZW5lZG9yTm9kb3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGNvbnN0IGRpc3RhbmNpYUxlZnRQeCA9CiAgICAgICAgcGFyc2VJbnQodGhpcy5vZmZzZXRNZW51Q29udGV4dHVhbC5sZWZ0KSAtCiAgICAgICAgcGFyc2VJbnQocG9zQ29udGVuZWRvck5vZG9zLmxlZnQpOwogICAgICBjb25zdCBkaXN0YW5jaWFUb3BQeCA9CiAgICAgICAgcGFyc2VJbnQodGhpcy5vZmZzZXRNZW51Q29udGV4dHVhbC50b3ApIC0KICAgICAgICAocGFyc2VJbnQocG9zQ29udGVuZWRvck5vZG9zLnRvcCkgLSBwYXJzZUludCh0aGlzLiRlbC5vZmZzZXRUb3ApKTsKCiAgICAgIGNvbnN0IHBvc1B4WCA9IGRpc3RhbmNpYUxlZnRQeDsKICAgICAgY29uc3QgcG9zUHhZID0gZGlzdGFuY2lhVG9wUHg7CgogICAgICBjb25zb2xlLmxvZyhgeFBpeDogJHtwYXJzZUludCh0aGlzLm9mZnNldE1lbnVDb250ZXh0dWFsLmxlZnQpfWApOwogICAgICBjb25zb2xlLmxvZygKICAgICAgICBgcG9zWENvbnRlbmVkb3JOb2RvczogJHtwYXJzZUludChwb3NDb250ZW5lZG9yTm9kb3MubGVmdCl9LCAkewogICAgICAgICAgcG9zQ29udGVuZWRvck5vZG9zLnRvcAogICAgICAgIH1gCiAgICAgICk7CiAgICAgIGNvbnNvbGUubG9nKGBkaXN0YW5jaWFMZWZ0UHg6ICR7ZGlzdGFuY2lhTGVmdFB4fWApOwogICAgICBjb25zb2xlLmxvZyhgZGlzdGFuY2lhVG9wUHg6ICR7ZGlzdGFuY2lhVG9wUHh9YCk7CiAgICAgIGNvbnNvbGUubG9nKAogICAgICAgIGBTY3JvbGwgeCBjb250ZW5lZG9yRGlhZ3JhbWE6ICR7dGhpcy4kcmVmcy5jb250ZW5lZG9yRGlhZ3JhbWEuc2Nyb2xsTGVmdH1gCiAgICAgICk7CgogICAgICB2YXIgcG9zaWNpb25OdWV2b05vZG8gPSB7CiAgICAgICAgeDogcGFyc2VJbnQocG9zUHhYIC8gdGhpcy5mYWN0b3Jab29tICsgdGhpcy5lc3F1aW5hc0RpYWdyYW1hLngxKSwKICAgICAgICB5OiBwYXJzZUludChwb3NQeFkgLyB0aGlzLmZhY3Rvclpvb20gKyB0aGlzLmVzcXVpbmFzRGlhZ3JhbWEueTEpLAogICAgICB9OwoKICAgICAgY29uc29sZS5sb2coYENyZWFuZG8gbnVldm8gbm9kbyBlbiAke0pTT04uc3RyaW5naWZ5KHBvc2ljaW9uTnVldm9Ob2RvKX1gKTsKCiAgICAgIHRoaXMuY3JlYXJOb2RvKHBvc2ljaW9uTnVldm9Ob2RvKTsKICAgIH0sCiAgICBlbmNvbnRyYXJOb2Rvc05lY2VzYXJpb3NEZU5vZG8oaWROb2RvLCBsaXN0YVRvdGFsKSB7CiAgICAgIGNvbnN0IGVsTm9kbyA9IHRoaXMudG9kb3NOb2Rvcy5maW5kKChuKSA9PiBuLmlkID09IGlkTm9kbyk7CiAgICAgIGlmICghZWxOb2RvKSB7CiAgICAgICAgcmV0dXJuIGxpc3RhVG90YWw7CiAgICAgIH0KICAgICAgY29uc3QgbmVjZXNhcmlvcyA9IGVsTm9kby52aW5jdWxvcwogICAgICAgIC5maWx0ZXIoKHYpID0+IHYucm9sID09ICJ0YXJnZXQiKQogICAgICAgIC5tYXAoKHYpID0+IHYuaWRSZWYpOwogICAgICBuZWNlc2FyaW9zLmZvckVhY2goKG5lY2VzYXJpbykgPT4gewogICAgICAgIGlmICghbGlzdGFUb3RhbC5pbmNsdWRlcyhuZWNlc2FyaW8pKSB7CiAgICAgICAgICBsaXN0YVRvdGFsLnB1c2gobmVjZXNhcmlvKTsKICAgICAgICAgIGxpc3RhVG90YWwgPSB0aGlzLmVuY29udHJhck5vZG9zTmVjZXNhcmlvc0RlTm9kbygKICAgICAgICAgICAgbmVjZXNhcmlvLAogICAgICAgICAgICBsaXN0YVRvdGFsCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBsaXN0YVRvdGFsOwogICAgfSwKICAgIGNsaWNrRm9uZG9BdGxhcygpIHsKICAgICAgLy8gY29uc29sZS5sb2coYENsaWNrIGVuIGVsIGZvbmRvIGRlbCBhdGxhcy4gUm91dGUgbmFtZTogJHt0aGlzLiRyb3V0ZS5uYW1lfWApOwogICAgICBpZiAodGhpcy4kcm91dGUubmFtZSAhPSAiYXRsYXMiKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiYXRsYXMiIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIXRoaXMudmlzdGFQYW5uZWQpIHRoaXMuaWROb2RvU2VsZWNjaW9uYWRvID0gbnVsbDsKICAgICAgdGhpcy5wYW5uaW5nVmlzdGEgPSBmYWxzZTsKICAgICAgdGhpcy52aXN0YVBhbm5lZCA9IGZhbHNlOwogICAgICB0aGlzLiRyZWZzLnBhbmVsQ29uanVudG9zTm9kb3MuYWJpZXJ0byA9IGZhbHNlOwogICAgICB0aGlzLm1vc3RyYW5kb01lbnVDb250ZXh0dWFsID0gZmFsc2U7CiAgICB9LAogICAgc2V0RXN0YWRvT2JqZXRpdm9Ob2RvQ2FjaGUobnVldm9Fc3RhZG8sIGlkTm9kbykgewogICAgICBjb25zb2xlLmxvZygKICAgICAgICBgU2V0aW5nIGVuIGNhY2hlIGFsIG5vZG8gJHtpZE5vZG99IGNvbiBlc3RhZG8gb2JqZXRpdm86ICR7bnVldm9Fc3RhZG99YAogICAgICApOwogICAgICBjb25zdCBzdG9yZSA9IHRoaXMuJGFwb2xsby5wcm92aWRlci5kZWZhdWx0Q2xpZW50OwogICAgICBjb25zdCBjYWNoZSA9IHN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MsCiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKCiAgICAgIHZhciBpbmRleE4gPSBudWV2b0NhY2hlLnlvLmF0bGFzLmRhdG9zTm9kb3MuZmluZEluZGV4KAogICAgICAgIChuKSA9PiBuLmlkTm9kbyA9PSBpZE5vZG8KICAgICAgKTsKICAgICAgaWYgKGluZGV4TiA+IC0xKSB7CiAgICAgICAgbnVldm9DYWNoZS55by5hdGxhcy5kYXRvc05vZG9zW2luZGV4Tl0ub2JqZXRpdm8gPSBudWV2b0VzdGFkbzsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyhgTm8gZXN0YWJhIGVuIGNhY2jDqS4gUHVzaGluZ2ApOwogICAgICAgIG51ZXZvQ2FjaGUueW8uYXRsYXMuZGF0b3NOb2Rvcy5wdXNoKHsKICAgICAgICAgIF9fdHlwZW5hbWU6ICJEYXRvTm9kb1VzdWFyaW8iLAogICAgICAgICAgaWROb2RvLAogICAgICAgICAgb2JqZXRpdm86IG51ZXZvRXN0YWRvLAogICAgICAgICAgYXByZW5kaWRvOiBmYWxzZSwKICAgICAgICB9KTsKICAgICAgfQogICAgICBzdG9yZS53cml0ZVF1ZXJ5KHsKICAgICAgICBxdWVyeTogUVVFUllfREFUT1NfVVNVQVJJT19OT0RPUywKICAgICAgICBkYXRhOiBudWV2b0NhY2hlLAogICAgICB9KTsKICAgIH0sCiAgICBzZXROb2RvQXByZW5kaWRvQ2FjaGUobnVldm9Fc3RhZG8sIGlkTm9kbykgewogICAgICBjb25zb2xlLmxvZygKICAgICAgICBgU2V0aW5nIGVuIGNhY2hlIGFsIG5vZG8gJHtpZE5vZG99IGNvbiBlc3RhZG8gYXByZW5kaWRvOiAke251ZXZvRXN0YWRvfWAKICAgICAgKTsKICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLiRhcG9sbG8ucHJvdmlkZXIuZGVmYXVsdENsaWVudDsKICAgICAgY29uc3QgY2FjaGUgPSBzdG9yZS5yZWFkUXVlcnkoewogICAgICAgIHF1ZXJ5OiBRVUVSWV9EQVRPU19VU1VBUklPX05PRE9TLAogICAgICB9KTsKICAgICAgdmFyIG51ZXZvQ2FjaGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7CiAgICAgIHZhciBpbmRleE4gPSBudWV2b0NhY2hlLnlvLmF0bGFzLmRhdG9zTm9kb3MuZmluZEluZGV4KAogICAgICAgIChuKSA9PiBuLmlkTm9kbyA9PSBpZE5vZG8KICAgICAgKTsKICAgICAgaWYgKGluZGV4TiA+IC0xKSB7CiAgICAgICAgbnVldm9DYWNoZS55by5hdGxhcy5kYXRvc05vZG9zW2luZGV4Tl0uYXByZW5kaWRvID0gbnVldm9Fc3RhZG87CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coYE5vIGVzdGFiYSBlbiBjYWNow6kuIFB1c2hpbmdgKTsKICAgICAgICBudWV2b0NhY2hlLnlvLmF0bGFzLmRhdG9zTm9kb3MucHVzaCh7CiAgICAgICAgICBfX3R5cGVuYW1lOiAiRGF0b05vZG9Vc3VhcmlvIiwKICAgICAgICAgIGlkTm9kbywKICAgICAgICAgIG9iamV0aXZvOiBmYWxzZSwKICAgICAgICAgIGFwcmVuZGlkbzogbnVldm9Fc3RhZG8sCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MsCiAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgfSk7CiAgICB9LAogICAgc2V0Tm9kb1RhcmdldENhY2hlKGlkTm9kbykgewogICAgICBjb25zb2xlLmxvZyhgU2V0aW5nIGVuIGNhY2hlIGFsIG5vZG8gJHtpZE5vZG99IGNvbW8gdGFyZ2V0YCk7CiAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlID0gc3RvcmUucmVhZFF1ZXJ5KHsKICAgICAgICBxdWVyeTogUVVFUllfREFUT1NfVVNVQVJJT19OT0RPUywKICAgICAgfSk7CiAgICAgIHZhciBudWV2b0NhY2hlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjYWNoZSkpOwogICAgICBudWV2b0NhY2hlLnlvLmF0bGFzLmlkTm9kb1RhcmdldCA9IGlkTm9kbzsKICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MsCiAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgfSk7CiAgICB9LAogICAgc2V0TW9kbyhtb2RvKSB7CiAgICAgIGlmICghdGhpcy51c3VhcmlvTG9nZWFkbykgcmV0dXJuOwogICAgICB0aGlzLm1vZG9BdGxhcyA9IG1vZG87CiAgICAgIC8vIHRoaXMuZW52aWFuZG9RdWVyeU1vZG8gPSB0cnVlOwoKICAgICAgLy8gdGhpcy4kYXBvbGxvCiAgICAgIC8vICAgLm11dGF0ZSh7CiAgICAgIC8vICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAvLyAgICAgICBtdXRhdGlvbiAoJGlkVXN1YXJpbzogSUQhLCAkbnVldm9Nb2RvOiBTdHJpbmchKSB7CiAgICAgIC8vICAgICAgICAgc2V0TW9kb1VzdWFyaW9BdGxhcyhpZFVzdWFyaW86ICRpZFVzdWFyaW8sIG51ZXZvTW9kbzogJG51ZXZvTW9kbyl7CiAgICAgIC8vICAgICAgICAgICAgIGlkCiAgICAgIC8vICAgICAgICAgICAgIGF0bGFzewogICAgICAvLyAgICAgICAgICAgICAgICAgY29uZmlndXJhY2lvbnsKICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBtb2RvCiAgICAgIC8vICAgICAgICAgICAgICAgICB9CiAgICAgIC8vICAgICAgICAgICAgIH0KICAgICAgLy8gICAgICAgICB9CiAgICAgIC8vICAgICAgIH0KICAgICAgLy8gICAgIGAsCiAgICAgIC8vICAgICB2YXJpYWJsZXM6IHsKICAgICAgLy8gICAgICAgaWRVc3VhcmlvOiB0aGlzLnVzdWFyaW8uaWQsCiAgICAgIC8vICAgICAgIG51ZXZvTW9kbzogbW9kbywKICAgICAgLy8gICAgIH0sCiAgICAgIC8vICAgfSkKICAgICAgLy8gICAudGhlbigoKSA9PiB7CiAgICAgIC8vICAgICB0aGlzLmVudmlhbmRvUXVlcnlNb2RvID0gZmFsc2U7CgogICAgICAvLyAgIH0pCiAgICAgIC8vICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAvLyAgICAgdGhpcy5lbnZpYW5kb1F1ZXJ5TW9kbyA9IGZhbHNlOwogICAgICAvLyAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApOwogICAgICAvLyAgIH0pOwogICAgfSwKICAgIGNvbmZpZ3VyYXJOb2RvVGFyZ2V0KGlkTm9kbykgewogICAgICB0aGlzLmVudmlhbmRvUXVlcnlUYXJnZXQgPSB0cnVlOwoKICAgICAgY29uc29sZS5sb2coYENvbmZpZ3VyYW5kbyBub2RvIHRhcmdldGApOwogICAgICBpZiAoIWlkTm9kbyB8fCBpZE5vZG8gPT09IHRoaXMuaWROb2RvVGFyZ2V0KSB7CiAgICAgICAgY29uc29sZS5sb2coYE51bGlmaWNhbmRvYCk7CiAgICAgICAgc2V0VGltZW91dCgoKT0+ewogICAgICAgIHRoaXMubnVsaWZpY2FyTm9kb1RhcmdldCgpOwoKICAgICAgICB9LCAxMDApOwogICAgICB9IGVsc2UgewogICAgICAgIHNldFRpbWVvdXQoKCk9PnsKCiAgICAgICAgdGhpcy5zZXROb2RvVGFyZ2V0KGlkTm9kbyk7CiAgICAgICAgfSwgMTAwKTsKICAgICAgfQogICAgfSwKICAgIHNldE5vZG9UYXJnZXQoaWROb2RvKSB7CiAgICAgIGlmICghaWROb2RvKSByZXR1cm47CiAgICAgIGlmICh0aGlzLmlkTm9kb1RhcmdldCA9PSBpZE5vZG8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlID0gc3RvcmUucmVhZFF1ZXJ5KHsKICAgICAgICBxdWVyeTogUVVFUllfREFUT1NfVVNVQVJJT19OT0RPUywKICAgICAgfSk7CiAgICAgIHZhciBudWV2b0NhY2hlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjYWNoZSkpOwogICAgICBudWV2b0NhY2hlLnlvLmF0bGFzLmlkTm9kb1RhcmdldCA9IGlkTm9kbzsKICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MsCiAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgfSk7CiAgICAgIHRoaXMuJGFwb2xsbwogICAgICAgIC5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGdxbGAKICAgICAgICAgICAgbXV0YXRpb24gKCRpZE5vZG86IElEISkgewogICAgICAgICAgICAgIHNldE5vZG9BdGxhc1RhcmdldChpZE5vZG86ICRpZE5vZG8pCiAgICAgICAgICAgIH0KICAgICAgICAgIGAsCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgaWROb2RvLAogICAgICAgICAgfSwKICAgICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuZW52aWFuZG9RdWVyeVRhcmdldCA9IGZhbHNlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgdGhpcy5lbnZpYW5kb1F1ZXJ5VGFyZ2V0ID0gZmFsc2U7CiAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyb3J9YCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgbnVsaWZpY2FyTm9kb1RhcmdldCgpIHsKICAgICAgY29uc29sZS5sb2coYE51bGlmaWNhbmRvIG5vZG8gdGFyZ2V0YCk7CiAgICAgIHRoaXMuZW52aWFuZG9RdWVyeVRhcmdldCA9IHRydWU7CgogICAgICBjb25zdCBzdG9yZSA9IHRoaXMuJGFwb2xsby5wcm92aWRlci5kZWZhdWx0Q2xpZW50OwogICAgICBjb25zdCBjYWNoZSA9IHN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0RBVE9TX1VTVUFSSU9fTk9ET1MsCiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKICAgICAgbnVldm9DYWNoZS55by5hdGxhcy5pZE5vZG9UYXJnZXQgPSBudWxsOwogICAgICAvLyBudWV2b0NhY2hlLnlvLmF0bGFzLmNlbnRyb1Zpc3RhID0ge3g6MTAwLCB5OjEwMH07CiAgICAgIHN0b3JlLndyaXRlUXVlcnkoewogICAgICAgIHF1ZXJ5OiBRVUVSWV9EQVRPU19VU1VBUklPX05PRE9TLAogICAgICAgIGRhdGE6IG51ZXZvQ2FjaGUsCiAgICAgIH0pOwogICAgICB0aGlzLiRhcG9sbG8KICAgICAgICAubXV0YXRlKHsKICAgICAgICAgIG11dGF0aW9uOiBncWxgCiAgICAgICAgICAgIG11dGF0aW9uIHsKICAgICAgICAgICAgICBudWxpZmljYXJOb2RvVGFyZ2V0VXN1YXJpb0F0bGFzCiAgICAgICAgICAgIH0KICAgICAgICAgIGAsCiAgICAgICAgfSkKICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLmVudmlhbmRvUXVlcnlUYXJnZXQgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIHRoaXMuZW52aWFuZG9RdWVyeVRhcmdldCA9IGZhbHNlOwogICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApOwogICAgICAgIH0pOwogICAgfSwKICAgIGNlbnRyYXJFbk5vZG8obikgewogICAgICBjb25zdCBwb3NEaWFncmFtYSA9IHRoaXMuJHJlZnMuY29udGVuZWRvckRpYWdyYW1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICBjb25zdCBwb3NOb2RvID0gewogICAgICAgIHg6IChuLmF1dG9Db29yZHMueCAtIHRoaXMuZXNxdWluYXNEaWFncmFtYS54MSkgKiB0aGlzLmZhY3Rvclpvb20sCiAgICAgICAgeTogKG4uYXV0b0Nvb3Jkcy55IC0gdGhpcy5lc3F1aW5hc0RpYWdyYW1hLnkxKSAqIHRoaXMuZmFjdG9yWm9vbSwKICAgICAgfTsKCiAgICAgIGNvbnN0IHBvc0lkZWFsU2Nyb2xsID0gewogICAgICAgIHg6IHBhcnNlSW50KHBvc05vZG8ueCAtIHBvc0RpYWdyYW1hLndpZHRoIC8gMiksCiAgICAgICAgeTogcGFyc2VJbnQocG9zTm9kby55IC0gcG9zRGlhZ3JhbWEuaGVpZ2h0IC8gMiksCiAgICAgIH07CgogICAgICB0aGlzLiRyZWZzLmNvbnRlbmVkb3JEaWFncmFtYS5zY3JvbGxMZWZ0ID0gcG9zSWRlYWxTY3JvbGwueDsKICAgICAgdGhpcy4kcmVmcy5jb250ZW5lZG9yRGlhZ3JhbWEuc2Nyb2xsVG9wID0gcG9zSWRlYWxTY3JvbGwueTsKCiAgICAgIHRoaXMuc2VsZWNjaW9uTm9kbyhuKTsKICAgICAgLy90aGlzLmNlbnRyb1Zpc3RhPWU7CiAgICB9LAogICAgY2VudHJhckVuTm9kb0J5SWQoaWROb2RvKSB7CiAgICAgIGNvbnNvbGUubG9nKGBDZW50cmFuZG8gZW4gbm9kbyBjb24gaWQgJHtpZE5vZG99YCk7CiAgICAgIHZhciBlbE5vZG8gPSB0aGlzLnRvZG9zTm9kb3MuZmluZCgobikgPT4gbi5pZCA9PT0gaWROb2RvKTsKICAgICAgaWYgKGVsTm9kbykgewogICAgICAgIHRoaXMuY2VudHJhckVuTm9kbyhlbE5vZG8pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLiRhcG9sbG8KICAgICAgICAucXVlcnkoewogICAgICAgICAgcXVlcnk6IGdxbGAKICAgICAgICAgICAgcXVlcnkgKCRpZE5vZG86IElEISkgewogICAgICAgICAgICAgIG5vZG8oaWROb2RvOiAkaWROb2RvKSB7CiAgICAgICAgICAgICAgICBpZAogICAgICAgICAgICAgICAgYXV0b0Nvb3JkcyB7CiAgICAgICAgICAgICAgICAgIHgKICAgICAgICAgICAgICAgICAgeQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgYCwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBpZE5vZG8sCiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHsgZGF0YTogeyBub2RvIH0gfSkgPT4gewogICAgICAgICAgY29uc29sZS5sb2coYFJlY2liaWRvIG5vZG8gYXPDrTogJHtKU09OLnN0cmluZ2lmeShub2RvKX1gKTsKICAgICAgICAgIHRoaXMuY2VudHJhckVuTm9kbyhub2RvKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJvcn1gKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBpbmljaWFNb3ZpbWllbnRvVG91Y2goZSkgewogICAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA9PT0gMikgewogICAgICAgIHZhciBkaXN0ID0gTWF0aC5oeXBvdCgKICAgICAgICAgIGUudG91Y2hlc1swXS5wYWdlWCAtIGUudG91Y2hlc1sxXS5wYWdlWCwKICAgICAgICAgIGUudG91Y2hlc1swXS5wYWdlWSAtIGUudG91Y2hlc1sxXS5wYWdlWQogICAgICAgICk7CiAgICAgICAgdGhpcy5sYXN0UGluY2hEaXN0YW5jZSA9IGRpc3Q7CiAgICAgICAgdGhpcy5waW5jaGluZyA9IHRydWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLnVsdGltb1RvdWNoWCA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WDsKICAgICAgdGhpcy51bHRpbW9Ub3VjaFkgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFk7CiAgICB9LAogICAgZmluVG91Y2goKSB7CiAgICAgIHRoaXMucGluY2hpbmcgPSBmYWxzZTsKICAgIH0sCiAgICBjYW1iaWFyQ29vcmRzTWFudWFsZXNOb2RvKGlkTm9kbywgY29vcmRzTWFudWFsZXMpIHsKICAgICAgaWYgKCF0aGlzLnVzdWFyaW9TdXBlcmFkbWluaXN0cmFkb3IgJiYgIXRoaXMudXN1YXJpb0FkbWluaXN0cmFkb3JBdGxhcykgewogICAgICAgIGNvbnNvbGUubG9nKGBObyBhdXRvcml6YWRvYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMudG9kb3NOb2Rvc1t0aGlzLnRvZG9zTm9kb3MuZmluZEluZGV4KChuKSA9PiBuLmlkID09IGlkTm9kbyldLmNvb3JkcyA9CiAgICAgICAgY29vcmRzTWFudWFsZXM7CiAgICAgIHRoaXMuJGFwb2xsbwogICAgICAgIC5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGdxbGAKICAgICAgICAgICAgbXV0YXRpb24gKCRpZE5vZG86IFN0cmluZywgJGNvb3Jkc01hbnVhbGVzOiBDb29yZHNJbnB1dCkgewogICAgICAgICAgICAgIHNldENvb3Jkc01hbnVhbGVzKAogICAgICAgICAgICAgICAgaWROb2RvOiAkaWROb2RvCiAgICAgICAgICAgICAgICBjb29yZHNNYW51YWxlczogJGNvb3Jkc01hbnVhbGVzCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBtb2RpZmljYWRvcyB7CiAgICAgICAgICAgICAgICAgIGlkCiAgICAgICAgICAgICAgICAgIGNvb3Jkc01hbnVhbGVzIHsKICAgICAgICAgICAgICAgICAgICB4CiAgICAgICAgICAgICAgICAgICAgeQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGNvb3JkcyB7CiAgICAgICAgICAgICAgICAgICAgeAogICAgICAgICAgICAgICAgICAgIHkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgYCwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBpZE5vZG8sCiAgICAgICAgICAgIGNvb3Jkc01hbnVhbGVzLAogICAgICAgICAgfSwKICAgICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuJHJlZnMuY2FudmFzZXMuY3JlYXJJbWFnZW5Ub2Rvc1ZpbmN1bG9zKCk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyb3J9YCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgZWxpbWluYXJOb2RvKGlkTm9kbykgewogICAgICBpZiAoIXRoaXMudXN1YXJpb1N1cGVyYWRtaW5pc3RyYWRvciAmJiAhdGhpcy51c3VhcmlvQWRtaW5pc3RyYWRvckF0bGFzKSB7CiAgICAgICAgY29uc29sZS5sb2coYE5vIGF1dG9yaXphZG9gKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCFjb25maXJtKCLCv1NlZ3VybyBkZSBxdWUgcXVpZXJlcyBlbGltaW5hciBlc3RlIG5vZG8/IikpIHJldHVybjsKICAgICAgY29uc29sZS5sb2coYGVudmlhbmRvIG11dGFjaW9uIGRlIGVsaW1pbmFyIG5vZG9gKTsKICAgICAgdGhpcy4kYXBvbGxvCiAgICAgICAgLm11dGF0ZSh7CiAgICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgICBtdXRhdGlvbiAoJGlkTm9kbzogSUQhKSB7CiAgICAgICAgICAgICAgZWxpbWluYXJOb2RvKGlkTm9kbzogJGlkTm9kbykKICAgICAgICAgICAgfQogICAgICAgICAgYCwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBpZE5vZG8sCiAgICAgICAgICB9LAogICAgICAgICAgdXBkYXRlKHN0b3JlLCB7IGRhdGE6IHsgZWxpbWluYXJOb2RvIH0gfSkgewogICAgICAgICAgICBjb25zb2xlLmxvZyhgUVVFUlk6ICR7SlNPTi5zdHJpbmdpZnkoUVVFUllfTk9ET1MpfWApOwogICAgICAgICAgICBpZiAoIWVsaW1pbmFyTm9kbykgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBOb2RvIG5vIGZ1ZSBlbGltaW5hZG9gKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgY2FjaGUgPSBzdG9yZS5yZWFkUXVlcnkoewogICAgICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9OT0RPUywKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBDYWNoZSBRVUVSWV9OT0RPUzogJHtKU09OLnN0cmluZ2lmeShjYWNoZSl9YCk7CiAgICAgICAgICAgIHZhciBudWV2b0NhY2hlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjYWNoZSkpOwogICAgICAgICAgICBjb25zdCBpbmRleE4gPSBudWV2b0NhY2hlLnRvZG9zTm9kb3MuZmluZEluZGV4KAogICAgICAgICAgICAgIChuKSA9PiBuLmlkID09IGlkTm9kbwogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoaW5kZXhOID4gLTEpIHsKICAgICAgICAgICAgICBudWV2b0NhY2hlLnRvZG9zTm9kb3Muc3BsaWNlKGluZGV4TiwgMSk7CiAgICAgICAgICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgICAgICAgICBxdWVyeTogUVVFUllfTk9ET1MsCiAgICAgICAgICAgICAgICBkYXRhOiBudWV2b0NhY2hlLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFbCBub2RvIG5vIGVzdGFiYSBwcmVzZW50ZWApOwogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBxdWl0YW5kbyBlbCBvYmpldG8gZGVsIGFycmF5LiAke2RhdGF9YCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgY3JlYXJOb2RvKHBvc2ljaW9uKSB7CiAgICAgIGlmICghdGhpcy51c3VhcmlvU3VwZXJhZG1pbmlzdHJhZG9yICYmICF0aGlzLnVzdWFyaW9BZG1pbmlzdHJhZG9yQXRsYXMpIHsKICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgdXN1YXJpbyBubyBhdXRvcml6YWRvYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKGBlbnZpYW5kbyB1bmEgbXV0YWNpw7NuIGRlIGNyZWFyIG5vZG9gKTsKCiAgICAgIGxldCBpbmZvTm9kbyA9IHsKICAgICAgICBjb29yZHNNYW51YWxlczogewogICAgICAgICAgeDogcG9zaWNpb24ueCwKICAgICAgICAgIHk6IHBvc2ljaW9uLnksCiAgICAgICAgfSwKICAgICAgICBjb29yZHM6IHsKICAgICAgICAgIHg6IHBvc2ljaW9uLngsCiAgICAgICAgICB5OiBwb3NpY2lvbi55LAogICAgICAgIH0sCiAgICAgICAgYXV0b0Nvb3JkczogewogICAgICAgICAgeDogcG9zaWNpb24ueCwKICAgICAgICAgIHk6IHBvc2ljaW9uLnksCiAgICAgICAgfSwKICAgICAgfTsKICAgICAgY29uc29sZS5sb2coYGVuIGxhcyBjb29yZGVuYWRhczogJHtwb3NpY2lvbi54fSwgJHtwb3NpY2lvbi55fSBgKTsKICAgICAgdGhpcy5wb3NpY2lvbkNyZWFuZG9Ob2RvID0gewogICAgICAgIHg6IHBvc2ljaW9uLngsCiAgICAgICAgeTogcG9zaWNpb24ueSwKICAgICAgfTsKICAgICAgdGhpcy4kYXBvbGxvCiAgICAgICAgLm11dGF0ZSh7CiAgICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgICBtdXRhdGlvbiAoJGluZm9Ob2RvOiBOb2RvQ29ub2NpbWllbnRvSW5wdXQpIHsKICAgICAgICAgICAgICBjcmVhck5vZG8oaW5mb05vZG86ICRpbmZvTm9kbykgewogICAgICAgICAgICAgICAgLi4uZnJhZ05vZG9Db25vY2ltaWVudG8KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHtmcmFnbWVudG9Ob2RvQ29ub2NpbWllbnRvfQogICAgICAgICAgYCwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBpbmZvTm9kbywKICAgICAgICAgIH0sCiAgICAgICAgfSkKICAgICAgICAudGhlbigoeyBkYXRhOiB7IGNyZWFyTm9kbyB9IH0pID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBDcmVhZG8gJHtjcmVhck5vZG8uaWR9YCk7CiAgICAgICAgICBjb25zdCBzdG9yZSA9IHRoaXMuJGFwb2xsby5wcm92aWRlci5kZWZhdWx0Q2xpZW50OwogICAgICAgICAgY29uc3QgY2FjaGUgPSBzdG9yZS5yZWFkUXVlcnkoewogICAgICAgICAgICBxdWVyeTogUVVFUllfTk9ET1MsCiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBudWV2b0NhY2hlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjYWNoZSkpOwogICAgICAgICAgY29uc29sZS5sb2coYDFgKTsKICAgICAgICAgIHZhciBsb3NOb2RvcyA9IG51ZXZvQ2FjaGUudG9kb3NOb2RvczsKICAgICAgICAgIGNvbnNvbGUubG9nKGAyYCk7CgogICAgICAgICAgY29uc3QgaW5kZXhOID0gbG9zTm9kb3MuZmluZEluZGV4KChuKSA9PiBuLmlkID09PSBjcmVhck5vZG8uaWQpOwogICAgICAgICAgaWYgKGluZGV4TiA+IC0xKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFbCBub2RvIHlhIGVzdGFiYSBlbiBjYWNow6lgKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxvc05vZG9zLnB1c2goY3JlYXJOb2RvKTsKICAgICAgICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgICAgICAgcXVlcnk6IFFVRVJZX05PRE9TLAogICAgICAgICAgICAgIGRhdGE6IG51ZXZvQ2FjaGUsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5wb3NpY2lvbkNyZWFuZG9Ob2RvID0gbnVsbDsKICAgICAgICAgIC8vdGhpcy4kcm91dGVyLnB1c2goIi9ub2RvQ29ub2NpbWllbnRvLyIrY3JlYXJOb2RvLmlkKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIHRoaXMucG9zaWNpb25DcmVhbmRvTm9kbyA9IG51bGw7CiAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IuIEU6ICR7ZXJyb3J9YCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgZGVzY2FyZ2FyQ2VudHJvVmlzdGEoKSB7CiAgICAgIGxldCBkaXMgPSB0aGlzOwogICAgICB0aGlzLiRhcG9sbG8KICAgICAgICAucXVlcnkoewogICAgICAgICAgcXVlcnk6IGdxbGAKICAgICAgICAgICAgcXVlcnkgewogICAgICAgICAgICAgIHlvIHsKICAgICAgICAgICAgICAgIGlkCiAgICAgICAgICAgICAgICBhdGxhcyB7CiAgICAgICAgICAgICAgICAgIGNlbnRyb1Zpc3RhIHsKICAgICAgICAgICAgICAgICAgICB4CiAgICAgICAgICAgICAgICAgICAgeQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICBgLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIGlkVXN1YXJpbzogdGhpcy4kc3RvcmUuc3RhdGUudXN1YXJpby5pZCwKICAgICAgICAgIH0sCiAgICAgICAgICBmZXRjaFBvbGljeTogIm5ldHdvcmstb25seSIsCiAgICAgICAgfSkKICAgICAgICAudGhlbihmdW5jdGlvbiAoeyBkYXRhOiB7IHlvIH0gfSkgewogICAgICAgICAgbGV0IGNvb3JkcyA9IHlvLmF0bGFzLmNlbnRyb1Zpc3RhOwogICAgICAgICAgZGlzLiRzZXQoZGlzLmNlbnRyb1Zpc3RhLCAieCIsIGNvb3Jkcy54KTsKICAgICAgICAgIGRpcy4kc2V0KGRpcy5jZW50cm9WaXN0YSwgInkiLCBjb29yZHMueSk7CiAgICAgICAgICBkaXMuJHN0b3JlLmNvbW1pdCgic2V0Q2VudHJvVmlzdGFBdGxhcyIsIGNvb3Jkcyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhgZXJyb3IgZmV0Y2hpbmcgY2VudHJvIHZpc3RhOiAke2Vycm9yfWApOwogICAgICAgIH0pOwogICAgfSwKICAgIHNlbGVjY2lvbk5vZG8obm9kbykgewogICAgICB0aGlzLmlkTm9kb1NlbGVjY2lvbmFkbyA9IG5vZG8uaWQ7CiAgICB9LAogICAgYXN5bmMgZWxpbWluYXJWaW5jdWxvKGFyZ3MpIHsKICAgICAgaWYgKCF0aGlzLnVzdWFyaW9TdXBlcmFkbWluaXN0cmFkb3IgJiYgIXRoaXMudXN1YXJpb0FkbWluaXN0cmFkb3JBdGxhcykgewogICAgICAgIGNvbnNvbGUubG9nKGBObyBhdXRvcml6YWRvYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKAogICAgICAgIGBlbGltaW5hbmRvIHVuIHZpbmN1bG8gZW50cmUgJHthcmdzLmlkTm9kb0Zyb219IHkgJHthcmdzLmlkTm9kb1RvfSBgCiAgICAgICk7CiAgICAgIGF3YWl0IHRoaXMuJGFwb2xsbwogICAgICAgIC5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGdxbGAKICAgICAgICAgICAgbXV0YXRpb24gKCRpZE5vZG9Gcm9tOiBJRCEsICRpZE5vZG9UbzogSUQhKSB7CiAgICAgICAgICAgICAgZWxpbWluYXJWaW5jdWxvRnJvbVRvKAogICAgICAgICAgICAgICAgaWRTb3VyY2U6ICRpZE5vZG9Gcm9tCiAgICAgICAgICAgICAgICBpZFRhcmdldDogJGlkTm9kb1RvCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBtb2RpZmljYWRvcyB7CiAgICAgICAgICAgICAgICAgIGlkCiAgICAgICAgICAgICAgICAgIHZpbmN1bG9zIHsKICAgICAgICAgICAgICAgICAgICBpZFJlZgogICAgICAgICAgICAgICAgICAgIHRpcG8KICAgICAgICAgICAgICAgICAgICByb2wKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgYCwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBpZE5vZG9Gcm9tOiBhcmdzLmlkTm9kb0Zyb20sCiAgICAgICAgICAgIGlkTm9kb1RvOiBhcmdzLmlkTm9kb1RvLAogICAgICAgICAgfSwKICAgICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHt9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBlcnJvcjogJHtlcnJvcn1gKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBkaWJ1amFyVmluY3Vsb3NHcmlzZXMoKSB7CiAgICAgIHRoaXMuYWN0dWFsaXphclZpbmN1bG9zR3Jpc2VzKys7CiAgICB9LAogICAgYXN5bmMgY3JlYXJWaW5jdWxvKGFyZ3MpIHsKICAgICAgaWYgKCF0aGlzLnVzdWFyaW9TdXBlcmFkbWluaXN0cmFkb3IgJiYgIXRoaXMudXN1YXJpb0FkbWluaXN0cmFkb3JBdGxhcykgewogICAgICAgIGNvbnNvbGUubG9nKGBObyBhdXRvcml6YWRvYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKGBjcmVhbmRvIHVuIHZpbmN1bG8gJHtKU09OLnN0cmluZ2lmeShhcmdzKX0gYCk7CiAgICAgIGF3YWl0IHRoaXMuJGFwb2xsbwogICAgICAgIC5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGdxbGAKICAgICAgICAgICAgbXV0YXRpb24gKCR0aXBvOiBTdHJpbmchLCAkaWROb2RvRnJvbTogSUQhLCAkaWROb2RvVG86IElEISkgewogICAgICAgICAgICAgIGNyZWFyVmluY3VsbygKICAgICAgICAgICAgICAgIHRpcG86ICR0aXBvCiAgICAgICAgICAgICAgICBpZFNvdXJjZTogJGlkTm9kb0Zyb20KICAgICAgICAgICAgICAgIGlkVGFyZ2V0OiAkaWROb2RvVG8KICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIG1vZGlmaWNhZG9zIHsKICAgICAgICAgICAgICAgICAgaWQKICAgICAgICAgICAgICAgICAgdmluY3Vsb3MgewogICAgICAgICAgICAgICAgICAgIGlkUmVmCiAgICAgICAgICAgICAgICAgICAgcm9sCiAgICAgICAgICAgICAgICAgICAgdGlwbwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICBgLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIHRpcG86ICJjb250aW51YWNpb24iLAogICAgICAgICAgICBpZE5vZG9Gcm9tOiBhcmdzLmlkTm9kb0Zyb20sCiAgICAgICAgICAgIGlkTm9kb1RvOiBhcmdzLmlkTm9kb1RvLAogICAgICAgICAgfSwKICAgICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHt9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBlcnJvcjogJHtlcnJvcn1gKTsKICAgICAgICB9KTsKICAgIH0sCgogICAgem9vbVZpc3RhKGRlbHRhWm9vbSkgewogICAgICB2YXIgbnVldm9ab29tID0gdGhpcy56b29tICsgZGVsdGFab29tOwogICAgICBpZiAobnVldm9ab29tIDwgdGhpcy5taW5ab29tKSB7CiAgICAgICAgdGhpcy56b29tID0gdGhpcy5taW5ab29tOwogICAgICB9IGVsc2UgaWYgKG51ZXZvWm9vbSA+IHRoaXMubWF4Wm9vbSkgewogICAgICAgIHRoaXMuem9vbSA9IHRoaXMubWF4Wm9vbTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnpvb20gPSBudWV2b1pvb207CiAgICAgIH0KCiAgICAgIC8vUGFuIHZpc3RhIGRlIGFjdWVyZG8gY29uIGxhIHBvc2ljacOzbiBkZWwgbW91c2UgcmVzcGVjdG8gZGVsIGF0bGFzCiAgICB9LAogICAgem9vbVdoZWVsKGUpIHsKICAgICAgaWYgKCF0aGlzLmhvdmVyZWQgfHwgIWUuY3RybEtleSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CgogICAgICB2YXIgY29udGVuZWRvciA9IHRoaXMuJGVsOwogICAgICBsZXQgcG9zQ29udGVuZWRvciA9IGNvbnRlbmVkb3IuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogICAgICBjb25zdCBwb3Nab29tID0gewogICAgICAgIHg6CiAgICAgICAgICBNYXRoLnJvdW5kKChlLmNsaWVudFggLSBwb3NDb250ZW5lZG9yLmxlZnQpIC8gdGhpcy5mYWN0b3Jab29tKSArCiAgICAgICAgICB0aGlzLmNlbnRyb1Zpc3RhLngsCiAgICAgICAgeToKICAgICAgICAgIE1hdGgucm91bmQoKGUuY2xpZW50WSAtIHBvc0NvbnRlbmVkb3IudG9wKSAvIHRoaXMuZmFjdG9yWm9vbSkgKwogICAgICAgICAgdGhpcy5jZW50cm9WaXN0YS55LAogICAgICB9OwoKICAgICAgLy8gY29uc3QgcHJvcG9yY2lvbmVzID0gewogICAgICAvLyAgIHg6CiAgICAgIC8vICAgICAocG9zWm9vbS54IC0gdGhpcy5jZW50cm9WaXN0YURlY2ltYWwueCkgLwogICAgICAvLyAgICAgKHBvc0NvbnRlbmVkb3Iud2lkdGggLyB0aGlzLmZhY3Rvclpvb20pLAogICAgICAvLyAgIHk6CiAgICAgIC8vICAgICAocG9zWm9vbS55IC0gdGhpcy5jZW50cm9WaXN0YURlY2ltYWwueSkgLwogICAgICAvLyAgICAgKHBvc0NvbnRlbmVkb3IuaGVpZ2h0IC8gdGhpcy5mYWN0b3Jab29tKSwKICAgICAgLy8gfTsKCiAgICAgIGNvbnN0IGZhY3Rvclpvb20gPSAwLjI7CiAgICAgIHRoaXMuem9vbVZpc3RhKC1NYXRoLnJvdW5kKGUuZGVsdGFZICogZmFjdG9yWm9vbSksIHsKICAgICAgICB4OiBwb3Nab29tLngsCiAgICAgICAgeTogcG9zWm9vbS55LAogICAgICB9KTsKICAgIH0sCiAgICBoaWRlWm9vbUluZm86IGRlYm91bmNlKGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5zaG93aW5nWm9vbUluZm8gPSBmYWxzZTsKICAgIH0sIDEwMDApLAogIH0sCiAgd2F0Y2g6IHsKICAgIG5vZG9TZWxlY2Npb25hZG86IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5hY3R1YWxpemFyVHJhem9zKys7CiAgICB9LAogICAgcm91dGU6IGZ1bmN0aW9uICh0bykgewogICAgICBjb25zb2xlLmxvZyhgY2FtYmlvIGRlIG5hdmVnYWNpw7NuIGEgJHt0by5wYXRofWApOwogICAgfSwKICAgIGlkTm9kb1RhcmdldChpZE5vZG9UYXJnZXQpIHsKICAgICAgaWYgKCFpZE5vZG9UYXJnZXQpIHsKICAgICAgICB0aGlzLmlkc05lY2VzYXJpb3NQYXJhVGFyZ2V0ID0gW107CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKGBpbmljaWFuZG8gYnVzcXVlZGEgZGUgcmVxdWVyaWRvcyBkZSBub2RvICR7aWROb2RvVGFyZ2V0fWApOwogICAgICB0aGlzLmlkc05lY2VzYXJpb3NQYXJhVGFyZ2V0ID0gdGhpcy5lbmNvbnRyYXJOb2Rvc05lY2VzYXJpb3NEZU5vZG8oCiAgICAgICAgaWROb2RvVGFyZ2V0LAogICAgICAgIFtdCiAgICAgICk7CiAgICB9LAogICAgem9vbSgpIHsKICAgICAgdGhpcy5zaG93aW5nWm9vbUluZm8gPSB0cnVlOwogICAgICB0aGlzLmhpZGVab29tSW5mbygpOwogICAgfSwKICB9LAogIG1vdW50ZWQoKSB7CiAgICAvLyBpZiAoIXRoaXMudXN1YXJpby5hdGxhcyB8fCAhdGhpcy51c3VhcmlvLmF0bGFzLmNlbnRyb1Zpc3RhKSB7CiAgICAvLyAgIGNvbnNvbGUubG9nKGBObyBoYWLDrWEgaW5mbyBkZSBjZW50cm8gdmlzdGEgZW4gbGEgc3RvcmUuIERlc2NhcmdhbmRvYCk7CiAgICAvLyAgIHRoaXMuZGVzY2FyZ2FyQ2VudHJvVmlzdGEoKTsKICAgIC8vICAgcmV0dXJuOwogICAgLy8gfQogICAgLy8gdGhpcy4kc2V0KHRoaXMuY2VudHJvVmlzdGFEZWNpbWFsLCAieCIsIHRoaXMudXN1YXJpby5hdGxhcy5jZW50cm9WaXN0YS54KTsKICAgIC8vIHRoaXMuJHNldCh0aGlzLmNlbnRyb1Zpc3RhRGVjaW1hbCwgInkiLCB0aGlzLnVzdWFyaW8uYXRsYXMuY2VudHJvVmlzdGEueSk7CgogICAgaWYgKHNjcmVlbi53aWR0aCA8IDYwMCkgewogICAgICB0aGlzLnpvb20gPSA3MDsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigid2hlZWwiLCB0aGlzLnpvb21XaGVlbCwgeyBwYXNzaXZlOiBmYWxzZSB9KTsKICB9LAogIHJlbW92ZWQoKSB7CiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigid2hlZWwiLCB0aGlzLnpvb21XaGVlbCk7CiAgfSwKICAvLyBiZWZvcmVSb3V0ZUxlYXZlKF8sIF9fLCBuZXh0KSB7CiAgLy8gICBjb25zb2xlLmxvZygKICAvLyAgICAgYGVudmlhbmRvIG51ZXZvIGNlbnRyb1Zpc3RhIHBhcmEgZWwgdXN1YXJpbyAkewogIC8vICAgICAgIHRoaXMudXN1YXJpby5pZAogIC8vICAgICB9LiBDZW50cm8gdmlzdGE6ICR7SlNPTi5zdHJpbmdpZnkodGhpcy5jZW50cm9WaXN0YSl9YAogIC8vICAgKTsKICAvLyAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0Q2VudHJvVmlzdGFBdGxhcyIsIHRoaXMuY2VudHJvVmlzdGEpOwoKICAvLyAgIHRoaXMuJGFwb2xsbwogIC8vICAgICAubXV0YXRlKHsKICAvLyAgICAgICBtdXRhdGlvbjogZ3FsYAogIC8vICAgICAgICAgbXV0YXRpb24oJGlkVXN1YXJpbzogSUQsICRjZW50cm9WaXN0YTogQ29vcmRzSW5wdXQpIHsKICAvLyAgICAgICAgICAgc2V0Q2VudHJvVmlzdGEoaWRVc3VhcmlvOiAkaWRVc3VhcmlvLCBjZW50cm9WaXN0YTogJGNlbnRyb1Zpc3RhKQogIC8vICAgICAgICAgfQogIC8vICAgICAgIGAsCiAgLy8gICAgICAgdmFyaWFibGVzOiB7CiAgLy8gICAgICAgICBpZFVzdWFyaW86IHRoaXMuJHN0b3JlLnN0YXRlLnVzdWFyaW8uaWQsCiAgLy8gICAgICAgICBjZW50cm9WaXN0YTogdGhpcy5jZW50cm9WaXN0YSwKICAvLyAgICAgICB9LAogIC8vICAgICB9KQogIC8vICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgLy8gICAgICAgbmV4dCgpOwogIC8vICAgICB9KQogIC8vICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgLy8gICAgICAgY29uc29sZS5sb2coYGVycm9yOiAke2Vycm9yfWApOwogIC8vICAgICAgIG5leHQoKTsKICAvLyAgICAgfSk7CiAgLy8gfSwKfTsK"},{"version":3,"sources":["AtlasConocimiento.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AtlasConocimiento.vue","sourceRoot":"src/components/atlasConocimiento","sourcesContent":["<template>\n  <div\n    class=\"atlasConocimiento\"\n    :style=\"{ overflowY: nodoAbierto ? 'scroll' : 'hidden' }\"\n    @mousedown.left.exact.stop=\"panningVista = true\"\n    @mouseenter=\"hovered = true\"\n    @mouseleave=\"hovered = false\"\n    @click=\"\n      idNodoMenuCx = null;\n      cerrarBusqueda++;\n    \"\n  >\n    <router-view\n      :yo=\"yo\"\n      :datosNodosRepasar=\"datosNodosRepasar\"\n      :datosNodosUrgentes=\"datosNodosUrgentes\"\n      @centrarEnNodo=\"centrarEnNodoById($event)\"\n    />\n    <transition name=\"fadeOut\">\n      <div v-show=\"showingZoomInfo\" id=\"infoZoom\">x{{ factorZoom }}</div>\n    </transition>\n    <div\n      id=\"menuContextual\"\n      :style=\"[offsetMenuContextual]\"\n      v-show=\"mostrandoMenuContextual\"\n    >\n      <div\n        class=\"botonMenuContextual\"\n        id=\"botonCrearNuevoNodo\"\n        :class=\"{ deshabilitado: posicionCreandoNodo }\"\n        v-if=\"usuarioAdministradorAtlas || usuarioProfe\"\n        @click=\"crearNodoEnMenuContextual\"\n      >\n        Crear Nodo de conocimiento\n      </div>\n    </div>\n\n    <div id=\"zonaNodoTarget\">\n      <div\n        class=\"boton\"\n        @click=\"\n          configurarNodoTarget(nodoSeleccionado ? nodoSeleccionado.id : null)\n        \"\n        v-show=\"!enviandoQueryTarget && (nodoSeleccionado || nodoTarget)\"\n        :title=\"\n          nodoSeleccionado\n            ? 'Rastrear ' + nodoSeleccionado.nombre\n            : yo.atlas.idNodoTarget\n            ? 'Dejar de rastrear'\n            : ''\n        \"\n        :class=\"{ deshabilitado: enviandoQueryTarget }\"\n      >\n        <img src=\"@/assets/iconos/target.png\" alt=\"Target\" />\n      </div>\n      <loading texto=\"\" v-show=\"enviandoQueryTarget\" />\n      <div\n        id=\"nombreNodoTarget\"\n        v-if=\"nodoTarget\"\n        @click=\"centrarEnNodo(nodoTarget)\"\n      >\n        {{ nodoTarget.nombre }}\n      </div>\n    </div>\n\n    <div\n      id=\"botonCallingPosiciones\"\n      v-if=\"usuarioSuperadministrador && usuario.username == 'juanMamian'\"\n      @click.stop=\"iniciarCallingPosiciones\"\n      :class=\"{ deshabilitado: callingPosiciones }\"\n      :style=\"[\n        { backgroundColor: callingPosiciones ? 'green' : 'transparent' },\n      ]\"\n    ></div>\n    <buscador-nodos-conocimiento\n      @nodoSeleccionado=\"centrarEnNodo\"\n      ref=\"buscadorNodos\"\n      :cerrarBusqueda=\"cerrarBusqueda\"\n    />\n\n    <panel-conjuntos-nodos\n      ref=\"panelConjuntosNodos\"\n      :yo=\"yo\"\n      :todosNodos=\"todosNodos\"\n      :modoAtlas=\"modoAtlas\"\n      @centrarEnNodo=\"centrarEnNodo(todosNodos.find((n) => n.id == $event))\"\n    />\n\n    <div\n      id=\"contenedorDiagrama\"\n      ref=\"contenedorDiagrama\"\n      @contextmenu.self.exact.prevent=\"abrirMenuContextual\"\n      @mouseup.left.self=\"clickFondoAtlas\"\n    >\n      <div id=\"contenedorVinculosNodos\" :style=\"[offsetContenedorNodos]\">\n        <enlaces-nodo-conocimiento\n          v-for=\"nodo of nodosConRequerimentos\"\n          :key=\"nodo.id\"\n          :yo=\"yo\"\n          :idNodoSeleccionado=\"idNodoSeleccionado\"\n          :esteNodo=\"nodo\"\n          :todosNodos=\"todosNodos\"\n          :factorZoom=\"factorZoom\"\n          :esquinasDiagrama=\"esquinasDiagrama\"\n          :nodoSeleccionado=\"nodoSeleccionado\"\n          :redibujarEnlaces=\"redibujarEnlacesNodos\"\n          :idsTodosNodosRender=\"idsTodosNodosRender\"\n          :callingPosiciones=\"callingPosiciones\"\n        />\n      </div>\n      <div\n        id=\"contenedorNodos\"\n        ref=\"contenedorNodos\"\n        :style=\"[offsetContenedorNodos]\"\n      >\n        <loading\n          texto=\"\"\n          v-show=\"posicionCreandoNodo\"\n          style=\"position: absolute\"\n          :style=\"[offsetLoadingCreandoNodo]\"\n        />\n        <nodo-conocimiento\n          :nodoSeleccionado=\"nodoSeleccionado\"\n          :todosNodos=\"todosNodos\"\n          :idNodoMenuCx=\"idNodoMenuCx\"\n          :usuarioAdministradorAtlas=\"usuarioAdministradorAtlas\"\n          :yo=\"yo\"\n          :modoAtlas=\"modoAtlas\"\n          :key=\"nodo.id\"\n          v-for=\"nodo of nodosRender\"\n          :esteNodo=\"nodo\"\n          :esquinasDiagrama=\"esquinasDiagrama\"\n          :centroVista=\"centroVista\"\n          :esNodoObjetivo=\"idsNodosObjetivos.includes(nodo.id)\"\n          :esTarget=\"idNodoTarget == nodo.id\"\n          :idsNodosAprendidos=\"idsNodosAprendidos\"\n          :idsNodosEstudiados=\"idsNodosEstudiados\"\n          :idsNodosFrescos=\"idsNodosFrescos\"\n          :idsNodosPresentesCabeza=\"idsNodosPresentesCabeza\"\n          :factorZoom=\"factorZoom\"\n          :seleccionado=\"idNodoSeleccionado === nodo.id\"\n          :escondido=\"\n            idNodoTarget &&\n            !idsNecesariosParaTarget.includes(nodo.id) &&\n            idNodoTarget != nodo.id\n          \"\n          :configuracionAtlas=\"configuracionAtlas\"\n          :callingPosiciones=\"callingPosiciones\"\n          @click.right.native.exact.stop.prevent=\"idNodoMenuCx = nodo.id\"\n          @click.native.stop=\"seleccionNodo(nodo)\"\n          @creacionVinculo=\"crearVinculo\"\n          @eliminacionVinculo=\"eliminarVinculo\"\n          @cambioDePosicionManual=\"cambiarCoordsManualesNodo\"\n          @eliminar=\"eliminarNodo\"\n          @cambieEstadoObjetivo=\"setEstadoObjetivoNodoCache($event, nodo.id)\"\n          @tengoNuevoValorAprendido=\"setNodoAprendidoCache($event, nodo.id)\"\n        />\n      </div>\n    </div>\n\n    <div id=\"barraInferior\">\n      <div\n        class=\"boton\"\n        title=\"Mostrar colecciones\"\n        @click=\"$refs.panelConjuntosNodos.abierto = true\"\n      >\n        <img src=\"@/assets/iconos/userNodes.png\" alt=\"Nodos de usuario\" />\n      </div>\n\n      <div\n        class=\"boton\"\n        :title=\"\n          'Cambiar a modo ' + modoAtlas === 'experto' ? 'estudiante' : 'experto'\n        \"\n        :class=\"{ deshabilitado: enviandoQueryModo }\"\n        @click=\"setModo(modoAtlas === 'estudiante' ? 'experto' : 'estudiante')\"\n      >\n        <img\n          src=\"@/assets/iconos/teacher.svg\"\n          v-if=\"modoAtlas === 'experto'\"\n          alt=\"Experto\"\n        />\n        <img\n          src=\"@/assets/iconos/estudiante.png\"\n          v-if=\"modoAtlas === 'estudiante'\"\n          alt=\"Estudiante\"\n        />\n      </div>\n\n      <div\n        class=\"boton\"\n        title=\"Mostrar temas para repasar\"\n        @click=\"$router.push({ name: 'ventanaRepasos' })\"\n      >\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n          <path\n            d=\"M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z\"\n            :fill=\"\n              datosNodosUrgentes.length > 0\n                ? 'var(--atlasConocimientoRepaso)'\n                : ''\n            \"\n          />\n        </svg>\n      </div>\n    </div>\n\n    <loading\n      id=\"simboloDescargandoNodos\"\n      v-show=\"!nodosDescargados\"\n      texto=\"descargando nodos de conocimiento\"\n    />\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport NodoConocimiento from \"./NodoConocimiento.vue\";\nimport BuscadorNodosConocimiento from \"./BuscadorNodosConocimiento.vue\";\nimport Loading from \"../utilidades/Loading.vue\";\nimport PanelConjuntosNodos from \"./PanelConjuntosNodos.vue\";\nimport EnlacesNodoConocimiento from \"./EnlacesNodoConocimiento.vue\";\nimport { fragmentoDatoNodoConocimiento } from \"./fragsAtlasConocimiento\";\nconst debounce = require(\"debounce\");\n\nconst fragmentoNodoConocimiento = gql`\n  fragment fragNodoConocimiento on NodoConocimiento {\n    id\n    nombre\n    descripcion\n    expertos\n    clases {\n      id\n      nombre\n      idExperto\n      interesados\n    }\n    coordsManuales {\n      x\n      y\n    }\n    coords {\n      x\n      y\n    }\n    autoCoords {\n      x\n      y\n    }\n    centroMasa {\n      x\n      y\n    }\n    stuck\n    angulo\n    puntaje\n    vinculos {\n      id\n      idRef\n      rol\n      tipo\n    }\n    fuerzaCentroMasa {\n      fuerza\n      direccion\n    }\n    fuerzaColision {\n      fuerza\n      direccion\n    }\n  }\n`;\n\nconst QUERY_NODOS = gql`\n  query todosNodos {\n    todosNodos {\n      ...fragNodoConocimiento\n    }\n  }\n  ${fragmentoNodoConocimiento}\n`;\n\nexport const QUERY_DATOS_USUARIO_NODOS = gql`\n  query {\n    yo {\n      id\n      atlas {\n        datosNodos {\n          ...fragDatoNodoConocimiento\n        }\n        configuracion {\n          modo\n        }\n        idNodoTarget\n        colecciones {\n          id\n          nombre\n          idsNodos\n          nodos {\n            id\n            nombre\n          }\n        }\n      }\n    }\n  }\n  ${fragmentoDatoNodoConocimiento}\n`;\n\nexport default {\n  components: {\n    NodoConocimiento,\n    BuscadorNodosConocimiento,\n    Loading,\n    PanelConjuntosNodos,\n    EnlacesNodoConocimiento,\n  },\n  name: \"AtlasConocimiento\",\n  apollo: {\n    todosNodos: {\n      query: QUERY_NODOS,\n      result: function () {\n        this.dibujarVinculosGrises();\n      },\n      pollInterval() {\n        return this.callingPosiciones ? 5000 : null;\n      },\n      update({ todosNodos }) {\n        this.nodosDescargados = true;\n        var nuevoTodosNodos = JSON.parse(JSON.stringify(todosNodos));\n        nuevoTodosNodos.forEach((nodo) => {\n          nodo.coordsManuales = nodo.autoCoords;\n          nodo.coords = nodo.autoCoords;\n        });\n        return nuevoTodosNodos;\n      },\n      fetchPolicy() {\n        if (process.env.NODE_ENV === \"production\") {\n          return \"cache-first\";\n        } else {\n          return \"cache-and-network\";\n        }\n      },\n    },\n    yo: {\n      query: QUERY_DATOS_USUARIO_NODOS,\n      skip() {\n        return !this.usuarioLogeado || this.todosNodos.length < 1;\n      },\n    },\n    configuracionAtlas: {\n      query: gql`\n        query ($nombreAtlas: String!) {\n          configuracionAtlas(nombreAtlas: $nombreAtlas) {\n            id\n            posicionando\n          }\n        }\n      `,\n      variables: {\n        nombreAtlas: \"conocimiento\",\n      },\n      fetchPolicy: \"network-only\",\n    },\n  },\n  data() {\n    return {\n      configuracionAtlas: {\n        posicionando: false,\n      },\n      hovered: false,\n      todosNodos: [],\n      nodosDescargados: false,\n      posicionCreandoNodo: null,\n      idNodoSeleccionado: null,\n      idNodoMenuCx: null,\n      idsNecesariosParaTarget: [],\n      enviandoQueryModo: false,\n      modoAtlas: \"estudiante\",\n      enviandoQueryTarget: false,\n\n      redibujarEnlacesNodos: 0,\n\n      yo: {\n        atlas: {\n          datosNodos: [],\n          configuracion: {\n            modo: \"estudiante\",\n          },\n        },\n      },\n\n      centroVistaDecimal: {\n        x: 218,\n        y: 39,\n      },\n      showingZoomInfo: false,\n      zoom: 80,\n      minZoom: 20,\n      maxZoom: 200,\n      pinching: false,\n      lastPinchDistance: 0,\n      actualizarTrazos: 0,\n      panningVista: false,\n      vistaPanned: false,\n\n      actualizarVinculosGrises: 0,\n\n      ultimoTouchX: 0,\n      ultimoTouchY: 0,\n\n      cerrarBusqueda: 0,\n\n      callingPosiciones: false,\n\n      mostrandoMenuContextual: false,\n      offsetMenuContextual: {\n        top: \"0px\",\n        left: \"0px\",\n      },\n      enviandoQueryConfiguracionAtlas: false,\n    };\n  },\n  computed: {\n    idsNodosObjetivos() {\n      if (!this.yo || !this.yo.atlas || !this.yo.atlas.datosNodos) {\n        return [];\n      }\n      return this.yo.atlas.datosNodos\n        .filter((n) => n.objetivo == true)\n        .map((n) => n.idNodo);\n    },\n    nodosObjetivo() {\n      if (!this.todosNodos) return [];\n      return this.todosNodos.filter((n) =>\n        this.idsNodosObjetivos.includes(n.id)\n      );\n    },\n    nodoSeleccionado: function () {\n      if (!this.idNodoSeleccionado) {\n        return null;\n      }\n      return this.todosNodos.find((n) => n.id === this.idNodoSeleccionado);\n    },\n    idUsuario: function () {\n      return this.$store.state.usuario.id;\n    },\n    usuarioAdministradorAtlas: function () {\n      if (!this.$store.state.usuario.permisos) return false;\n      return this.$store.state.usuario.permisos.includes(\"atlasAdministrador\")\n        ? true\n        : false;\n    },\n    idNodoTarget() {\n      if (!this.yo || !this.yo.atlas) return null;\n      return this.yo.atlas.idNodoTarget;\n    },\n    nodoTarget() {\n      if (!this.idNodoTarget) return null;\n      return this.todosNodos.find((n) => n.id === this.idNodoTarget);\n    },\n    idsNodosAprendidos() {\n      return this.yo.atlas.datosNodos\n        .filter((n) => n.aprendido == true)\n        .map((n) => n.idNodo);\n    },\n    datosNodosEstudiados() {\n      return this.yo.atlas.datosNodos.filter(\n        (n) => !n.aprendido && n.estudiado\n      );\n    },\n    idsNodosEstudiados() {\n      return this.datosNodosEstudiados.map((ne) => ne.idNodo);\n    },\n    datosNodosRepasar() {\n      if (!this.yo || !this.yo.atlas || !this.yo.atlas.datosNodos) {\n        return [];\n      }\n\n      return this.yo.atlas.datosNodos.filter(\n        (dn) =>\n          !dn.aprendido &&\n          dn.estudiado &&\n          dn.iteracionesRepaso &&\n          dn.iteracionesRepaso.length > 0\n      );\n    },\n    datosNodosUrgentes() {\n      return this.datosNodosRepasar.filter((dn) => {\n        const pasado =\n          new Date(dn.estudiado).getTime() + dn.iteracionesRepaso[0].intervalo <\n          Date.now();\n        return pasado;\n      });\n    },\n    datosNodosFrescos() {\n      return this.datosNodosEstudiados.filter((dn) => {\n        const dateEstudiado = new Date(dn.estudiado);\n        if (!dn.iteracionesRepaso || dn.iteracionesRepaso.length < 1) {\n          return true;\n        }\n        return (\n          Date.now() <\n          dateEstudiado.getTime() + dn.iteracionesRepaso[0].intervalo\n        );\n      });\n    },\n    idsNodosFrescos() {\n      return this.datosNodosFrescos.map((nf) => nf.idNodo);\n    },\n    idsNodosPresentesCabeza() {\n      return this.idsNodosFrescos\n        .filter((idNe) => !this.idsNodosAprendidos.includes(idNe))\n        .concat(this.idsNodosAprendidos);\n    },\n    centroVista() {\n      return {\n        x: Math.round(this.centroVistaDecimal.x),\n        y: Math.round(this.centroVistaDecimal.y),\n      };\n    },\n    factorZoom() {\n      return Number((this.zoom / 100).toFixed(2));\n    },\n    esquinasDiagrama() {\n      const maxX = this.todosNodos.reduce(\n        (acc, n) => (n.autoCoords.x > acc ? n.autoCoords.x : acc),\n        0\n      );\n      const maxY = this.todosNodos.reduce(\n        (acc, n) => (n.autoCoords.y > acc ? n.autoCoords.y : acc),\n        0\n      );\n      const minX = this.todosNodos.reduce(\n        (acc, n) => (n.autoCoords.x < acc ? n.autoCoords.x : acc),\n        0\n      );\n      const minY = this.todosNodos.reduce(\n        (acc, n) => (n.autoCoords.y < acc ? n.autoCoords.y : acc),\n        0\n      );\n\n      return {\n        x1: minX,\n        y1: minY,\n\n        x2: maxX,\n        y2: maxY,\n      };\n    },\n    offsetContenedorNodos() {\n      const ancho = this.esquinasDiagrama.x2 - this.esquinasDiagrama.x1;\n      const alto = this.esquinasDiagrama.y2 - this.esquinasDiagrama.y1;\n      return {\n        // left: -(this.centroVista.x * this.factorZoom) + \"px\",\n        // top: -(this.centroVista.y * this.factorZoom) + \"px\",\n\n        width: ancho * this.factorZoom + \"px\",\n        height: alto * this.factorZoom + \"px\",\n      };\n    },\n    nodosConRequerimentos() {\n      var nr = this.todosNodos.filter((n) => n.vinculos.length > 0);\n\n      return nr;\n    },\n    nodosRender() {\n      if (this.idNodoTarget) {\n        return this.todosNodos\n          .filter((n) => this.idsNecesariosParaTarget.includes(n.id))\n          .concat([this.todosNodos.find((n) => this.idNodoTarget === n.id)]);\n      }\n      return this.todosNodos;\n    },\n    idsTodosNodosRender() {\n      return this.nodosRender.map((n) => n.id);\n    },\n    offsetLoadingCreandoNodo() {\n      if (!this.posicionCreandoNodo) {\n        return null;\n      }\n      const left =\n        (this.posicionCreandoNodo.x - this.esquinasDiagrama.x1) *\n        this.factorZoom;\n      const top =\n        (this.posicionCreandoNodo.y - this.esquinasDiagrama.y1) *\n        this.factorZoom;\n      return {\n        left: left + \"px\",\n        top: top + \"px\",\n      };\n    },\n    nodoAbierto() {\n      console.log(\"Verificando path name\");\n      console.log(this.$route.name);\n\n      return this.$route.name === \"visorNodoConocimiento\";\n    },\n    nodosConectadosAlSeleccionado() {\n      if (!this.nodoSeleccionado) return [];\n      return this.todosNodos.filter((n) =>\n        this.nodoSeleccionado.vinculos.some((v) => v.idRef === n.id)\n      );\n    },\n  },\n  methods: {\n    iniciarCallingPosiciones() {\n      var ciclos = prompt(\"¿Cuantos ciclos?\");\n      if (isNaN(ciclos)) {\n        return;\n      }\n\n      ciclos = Math.round(ciclos);\n      if (ciclos < 1) {\n        return;\n      }\n      console.log(`Enviando reposicionamiento de ${ciclos} ciclos`);\n      this.callingPosiciones = true;\n\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($ciclos: Int!) {\n              posicionarNodosConocimientoByFuerzas(ciclos: $ciclos)\n            }\n          `,\n          variables: {\n            ciclos,\n          },\n        })\n        .then(() => {\n          this.callingPosiciones = false;\n        })\n        .catch((error) => {\n          this.callingPosiciones = false;\n          console.log(`Error: ${error}`);\n        });\n    },\n    togglePosicionamiento() {\n      this.enviandoQueryConfiguracionAtlas = true;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($nombreAtlas: String!) {\n              togglePosicionamientoAutomaticoAtlas(nombreAtlas: $nombreAtlas) {\n                id\n                posicionando\n              }\n            }\n          `,\n          variables: {\n            nombreAtlas: \"conocimiento\",\n          },\n        })\n        .then(() => {\n          this.enviandoQueryConfiguracionAtlas = false;\n        })\n        .catch(() => {\n          this.enviandoQueryConfiguracionAtlas = false;\n        });\n    },\n    abrirMenuContextual(e) {\n      let posDiagrama = this.$refs.contenedorDiagrama.getBoundingClientRect();\n\n      let topClick = Math.round(e.pageY - posDiagrama.top);\n      let leftClick = Math.round(e.pageX - posDiagrama.left);\n\n      this.$set(this.offsetMenuContextual, \"top\", topClick + \"px\");\n      this.$set(this.offsetMenuContextual, \"left\", leftClick + \"px\");\n      this.mostrandoMenuContextual = true;\n      //this.crearNodo({x: leftClick, y: topClick});\n    },\n    crearNodoEnMenuContextual() {\n      const posContenedorNodos =\n        this.$refs.contenedorNodos.getBoundingClientRect();\n      const distanciaLeftPx =\n        parseInt(this.offsetMenuContextual.left) -\n        parseInt(posContenedorNodos.left);\n      const distanciaTopPx =\n        parseInt(this.offsetMenuContextual.top) -\n        (parseInt(posContenedorNodos.top) - parseInt(this.$el.offsetTop));\n\n      const posPxX = distanciaLeftPx;\n      const posPxY = distanciaTopPx;\n\n      console.log(`xPix: ${parseInt(this.offsetMenuContextual.left)}`);\n      console.log(\n        `posXContenedorNodos: ${parseInt(posContenedorNodos.left)}, ${\n          posContenedorNodos.top\n        }`\n      );\n      console.log(`distanciaLeftPx: ${distanciaLeftPx}`);\n      console.log(`distanciaTopPx: ${distanciaTopPx}`);\n      console.log(\n        `Scroll x contenedorDiagrama: ${this.$refs.contenedorDiagrama.scrollLeft}`\n      );\n\n      var posicionNuevoNodo = {\n        x: parseInt(posPxX / this.factorZoom + this.esquinasDiagrama.x1),\n        y: parseInt(posPxY / this.factorZoom + this.esquinasDiagrama.y1),\n      };\n\n      console.log(`Creando nuevo nodo en ${JSON.stringify(posicionNuevoNodo)}`);\n\n      this.crearNodo(posicionNuevoNodo);\n    },\n    encontrarNodosNecesariosDeNodo(idNodo, listaTotal) {\n      const elNodo = this.todosNodos.find((n) => n.id == idNodo);\n      if (!elNodo) {\n        return listaTotal;\n      }\n      const necesarios = elNodo.vinculos\n        .filter((v) => v.rol == \"target\")\n        .map((v) => v.idRef);\n      necesarios.forEach((necesario) => {\n        if (!listaTotal.includes(necesario)) {\n          listaTotal.push(necesario);\n          listaTotal = this.encontrarNodosNecesariosDeNodo(\n            necesario,\n            listaTotal\n          );\n        }\n      });\n      return listaTotal;\n    },\n    clickFondoAtlas() {\n      // console.log(`Click en el fondo del atlas. Route name: ${this.$route.name}`);\n      if (this.$route.name != \"atlas\") {\n        this.$router.push({ name: \"atlas\" });\n        return;\n      }\n      if (!this.vistaPanned) this.idNodoSeleccionado = null;\n      this.panningVista = false;\n      this.vistaPanned = false;\n      this.$refs.panelConjuntosNodos.abierto = false;\n      this.mostrandoMenuContextual = false;\n    },\n    setEstadoObjetivoNodoCache(nuevoEstado, idNodo) {\n      console.log(\n        `Seting en cache al nodo ${idNodo} con estado objetivo: ${nuevoEstado}`\n      );\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n\n      var indexN = nuevoCache.yo.atlas.datosNodos.findIndex(\n        (n) => n.idNodo == idNodo\n      );\n      if (indexN > -1) {\n        nuevoCache.yo.atlas.datosNodos[indexN].objetivo = nuevoEstado;\n      } else {\n        console.log(`No estaba en caché. Pushing`);\n        nuevoCache.yo.atlas.datosNodos.push({\n          __typename: \"DatoNodoUsuario\",\n          idNodo,\n          objetivo: nuevoEstado,\n          aprendido: false,\n        });\n      }\n      store.writeQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n        data: nuevoCache,\n      });\n    },\n    setNodoAprendidoCache(nuevoEstado, idNodo) {\n      console.log(\n        `Seting en cache al nodo ${idNodo} con estado aprendido: ${nuevoEstado}`\n      );\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      var indexN = nuevoCache.yo.atlas.datosNodos.findIndex(\n        (n) => n.idNodo == idNodo\n      );\n      if (indexN > -1) {\n        nuevoCache.yo.atlas.datosNodos[indexN].aprendido = nuevoEstado;\n      } else {\n        console.log(`No estaba en caché. Pushing`);\n        nuevoCache.yo.atlas.datosNodos.push({\n          __typename: \"DatoNodoUsuario\",\n          idNodo,\n          objetivo: false,\n          aprendido: nuevoEstado,\n        });\n      }\n      store.writeQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n        data: nuevoCache,\n      });\n    },\n    setNodoTargetCache(idNodo) {\n      console.log(`Seting en cache al nodo ${idNodo} como target`);\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      nuevoCache.yo.atlas.idNodoTarget = idNodo;\n      store.writeQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n        data: nuevoCache,\n      });\n    },\n    setModo(modo) {\n      if (!this.usuarioLogeado) return;\n      this.modoAtlas = modo;\n      // this.enviandoQueryModo = true;\n\n      // this.$apollo\n      //   .mutate({\n      //     mutation: gql`\n      //       mutation ($idUsuario: ID!, $nuevoModo: String!) {\n      //         setModoUsuarioAtlas(idUsuario: $idUsuario, nuevoModo: $nuevoModo){\n      //             id\n      //             atlas{\n      //                 configuracion{\n      //                     modo\n      //                 }\n      //             }\n      //         }\n      //       }\n      //     `,\n      //     variables: {\n      //       idUsuario: this.usuario.id,\n      //       nuevoModo: modo,\n      //     },\n      //   })\n      //   .then(() => {\n      //     this.enviandoQueryModo = false;\n\n      //   })\n      //   .catch((error) => {\n      //     this.enviandoQueryModo = false;\n      //     console.log(`Error: ${error}`);\n      //   });\n    },\n    configurarNodoTarget(idNodo) {\n      this.enviandoQueryTarget = true;\n\n      console.log(`Configurando nodo target`);\n      if (!idNodo || idNodo === this.idNodoTarget) {\n        console.log(`Nulificando`);\n        setTimeout(()=>{\n        this.nulificarNodoTarget();\n\n        }, 100);\n      } else {\n        setTimeout(()=>{\n\n        this.setNodoTarget(idNodo);\n        }, 100);\n      }\n    },\n    setNodoTarget(idNodo) {\n      if (!idNodo) return;\n      if (this.idNodoTarget == idNodo) {\n        return;\n      }\n\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      nuevoCache.yo.atlas.idNodoTarget = idNodo;\n      store.writeQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n        data: nuevoCache,\n      });\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($idNodo: ID!) {\n              setNodoAtlasTarget(idNodo: $idNodo)\n            }\n          `,\n          variables: {\n            idNodo,\n          },\n        })\n        .then(() => {\n          this.enviandoQueryTarget = false;\n        })\n        .catch((error) => {\n          this.enviandoQueryTarget = false;\n          console.log(`Error: ${error}`);\n        });\n    },\n    nulificarNodoTarget() {\n      console.log(`Nulificando nodo target`);\n      this.enviandoQueryTarget = true;\n\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n      nuevoCache.yo.atlas.idNodoTarget = null;\n      // nuevoCache.yo.atlas.centroVista = {x:100, y:100};\n      store.writeQuery({\n        query: QUERY_DATOS_USUARIO_NODOS,\n        data: nuevoCache,\n      });\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation {\n              nulificarNodoTargetUsuarioAtlas\n            }\n          `,\n        })\n        .then(() => {\n          this.enviandoQueryTarget = false;\n        })\n        .catch((error) => {\n          this.enviandoQueryTarget = false;\n          console.log(`Error: ${error}`);\n        });\n    },\n    centrarEnNodo(n) {\n      const posDiagrama = this.$refs.contenedorDiagrama.getBoundingClientRect();\n      const posNodo = {\n        x: (n.autoCoords.x - this.esquinasDiagrama.x1) * this.factorZoom,\n        y: (n.autoCoords.y - this.esquinasDiagrama.y1) * this.factorZoom,\n      };\n\n      const posIdealScroll = {\n        x: parseInt(posNodo.x - posDiagrama.width / 2),\n        y: parseInt(posNodo.y - posDiagrama.height / 2),\n      };\n\n      this.$refs.contenedorDiagrama.scrollLeft = posIdealScroll.x;\n      this.$refs.contenedorDiagrama.scrollTop = posIdealScroll.y;\n\n      this.seleccionNodo(n);\n      //this.centroVista=e;\n    },\n    centrarEnNodoById(idNodo) {\n      console.log(`Centrando en nodo con id ${idNodo}`);\n      var elNodo = this.todosNodos.find((n) => n.id === idNodo);\n      if (elNodo) {\n        this.centrarEnNodo(elNodo);\n        return;\n      }\n      this.$apollo\n        .query({\n          query: gql`\n            query ($idNodo: ID!) {\n              nodo(idNodo: $idNodo) {\n                id\n                autoCoords {\n                  x\n                  y\n                }\n              }\n            }\n          `,\n          variables: {\n            idNodo,\n          },\n        })\n        .then(({ data: { nodo } }) => {\n          console.log(`Recibido nodo así: ${JSON.stringify(nodo)}`);\n          this.centrarEnNodo(nodo);\n        })\n        .catch((error) => {\n          console.log(`Error: ${error}`);\n        });\n    },\n    iniciaMovimientoTouch(e) {\n      if (e.touches.length === 2) {\n        var dist = Math.hypot(\n          e.touches[0].pageX - e.touches[1].pageX,\n          e.touches[0].pageY - e.touches[1].pageY\n        );\n        this.lastPinchDistance = dist;\n        this.pinching = true;\n        return;\n      }\n\n      this.ultimoTouchX = e.changedTouches[0].clientX;\n      this.ultimoTouchY = e.changedTouches[0].clientY;\n    },\n    finTouch() {\n      this.pinching = false;\n    },\n    cambiarCoordsManualesNodo(idNodo, coordsManuales) {\n      if (!this.usuarioSuperadministrador && !this.usuarioAdministradorAtlas) {\n        console.log(`No autorizado`);\n        return;\n      }\n      this.todosNodos[this.todosNodos.findIndex((n) => n.id == idNodo)].coords =\n        coordsManuales;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($idNodo: String, $coordsManuales: CoordsInput) {\n              setCoordsManuales(\n                idNodo: $idNodo\n                coordsManuales: $coordsManuales\n              ) {\n                modificados {\n                  id\n                  coordsManuales {\n                    x\n                    y\n                  }\n                  coords {\n                    x\n                    y\n                  }\n                }\n              }\n            }\n          `,\n          variables: {\n            idNodo,\n            coordsManuales,\n          },\n        })\n        .then(() => {\n          this.$refs.canvases.crearImagenTodosVinculos();\n        })\n        .catch((error) => {\n          console.log(`Error: ${error}`);\n        });\n    },\n    eliminarNodo(idNodo) {\n      if (!this.usuarioSuperadministrador && !this.usuarioAdministradorAtlas) {\n        console.log(`No autorizado`);\n        return;\n      }\n      if (!confirm(\"¿Seguro de que quieres eliminar este nodo?\")) return;\n      console.log(`enviando mutacion de eliminar nodo`);\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($idNodo: ID!) {\n              eliminarNodo(idNodo: $idNodo)\n            }\n          `,\n          variables: {\n            idNodo,\n          },\n          update(store, { data: { eliminarNodo } }) {\n            console.log(`QUERY: ${JSON.stringify(QUERY_NODOS)}`);\n            if (!eliminarNodo) {\n              console.log(`Nodo no fue eliminado`);\n              return;\n            }\n            const cache = store.readQuery({\n              query: QUERY_NODOS,\n            });\n            console.log(`Cache QUERY_NODOS: ${JSON.stringify(cache)}`);\n            var nuevoCache = JSON.parse(JSON.stringify(cache));\n            const indexN = nuevoCache.todosNodos.findIndex(\n              (n) => n.id == idNodo\n            );\n            if (indexN > -1) {\n              nuevoCache.todosNodos.splice(indexN, 1);\n              store.writeQuery({\n                query: QUERY_NODOS,\n                data: nuevoCache,\n              });\n            } else {\n              console.log(`El nodo no estaba presente`);\n            }\n          },\n        })\n        .then((data) => {\n          console.log(`quitando el objeto del array. ${data}`);\n        });\n    },\n    crearNodo(posicion) {\n      if (!this.usuarioSuperadministrador && !this.usuarioAdministradorAtlas) {\n        console.log(`Error usuario no autorizado`);\n        return;\n      }\n      console.log(`enviando una mutación de crear nodo`);\n\n      let infoNodo = {\n        coordsManuales: {\n          x: posicion.x,\n          y: posicion.y,\n        },\n        coords: {\n          x: posicion.x,\n          y: posicion.y,\n        },\n        autoCoords: {\n          x: posicion.x,\n          y: posicion.y,\n        },\n      };\n      console.log(`en las coordenadas: ${posicion.x}, ${posicion.y} `);\n      this.posicionCreandoNodo = {\n        x: posicion.x,\n        y: posicion.y,\n      };\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($infoNodo: NodoConocimientoInput) {\n              crearNodo(infoNodo: $infoNodo) {\n                ...fragNodoConocimiento\n              }\n            }\n            ${fragmentoNodoConocimiento}\n          `,\n          variables: {\n            infoNodo,\n          },\n        })\n        .then(({ data: { crearNodo } }) => {\n          console.log(`Creado ${crearNodo.id}`);\n          const store = this.$apollo.provider.defaultClient;\n          const cache = store.readQuery({\n            query: QUERY_NODOS,\n          });\n          var nuevoCache = JSON.parse(JSON.stringify(cache));\n          console.log(`1`);\n          var losNodos = nuevoCache.todosNodos;\n          console.log(`2`);\n\n          const indexN = losNodos.findIndex((n) => n.id === crearNodo.id);\n          if (indexN > -1) {\n            console.log(`El nodo ya estaba en caché`);\n          } else {\n            losNodos.push(crearNodo);\n            store.writeQuery({\n              query: QUERY_NODOS,\n              data: nuevoCache,\n            });\n          }\n          this.posicionCreandoNodo = null;\n          //this.$router.push(\"/nodoConocimiento/\"+crearNodo.id);\n        })\n        .catch((error) => {\n          this.posicionCreandoNodo = null;\n          console.log(`Error. E: ${error}`);\n        });\n    },\n    descargarCentroVista() {\n      let dis = this;\n      this.$apollo\n        .query({\n          query: gql`\n            query {\n              yo {\n                id\n                atlas {\n                  centroVista {\n                    x\n                    y\n                  }\n                }\n              }\n            }\n          `,\n          variables: {\n            idUsuario: this.$store.state.usuario.id,\n          },\n          fetchPolicy: \"network-only\",\n        })\n        .then(function ({ data: { yo } }) {\n          let coords = yo.atlas.centroVista;\n          dis.$set(dis.centroVista, \"x\", coords.x);\n          dis.$set(dis.centroVista, \"y\", coords.y);\n          dis.$store.commit(\"setCentroVistaAtlas\", coords);\n        })\n        .catch(function (error) {\n          console.log(`error fetching centro vista: ${error}`);\n        });\n    },\n    seleccionNodo(nodo) {\n      this.idNodoSeleccionado = nodo.id;\n    },\n    async eliminarVinculo(args) {\n      if (!this.usuarioSuperadministrador && !this.usuarioAdministradorAtlas) {\n        console.log(`No autorizado`);\n        return;\n      }\n      console.log(\n        `eliminando un vinculo entre ${args.idNodoFrom} y ${args.idNodoTo} `\n      );\n      await this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($idNodoFrom: ID!, $idNodoTo: ID!) {\n              eliminarVinculoFromTo(\n                idSource: $idNodoFrom\n                idTarget: $idNodoTo\n              ) {\n                modificados {\n                  id\n                  vinculos {\n                    idRef\n                    tipo\n                    rol\n                  }\n                }\n              }\n            }\n          `,\n          variables: {\n            idNodoFrom: args.idNodoFrom,\n            idNodoTo: args.idNodoTo,\n          },\n        })\n        .then(() => {})\n        .catch((error) => {\n          console.log(`error: ${error}`);\n        });\n    },\n    dibujarVinculosGrises() {\n      this.actualizarVinculosGrises++;\n    },\n    async crearVinculo(args) {\n      if (!this.usuarioSuperadministrador && !this.usuarioAdministradorAtlas) {\n        console.log(`No autorizado`);\n        return;\n      }\n      console.log(`creando un vinculo ${JSON.stringify(args)} `);\n      await this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation ($tipo: String!, $idNodoFrom: ID!, $idNodoTo: ID!) {\n              crearVinculo(\n                tipo: $tipo\n                idSource: $idNodoFrom\n                idTarget: $idNodoTo\n              ) {\n                modificados {\n                  id\n                  vinculos {\n                    idRef\n                    rol\n                    tipo\n                  }\n                }\n              }\n            }\n          `,\n          variables: {\n            tipo: \"continuacion\",\n            idNodoFrom: args.idNodoFrom,\n            idNodoTo: args.idNodoTo,\n          },\n        })\n        .then(() => {})\n        .catch((error) => {\n          console.log(`error: ${error}`);\n        });\n    },\n\n    zoomVista(deltaZoom) {\n      var nuevoZoom = this.zoom + deltaZoom;\n      if (nuevoZoom < this.minZoom) {\n        this.zoom = this.minZoom;\n      } else if (nuevoZoom > this.maxZoom) {\n        this.zoom = this.maxZoom;\n      } else {\n        this.zoom = nuevoZoom;\n      }\n\n      //Pan vista de acuerdo con la posición del mouse respecto del atlas\n    },\n    zoomWheel(e) {\n      if (!this.hovered || !e.ctrlKey) {\n        return;\n      }\n      e.preventDefault();\n\n      var contenedor = this.$el;\n      let posContenedor = contenedor.getBoundingClientRect();\n\n      const posZoom = {\n        x:\n          Math.round((e.clientX - posContenedor.left) / this.factorZoom) +\n          this.centroVista.x,\n        y:\n          Math.round((e.clientY - posContenedor.top) / this.factorZoom) +\n          this.centroVista.y,\n      };\n\n      // const proporciones = {\n      //   x:\n      //     (posZoom.x - this.centroVistaDecimal.x) /\n      //     (posContenedor.width / this.factorZoom),\n      //   y:\n      //     (posZoom.y - this.centroVistaDecimal.y) /\n      //     (posContenedor.height / this.factorZoom),\n      // };\n\n      const factorZoom = 0.2;\n      this.zoomVista(-Math.round(e.deltaY * factorZoom), {\n        x: posZoom.x,\n        y: posZoom.y,\n      });\n    },\n    hideZoomInfo: debounce(function () {\n      this.showingZoomInfo = false;\n    }, 1000),\n  },\n  watch: {\n    nodoSeleccionado: function () {\n      this.actualizarTrazos++;\n    },\n    route: function (to) {\n      console.log(`cambio de navegación a ${to.path}`);\n    },\n    idNodoTarget(idNodoTarget) {\n      if (!idNodoTarget) {\n        this.idsNecesariosParaTarget = [];\n        return;\n      }\n      console.log(`iniciando busqueda de requeridos de nodo ${idNodoTarget}`);\n      this.idsNecesariosParaTarget = this.encontrarNodosNecesariosDeNodo(\n        idNodoTarget,\n        []\n      );\n    },\n    zoom() {\n      this.showingZoomInfo = true;\n      this.hideZoomInfo();\n    },\n  },\n  mounted() {\n    // if (!this.usuario.atlas || !this.usuario.atlas.centroVista) {\n    //   console.log(`No había info de centro vista en la store. Descargando`);\n    //   this.descargarCentroVista();\n    //   return;\n    // }\n    // this.$set(this.centroVistaDecimal, \"x\", this.usuario.atlas.centroVista.x);\n    // this.$set(this.centroVistaDecimal, \"y\", this.usuario.atlas.centroVista.y);\n\n    if (screen.width < 600) {\n      this.zoom = 70;\n    }\n  },\n  created() {\n    window.addEventListener(\"wheel\", this.zoomWheel, { passive: false });\n  },\n  removed() {\n    window.removeEventListener(\"wheel\", this.zoomWheel);\n  },\n  // beforeRouteLeave(_, __, next) {\n  //   console.log(\n  //     `enviando nuevo centroVista para el usuario ${\n  //       this.usuario.id\n  //     }. Centro vista: ${JSON.stringify(this.centroVista)}`\n  //   );\n  //   this.$store.commit(\"setCentroVistaAtlas\", this.centroVista);\n\n  //   this.$apollo\n  //     .mutate({\n  //       mutation: gql`\n  //         mutation($idUsuario: ID, $centroVista: CoordsInput) {\n  //           setCentroVista(idUsuario: $idUsuario, centroVista: $centroVista)\n  //         }\n  //       `,\n  //       variables: {\n  //         idUsuario: this.$store.state.usuario.id,\n  //         centroVista: this.centroVista,\n  //       },\n  //     })\n  //     .then(function () {\n  //       next();\n  //     })\n  //     .catch(function (error) {\n  //       console.log(`error: ${error}`);\n  //       next();\n  //     });\n  // },\n};\n</script>\n<style>\n:root {\n  --atlasConocimientoFondo: #f3eff5;\n  --atlasConocimientoCheck: #3f7d20;\n  --atlasConocimientoAvailable: #e2c044;\n  --atlasConocimientoRepaso: #ff5f5f;\n  --atlasConocimientoOff: #dbfcff;\n}\n</style>\n<style scoped>\n.atlasConocimiento {\n  position: relative;\n  overflow-x: hidden;\n}\n.ventanaRepasos {\n  z-index: 100;\n  position: absolute;\n  top: 0px;\n  left: 0%;\n  background-color: rgb(255 252 249);\n  box-shadow: 3px 4px 4px rgba(0, 0, 0, 0.25);\n}\n#zonaNodoTarget {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  z-index: 50;\n}\n#zonaNodoTarget .boton {\n  width: 25px;\n  height: 25px;\n}\n#menuContextual {\n  position: absolute;\n  background-color: gray;\n  z-index: 110;\n}\n.botonMenuContextual {\n  font-size: 12px;\n  color: rgb(221, 221, 221);\n  cursor: pointer;\n  padding: 10px;\n}\n.botonMenuContextual:hover {\n  background-color: rgb(68, 68, 68);\n}\n#contenedorDiagrama {\n  position: relative;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n  z-index: 0;\n}\n#contenedorVinculosNodos {\n  position: absolute;\n  top: 50px;\n  left: 50px;\n  user-select: none;\n\n  pointer-events: none;\n}\n#contenedorNodos {\n  position: absolute;\n  top: 50px;\n  left: 50px;\n  user-select: none;\n\n  pointer-events: none;\n}\n#buscadorNodosConocimiento {\n  position: absolute;\n  top: 1%;\n  right: 1%;\n  /* transform: translateX(-50%); */\n  z-index: 1;\n  width: min(100vh, 350px);\n}\n#panelConjuntosNodos {\n  z-index: 100;\n}\n\n#panelObjetivos {\n  position: absolute;\n  top: 2%;\n  left: 50%;\n  transform: translateX(-50%);\n  opacity: 0.2;\n  z-index: 100;\n}\n#panelObjetivos:hover {\n  opacity: 1;\n}\n#infoZoom {\n  position: absolute;\n  top: 2%;\n  left: 50%;\n  transform: translateX(-50%);\n  padding: 10px;\n  display: inline-block;\n  font-weight: bold;\n  color: rgb(102, 102, 102);\n}\n#botonCallingPosiciones {\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  border: 1px solid black;\n  position: absolute;\n  top: 1%;\n  right: 1%;\n  cursor: pointer;\n  z-index: 1;\n}\n\n#simboloDescargandoNodos {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 100;\n}\n\n.visorNodoConocimiento {\n  width: 100%;\n  min-height: 100%;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  z-index: 1000;\n  background-color: whitesmoke;\n}\n\n#barraInferior {\n  position: absolute;\n  bottom: 12px;\n  padding: 10px;\n  display: flex;\n  flex-direction: row-reverse;\n  right: 0px;\n  box-sizing: border-box;\n}\n\n#barraInferior .boton {\n  height: 30px;\n  width: 30px;\n  margin: 0px 5px;\n  z-index: 0;\n}\n\n.fadeOut-leave-to {\n  opacity: 0;\n}\n.fadeOut-leave-active {\n  transition: opacity 1s;\n}\n.fadeOut-leave {\n  opacity: 1;\n}\n</style>"]}]}