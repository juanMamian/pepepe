{"remainingRequest":"/home/juan/webPj/pepepe/librosolo/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/juan/webPj/pepepe/librosolo/src/components/Libro.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/juan/webPj/pepepe/librosolo/src/components/Libro.vue","mtime":1620356337796},{"path":"/home/juan/webPj/pepepe/librosolo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/juan/webPj/pepepe/librosolo/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/juan/webPj/pepepe/librosolo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/juan/webPj/pepepe/librosolo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdxbCB9IGZyb20gImFwb2xsby1zZXJ2ZXItY29yZSI7CmltcG9ydCBQYWdpbmEgZnJvbSAiLi9QYWdpbmEudnVlIjsKZXhwb3J0IGNvbnN0IGZyYWdtZW50b0N1YWRyb1RleHRvID0gZ3FsYAogIGZyYWdtZW50IGZyYWdDdWFkcm9UZXh0byBvbiBDdWFkcm9UZXh0b0N1ZW50byB7CiAgICBpZAogICAgdGV4dG8KICAgIHBvc2ljaW9uWmV0YQogICAgcG9zaWNpb24gewogICAgICB4CiAgICAgIHkKICAgIH0KICAgIHNpemUgewogICAgICB4CiAgICAgIHkKICAgIH0KICAgIGF1ZGlvIHsKICAgICAgdGlwb1JlcHJvZHVjY2lvbgogICAgfQogICAgZm9ybWF0byB7CiAgICAgIGZvbnRTaXplCiAgICAgIGNvbG9yTGV0cmEKICAgICAgdGlwb0xldHJhCiAgICAgIGFsaW5lYWNpb24KICAgIH0KICB9CmA7CgpleHBvcnQgY29uc3QgZnJhZ21lbnRvQ3VhZHJvSW1hZ2VuID0gZ3FsYAogIGZyYWdtZW50IGZyYWdDdWFkcm9JbWFnZW4gb24gQ3VhZHJvSW1hZ2VuQ3VlbnRvIHsKICAgIGlkCiAgICBzaW5BcmNoaXZvCiAgICB0aXBvQWN0aXZhY2lvblNlY3VuZGFyaW8KICAgIHBvc2ljaW9uWmV0YQogICAgcG9zaWNpb24gewogICAgICB4CiAgICAgIHkKICAgIH0KICAgIHNpemUgewogICAgICB4CiAgICAgIHkKICAgIH0KICAgIGF1ZGlvIHsKICAgICAgdGlwb1JlcHJvZHVjY2lvbgogICAgfQogIH0KYDsKCmNvbnN0IGZyYWdtZW50b1BhZ2luYSA9IGdxbGAKICBmcmFnbWVudCBmcmFnUGFnaW5hIG9uIFBhZ2luYUN1ZW50byB7CiAgICBpZAogICAgbnVtUGFnCiAgICBjb2xvcgogICAgY3VhZHJvc1RleHRvIHsKICAgICAgLi4uZnJhZ0N1YWRyb1RleHRvCiAgICB9CiAgICBjdWFkcm9zSW1hZ2VuIHsKICAgICAgLi4uZnJhZ0N1YWRyb0ltYWdlbgogICAgfQogIH0KICAke2ZyYWdtZW50b0N1YWRyb1RleHRvfQogICR7ZnJhZ21lbnRvQ3VhZHJvSW1hZ2VufQpgOwoKY29uc3QgUVVFUllfTElCUk8gPSBncWxgCiAgcXVlcnkoJGlkTGlicm86IElEISkgewogICAgbGlicm8oaWRMaWJybzogJGlkTGlicm8pIHsKICAgICAgaWQKICAgICAgaWRzRWRpdG9yZXMKICAgICAgdGl0dWxvCiAgICAgIHBhZ2luYXMgewogICAgICAgIC4uLmZyYWdQYWdpbmEKICAgICAgfQogICAgICBpZEZvcm8KICAgIH0KICB9CiAgJHtmcmFnbWVudG9QYWdpbmF9CmA7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IFBhZ2luYSB9LAogIG5hbWU6ICJMaWJybyIsCiAgYXBvbGxvOiB7CiAgICBsaWJybzogewogICAgICBxdWVyeTogUVVFUllfTElCUk8sCiAgICAgIHZhcmlhYmxlcygpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWRMaWJybzogdGhpcy5pZExpYnJvLAogICAgICAgIH07CiAgICAgIH0sCiAgICAgIHNraXAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaWRMaWJybyA9PSBudWxsOwogICAgICB9LAogICAgICBmZXRjaFBvbGljeTogImNhY2hlLWFuZC1uZXR3b3JrIiwKICAgIH0sCiAgfSwKICBwcm9wczogewogICAgaWRMaWJybzogU3RyaW5nLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpYnJvOiB7CiAgICAgICAgcGFnaW5hczogbnVsbCwKICAgICAgfSwKICAgICAgaG9qYU1vdmlkYTogMCwKICAgICAgY2VudHJvSG9qYXM6IC0wLjUsCgogICAgICBzd2lwaW5nUGFnaW5hOiBmYWxzZSwKICAgICAgc3dpcGVBY3VtdWxhZG86IDAsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgc3dpcGVQYWdpbmEoZSwgZGlyZWNjaW9uKSB7CiAgICAgIGlmICghdGhpcy5zd2lwaW5nUGFnaW5hKSByZXR1cm47CiAgICAgIGlmICgKICAgICAgICAoZS5tb3ZlbWVudFggPCAwICYmIGRpcmVjY2lvbiA9PSAiYWRlbGFudGUiKSB8fAogICAgICAgIChlLm1vdmVtZW50WCA+IDAgJiYgZGlyZWNjaW9uID09ICJhdHJhcyIpCiAgICAgICkgewogICAgICAgIHRoaXMuc3dpcGVBY3VtdWxhZG8gKz0gZS5tb3ZlbWVudFg7CiAgICAgIH0KCiAgICAgIC8vIGlmKGRpcmVjY2lvbj09J2FkZWxhbnRlJyAmJiBlKQogICAgfSwKICAgIGVuZFN3aXBlKCkgewogICAgICBpZiAoTWF0aC5hYnModGhpcy5zd2lwZUFjdW11bGFkbykgPCA1KSB7CiAgICAgICAgdGhpcy5zd2lwaW5nUGFnaW5hID0gZmFsc2U7CiAgICAgICAgdGhpcy5zd2lwZUFjdW11bGFkbyA9IDA7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLnN3aXBlQWN1bXVsYWRvIDwgMCkgewogICAgICAgIGNvbnNvbGUubG9nKGBBdmFuemFyIHVuYSBob2phYCk7CiAgICAgICAgdGhpcy5uYXZlZ2FySG9qYXMoMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coYFJldHJvY2VkZXIgdW5hIGhvamFgKTsKICAgICAgICB0aGlzLm5hdmVnYXJIb2phcygtMSk7CgogICAgICB9CiAgICAgIHRoaXMuc3dpcGluZ1BhZ2luYSA9IGZhbHNlOwogICAgICB0aGlzLnN3aXBlQWN1bXVsYWRvID0gMDsKICAgIH0sCiAgICBuYXZlZ2FySG9qYXMobnVtKSB7CiAgICAgIHRoaXMuY2VudHJvSG9qYXMgKz0gbnVtOwogICAgICBpZihudW08MCl7CiAgICAgICAgdGhpcy5ob2phTW92aWRhPXRoaXMuY2VudHJvSG9qYXMrMC41OwogICAgICB9CiAgICAgIGVsc2V7CiAgICAgICAgdGhpcy5ob2phTW92aWRhPXRoaXMuY2VudHJvSG9qYXMtMC41OwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["Libro.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Libro.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"libro\">\n    <div id=\"contenedorHojas\" v-if=\"libro.paginas\">\n      <div\n        class=\"hoja\"\n        :class=\"{ girada: numeroH - 1 < centroHojas, tapada: Math.abs((numeroH-1)-centroHojas)>=1 }\"\n        v-for=\"numeroH of Math.ceil(libro.paginas.length / 2)\"\n        :key=\"numeroH\"\n        :style=\"[\n          {\n            zIndex:\n              numeroH - 1 == hojaMovida\n                ? '0'\n                : -Math.abs(numeroH - 1 - hojaMovida),\n          },\n        ]\"\n      >\n        <pagina\n          :estaPagina=\"pagina\"\n          v-for=\"(pagina, index) of libro.paginas.slice(\n            (numeroH - 1) * 2,\n            (numeroH - 1) * 2 + 2\n          )\"\n          :key=\"pagina.id\"\n          :class=\"{ reverso: index % 2 > 0 }\"\n          :numPagina=\"index+((numeroH-1)*2)\"\n          :idLibro=\"idLibro\"\n          @mousedown.left.native=\"swipingPagina = true\"\n          @mouseup.left.native=\"endSwipe\"\n          @mousemove.native=\"\n            swipePagina($event, index % 2 > 0 ? 'atras' : 'adelante', index)\n          \"\n          @mouseleave.native=\"endSwipe\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { gql } from \"apollo-server-core\";\nimport Pagina from \"./Pagina.vue\";\nexport const fragmentoCuadroTexto = gql`\n  fragment fragCuadroTexto on CuadroTextoCuento {\n    id\n    texto\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n    formato {\n      fontSize\n      colorLetra\n      tipoLetra\n      alineacion\n    }\n  }\n`;\n\nexport const fragmentoCuadroImagen = gql`\n  fragment fragCuadroImagen on CuadroImagenCuento {\n    id\n    sinArchivo\n    tipoActivacionSecundario\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n  }\n`;\n\nconst fragmentoPagina = gql`\n  fragment fragPagina on PaginaCuento {\n    id\n    numPag\n    color\n    cuadrosTexto {\n      ...fragCuadroTexto\n    }\n    cuadrosImagen {\n      ...fragCuadroImagen\n    }\n  }\n  ${fragmentoCuadroTexto}\n  ${fragmentoCuadroImagen}\n`;\n\nconst QUERY_LIBRO = gql`\n  query($idLibro: ID!) {\n    libro(idLibro: $idLibro) {\n      id\n      idsEditores\n      titulo\n      paginas {\n        ...fragPagina\n      }\n      idForo\n    }\n  }\n  ${fragmentoPagina}\n`;\nexport default {\n  components: { Pagina },\n  name: \"Libro\",\n  apollo: {\n    libro: {\n      query: QUERY_LIBRO,\n      variables() {\n        return {\n          idLibro: this.idLibro,\n        };\n      },\n      skip() {\n        return this.idLibro == null;\n      },\n      fetchPolicy: \"cache-and-network\",\n    },\n  },\n  props: {\n    idLibro: String,\n  },\n  data() {\n    return {\n      libro: {\n        paginas: null,\n      },\n      hojaMovida: 0,\n      centroHojas: -0.5,\n\n      swipingPagina: false,\n      swipeAcumulado: 0,\n    };\n  },\n  methods: {\n    swipePagina(e, direccion) {\n      if (!this.swipingPagina) return;\n      if (\n        (e.movementX < 0 && direccion == \"adelante\") ||\n        (e.movementX > 0 && direccion == \"atras\")\n      ) {\n        this.swipeAcumulado += e.movementX;\n      }\n\n      // if(direccion=='adelante' && e)\n    },\n    endSwipe() {\n      if (Math.abs(this.swipeAcumulado) < 5) {\n        this.swipingPagina = false;\n        this.swipeAcumulado = 0;\n        return;\n      }\n      if (this.swipeAcumulado < 0) {\n        console.log(`Avanzar una hoja`);\n        this.navegarHojas(1);\n      } else {\n        console.log(`Retroceder una hoja`);\n        this.navegarHojas(-1);\n\n      }\n      this.swipingPagina = false;\n      this.swipeAcumulado = 0;\n    },\n    navegarHojas(num) {\n      this.centroHojas += num;\n      if(num<0){\n        this.hojaMovida=this.centroHojas+0.5;\n      }\n      else{\n        this.hojaMovida=this.centroHojas-0.5;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n#libro{\n  overflow: hidden;\n}\n#contenedorHojas {\n  width: 138vh;\n  height: 92vh;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  perspective: 4000px;\n\n}\n.hoja {\n  position: absolute;\n  left: 50%;\n  /* width: 450px;\n  height: 600px; */\n  height: 92vh;\n  width: 69vh;\n  perspective-origin: left bottom;\n  transform-origin: 0% 0%;\n  transition: transform 0.5s;\n  transform-style: preserve-3d;\n}\n.tapada{\n  pointer-events: none;\n}\n.girada {\n  transform: rotateY(-180deg);\n}\n.hoja:not(.girada)>.reverso{\n  pointer-events: none;\n}\n.girada>.pagina:not(.reverso){\n  pointer-events: none;\n}\n\n.reverso {\n  transform: rotateY(180deg);\n}\n.pagina {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  backface-visibility: hidden;\n  transform-style: preserve-3d;\n\n}\n\n</style>"]}]}