{"remainingRequest":"/home/juan/webPj/pepepe/libro/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/juan/webPj/pepepe/libro/src/components/Libro.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/juan/webPj/pepepe/libro/src/components/Libro.vue","mtime":1620421152205},{"path":"/home/juan/webPj/pepepe/libro/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/juan/webPj/pepepe/libro/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/juan/webPj/pepepe/libro/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/juan/webPj/pepepe/libro/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/juan/webPj/pepepe/libro/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBncWwgZnJvbSAiZ3JhcGhxbC10YWciOwppbXBvcnQgUGFnaW5hIGZyb20gIi4vUGFnaW5hLnZ1ZSI7CmltcG9ydCBGb3JvIGZyb20gJy4vRm9yby52dWUnOwpjb25zdCBjaGFyUHJvaGliaWRvc1RpdHVsbyA9IC9bXiBhLXpBLVrDgC3FvjAtOV8oKTouLC3Cvz/CoSFdLzsKCmV4cG9ydCBjb25zdCBmcmFnbWVudG9DdWFkcm9UZXh0byA9IGdxbGAKICBmcmFnbWVudCBmcmFnQ3VhZHJvVGV4dG8gb24gQ3VhZHJvVGV4dG9DdWVudG8gewogICAgaWQKICAgIHRleHRvCiAgICBwb3NpY2lvblpldGEKICAgIHBvc2ljaW9uIHsKICAgICAgeAogICAgICB5CiAgICB9CiAgICBzaXplIHsKICAgICAgeAogICAgICB5CiAgICB9CiAgICBhdWRpbyB7CiAgICAgIHRpcG9SZXByb2R1Y2Npb24KICAgIH0KICAgIGZvcm1hdG8gewogICAgICBmb250U2l6ZQogICAgICBjb2xvckxldHJhCiAgICAgIHRpcG9MZXRyYQogICAgICBhbGluZWFjaW9uCiAgICB9CiAgfQpgOwoKZXhwb3J0IGNvbnN0IGZyYWdtZW50b0N1YWRyb0ltYWdlbiA9IGdxbGAKICBmcmFnbWVudCBmcmFnQ3VhZHJvSW1hZ2VuIG9uIEN1YWRyb0ltYWdlbkN1ZW50byB7CiAgICBpZAogICAgc2luQXJjaGl2bwogICAgdGlwb0FjdGl2YWNpb25TZWN1bmRhcmlvCiAgICBwb3NpY2lvblpldGEKICAgIHBvc2ljaW9uIHsKICAgICAgeAogICAgICB5CiAgICB9CiAgICBzaXplIHsKICAgICAgeAogICAgICB5CiAgICB9CiAgICBhdWRpbyB7CiAgICAgIHRpcG9SZXByb2R1Y2Npb24KICAgIH0KICB9CmA7Cgpjb25zdCBmcmFnbWVudG9QYWdpbmEgPSBncWxgCiAgZnJhZ21lbnQgZnJhZ1BhZ2luYSBvbiBQYWdpbmFDdWVudG8gewogICAgaWQgICAgCiAgICBudW1QYWcKICAgIGNvbG9yCiAgICBjdWFkcm9zVGV4dG8gewogICAgICAuLi5mcmFnQ3VhZHJvVGV4dG8KICAgIH0KICAgIGN1YWRyb3NJbWFnZW4gewogICAgICAuLi5mcmFnQ3VhZHJvSW1hZ2VuCiAgICB9CiAgfQogICR7ZnJhZ21lbnRvQ3VhZHJvVGV4dG99CiAgJHtmcmFnbWVudG9DdWFkcm9JbWFnZW59CmA7Cgpjb25zdCBRVUVSWV9MSUJSTyA9IGdxbGAKICBxdWVyeSgkaWRMaWJybzogSUQhKSB7CiAgICBsaWJybyhpZExpYnJvOiAkaWRMaWJybykgewogICAgICBpZAogICAgICBpZHNFZGl0b3JlcwogICAgICB0aXR1bG8KICAgICAgcGFnaW5hcyB7CiAgICAgICAgLi4uZnJhZ1BhZ2luYQogICAgICB9LAogICAgICBpZEZvcm8KICAgIH0KICB9CiAgJHtmcmFnbWVudG9QYWdpbmF9CmA7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBQYWdpbmEsIEZvcm8gfSwKICBuYW1lOiAiTGlicm8iLAogIGFwb2xsbzogewogICAgbGlicm86IHsKICAgICAgcXVlcnk6IFFVRVJZX0xJQlJPLAogICAgICB2YXJpYWJsZXMoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGlkTGlicm86IHRoaXMuaWRMaWJybywKICAgICAgICB9OwogICAgICB9LCAgICAgIAogICAgICBza2lwKCkgewogICAgICAgIHJldHVybiB0aGlzLmlkTGlicm8gPT0gbnVsbDsKICAgICAgfSwKICAgICAgZmV0Y2hQb2xpY3k6ImNhY2hlLWFuZC1uZXR3b3JrIgogICAgfSwKICB9LAogIHByb3BzOiB7CiAgICBpZExpYnJvOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogbnVsbCwKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGlicm86IHsKICAgICAgICBwYWdpbmFzOiBudWxsLAogICAgICB9LAogICAgICBpZFBhZ2luYVNlbGVjY2lvbmFkYTogbnVsbCwKCiAgICAgIGNyZWFuZG9QYWdpbmE6IGZhbHNlLAoKICAgICAgbnVldm9UaXR1bG86IG51bGwsCiAgICAgIGVkaXRhbmRvVGl0dWxvOiBmYWxzZSwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgcGFnaW5hc09yZGVuYWRhcygpIHsKICAgICAgaWYgKHRoaXMubGlicm8ucGFnaW5hcykgewogICAgICAgIHZhciBhUGFncyA9IHRoaXMubGlicm8ucGFnaW5hczsKICAgICAgICByZXR1cm4gYVBhZ3Muc29ydCgoYSwgYikgPT4gewogICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGEubnVtUGFnKSAtIHBhcnNlSW50KGIubnVtUGFnKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gW107CiAgICB9LAogICAgbnVldm9UaXR1bG9JbGVnYWwoKSB7CiAgICAgIGlmICghdGhpcy5udWV2b1RpdHVsbyB8fCB0aGlzLm51ZXZvVGl0dWxvLmxlbmd0aCA8IDEpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICBpZiAoY2hhclByb2hpYmlkb3NUaXR1bG8udGVzdCh0aGlzLm51ZXZvVGl0dWxvKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBpbmZvQXNQYXJlbnQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgaWQ6IHRoaXMuaWRMaWJybywKICAgICAgICB0aXBvOiAibGlicm8iLAogICAgICAgIG5vbWJyZTogdGhpcy5saWJyby50aXR1bG8sCiAgICAgIH07CiAgICB9LAogICAgdXN1YXJpb0VkaXRvcigpewogICAgICByZXR1cm4gdGhpcy5saWJyby5pZHNFZGl0b3Jlcy5pbmNsdWRlcyh0aGlzLnVzdWFyaW8uaWQpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgdG9nZ2xlRWRpdGFuZG9UaXR1bG8oKSB7CiAgICAgIHRoaXMuZWRpdGFuZG9UaXR1bG8gPSAhdGhpcy5lZGl0YW5kb1RpdHVsbzsKICAgICAgdGhpcy5udWV2b1RpdHVsbyA9IHRoaXMubGlicm8udGl0dWxvOwogICAgfSwKICAgIGd1YXJkYXJOdWV2b1RpdHVsbygpIHsKICAgICAgaWYgKHRoaXMubnVldm9UaXR1bG9JbGVnYWwpIHsKICAgICAgICBjb25zb2xlLmxvZyhgTm8gZW52aWFkb2ApOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5udWV2b1RpdHVsbyA9PSB0aGlzLmxpYnJvLnRpdHVsbykgewogICAgICAgIHRoaXMuZWRpdGFuZG9UaXR1bG8gPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coYGd1YXJkYW5kbyBudWV2byB0w610dWxvYCk7CiAgICAgIHRoaXMuZW52aWFuZG9OdWV2b1RpdHVsbyA9IHRydWU7CiAgICAgIHRoaXMuJGFwb2xsbwogICAgICAgIC5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGdxbGAKICAgICAgICAgICAgbXV0YXRpb24oJGlkTGlicm86IElEISwgJG51ZXZvVGl0dWxvOiBTdHJpbmchKSB7CiAgICAgICAgICAgICAgZWRpdGFyVGl0dWxvTGlicm8oaWRMaWJybzogJGlkTGlicm8sIG51ZXZvVGl0dWxvOiAkbnVldm9UaXR1bG8pIHsKICAgICAgICAgICAgICAgIGlkCiAgICAgICAgICAgICAgICB0aXR1bG8KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIGAsCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgaWRMaWJybzogdGhpcy5pZExpYnJvLAogICAgICAgICAgICBudWV2b1RpdHVsbzogdGhpcy5udWV2b1RpdHVsbywKICAgICAgICAgIH0sCiAgICAgICAgfSkKICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLmVudmlhbmRvTnVldm9UaXR1bG8gPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZWRpdGFuZG9UaXR1bG8gPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIHRoaXMuZW52aWFuZG9OdWV2b1RpdHVsbyA9IGZhbHNlOwogICAgICAgICAgY29uc29sZS5sb2coYEVycm9yLiBFIDoke2Vycm9yfWApOwogICAgICAgIH0pOwogICAgfSwKICAgIGNyZWFyTnVldmFQYWdpbmFMaWJybygpIHsKICAgICAgdGhpcy5jcmVhbmRvUGFnaW5hID0gdHJ1ZTsKICAgICAgY29uc3QgZGlzID0gdGhpczsKICAgICAgdGhpcy4kYXBvbGxvCiAgICAgICAgLm11dGF0ZSh7CiAgICAgICAgICBtdXRhdGlvbjogZ3FsYAogICAgICAgICAgICBtdXRhdGlvbigkaWRMaWJybzogSUQhKSB7CiAgICAgICAgICAgICAgY3JlYXJOdWV2YVBhZ2luYUxpYnJvKGlkTGlicm86ICRpZExpYnJvKSB7CiAgICAgICAgICAgICAgICAuLi5mcmFnUGFnaW5hCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICR7ZnJhZ21lbnRvUGFnaW5hfQogICAgICAgICAgYCwKICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICBpZExpYnJvOiB0aGlzLmlkTGlicm8sCiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHsgZGF0YTogeyBjcmVhck51ZXZhUGFnaW5hTGlicm8gfSB9KSA9PiB7CiAgICAgICAgICB2YXIgc3RvcmUgPSB0aGlzLiRhcG9sbG8ucHJvdmlkZXIuZGVmYXVsdENsaWVudDsKICAgICAgICAgIGNvbnN0IGNhY2hlID0gc3RvcmUucmVhZFF1ZXJ5KHsKICAgICAgICAgICAgcXVlcnk6IFFVRVJZX0xJQlJPLAogICAgICAgICAgICB2YXJpYWJsZXM6IHsgaWRMaWJybzogZGlzLmlkTGlicm8gfSwKICAgICAgICAgIH0pOwogICAgICAgICAgdmFyIG51ZXZvQ2FjaGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7CiAgICAgICAgICBudWV2b0NhY2hlLmxpYnJvLnBhZ2luYXMucHVzaChjcmVhck51ZXZhUGFnaW5hTGlicm8pOwogICAgICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9MSUJSTywKICAgICAgICAgICAgdmFyaWFibGVzOiB7IGlkTGlicm86IGRpcy5pZExpYnJvIH0sCiAgICAgICAgICAgIGRhdGE6IG51ZXZvQ2FjaGUsCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuY3JlYW5kb1BhZ2luYSA9IGZhbHNlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApOwogICAgICAgICAgdGhpcy5jcmVhbmRvUGFnaW5hID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICB9LAogICAgcmVtb3ZlUGFnaW5hRnJvbUNhY2hlKGlkUGFnaW5hKSB7CiAgICAgIHRoaXMuaWRQYWdpbmFTZWxlY2Npb25hZGE9bnVsbDsKICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLiRhcG9sbG8ucHJvdmlkZXIuZGVmYXVsdENsaWVudDsKICAgICAgY29uc3QgY2FjaGUgPSBzdG9yZS5yZWFkUXVlcnkoewogICAgICAgIHF1ZXJ5OiBRVUVSWV9MSUJSTywKICAgICAgICB2YXJpYWJsZXM6IHsgaWRMaWJybzogdGhpcy5pZExpYnJvIH0sCiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKCiAgICAgIGNvbnN0IGluZGV4UCA9IG51ZXZvQ2FjaGUubGlicm8ucGFnaW5hcy5maW5kSW5kZXgoCiAgICAgICAgKHApID0+IHAuaWQgPT0gaWRQYWdpbmEKICAgICAgKTsKICAgICAgaWYgKGluZGV4UCA+IC0xKSB7CiAgICAgICAgbnVldm9DYWNoZS5saWJyby5wYWdpbmFzLnNwbGljZShpbmRleFAsIDEpOwoKICAgICAgICBzdG9yZS53cml0ZVF1ZXJ5KHsKICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9MSUJSTywKICAgICAgICAgIHZhcmlhYmxlczogeyBpZExpYnJvOiB0aGlzLmlkTGlicm8gfSwKICAgICAgICAgIGRhdGE6IG51ZXZvQ2FjaGUsCiAgICAgICAgfSk7ICAgICAgICAKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyhgTGEgcGFnaW5hIG5vIGVzdGFiYSBlbiBlbCBjYWNow6lgKTsKICAgICAgfQogICAgfSwKICAgIHVwZGF0ZUNhY2hlQ29uTnVldm9DdWFkcm9JbWFnZW4obnVldm9DdWFkcm9JbWFnZW4sIGlkUGFnaW5hKXsKICAgICAgY29uc29sZS5sb2coYFNlIGFjdHVhbGl6YXJhIGVsIGNhY2hlIGNvbiBpbmZvOiAke251ZXZvQ3VhZHJvSW1hZ2VufSBlbiBsYSBwYWdpbmEgJHtpZFBhZ2luYX1gKTsKICAgICAgY29uc3Qgc3RvcmU9dGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlPXN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0xJQlJPLAogICAgICAgIHZhcmlhYmxlczp7aWRMaWJybzp0aGlzLmlkTGlicm99CiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZT1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7CiAgICAgIHZhciBsYVBhZ2luYT1udWV2b0NhY2hlLmxpYnJvLnBhZ2luYXMuZmluZChwPT5wLmlkPT1pZFBhZ2luYSk7CiAgICAgIGlmKCFsYVBhZ2luYSl7CiAgICAgICAgY29uc29sZS5sb2coYFBhZ2luYSBubyBleGlzdMOtYWApOwogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGlmKGxhUGFnaW5hLmN1YWRyb3NJbWFnZW4uc29tZShjPT5jPT1udWV2b0N1YWRyb0ltYWdlbi5pZCkpewogICAgICAgIGNvbnNvbGUubG9nKGBFc2UgY3VhZHJvIHRleHRvIHlhIGVzdGFiYSBpbmNsdWlkb2ApOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAKICAgICAgbGFQYWdpbmEuY3VhZHJvc0ltYWdlbi5wdXNoKChudWV2b0N1YWRyb0ltYWdlbikpOwoKICAgICAgc3RvcmUud3JpdGVRdWVyeSh7CiAgICAgICAgIHF1ZXJ5OiBRVUVSWV9MSUJSTywKICAgICAgICB2YXJpYWJsZXM6e2lkTGlicm86dGhpcy5pZExpYnJvfSwKICAgICAgICBkYXRhOm51ZXZvQ2FjaGUKICAgICAgfSk7CgogICAgfSwKICAgIHVwZGF0ZUNhY2hlQ29uTnVldm9DdWFkcm9UZXh0byhudWV2b0N1YWRyb1RleHRvLCBpZFBhZ2luYSl7CiAgICAgIGNvbnNvbGUubG9nKGBTZSBhY3R1YWxpemFyYSBlbCBjYWNoZSBjb24gaW5mbzogJHtudWV2b0N1YWRyb1RleHRvfSBlbiBsYSBwYWdpbmEgJHtpZFBhZ2luYX1gKTsKICAgICAgY29uc3Qgc3RvcmU9dGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlPXN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgcXVlcnk6IFFVRVJZX0xJQlJPLAogICAgICAgIHZhcmlhYmxlczp7aWRMaWJybzp0aGlzLmlkTGlicm99CiAgICAgIH0pOwogICAgICB2YXIgbnVldm9DYWNoZT1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7CiAgICAgIHZhciBsYVBhZ2luYT1udWV2b0NhY2hlLmxpYnJvLnBhZ2luYXMuZmluZChwPT5wLmlkPT1pZFBhZ2luYSk7CiAgICAgIGlmKCFsYVBhZ2luYSl7CiAgICAgICAgY29uc29sZS5sb2coYFBhZ2luYSBubyBleGlzdMOtYWApOwogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGlmKGxhUGFnaW5hLmN1YWRyb3NUZXh0by5zb21lKGM9PmM9PW51ZXZvQ3VhZHJvVGV4dG8uaWQpKXsKICAgICAgICBjb25zb2xlLmxvZyhgRXNlIGN1YWRybyB0ZXh0byB5YSBlc3RhYmEgaW5jbHVpZG9gKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGFQYWdpbmEuY3VhZHJvc1RleHRvLnB1c2gobnVldm9DdWFkcm9UZXh0byk7CgogICAgICBzdG9yZS53cml0ZVF1ZXJ5KHsKICAgICAgICAgcXVlcnk6IFFVRVJZX0xJQlJPLAogICAgICAgIHZhcmlhYmxlczp7aWRMaWJybzp0aGlzLmlkTGlicm99LAogICAgICAgIGRhdGE6bnVldm9DYWNoZQogICAgICB9KQogICAgfSwKICAgIHJlbW92ZUN1YWRyb1RleHRvRnJvbUNhY2hlKGlkQ3VhZHJvVGV4dG8sIGlkUGFnaW5hKXsKICAgICAgY29uc3Qgc3RvcmU9dGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlPXN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgcXVlcnk6UVVFUllfTElCUk8sCiAgICAgICAgdmFyaWFibGVzOntpZExpYnJvOnRoaXMuaWRMaWJyb30sICAgICAgICAKICAgICAgfSk7CiAgICAgIHZhciBudWV2b0NhY2hlPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKCiAgICAgIHZhciBsYVBhZ2luYT1udWV2b0NhY2hlLmxpYnJvLnBhZ2luYXMuZmluZChwPT5wLmlkPT1pZFBhZ2luYSk7CiAgICAgIGlmKCFsYVBhZ2luYSl7CiAgICAgICAgY29uc29sZS5sb2coYE5vIGV4aXN0w61hIGxhIHBhZ2luYSBlbiBlbCBjYWNow6lgKTsKICAgICAgICByZXR1cm4gCiAgICAgIH0KCiAgICAgIGNvbnN0IGluZGV4Qz1sYVBhZ2luYS5jdWFkcm9zVGV4dG8uZmluZEluZGV4KGM9PmMuaWQ9PWlkQ3VhZHJvVGV4dG8pOwogICAgICBpZihpbmRleEM+LTEpewogICAgICAgIGxhUGFnaW5hLmN1YWRyb3NUZXh0by5zcGxpY2UoaW5kZXhDLCAxKTsKICAgICAgICBzdG9yZS53cml0ZVF1ZXJ5KHsKICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9MSUJSTywKICAgICAgICAgIHZhcmlhYmxlczp7aWRMaWJybzp0aGlzLmlkTGlicm99LAogICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICB9KTsKICAgICAgfQogICAgICBlbHNlewogICAgICAgIGNvbnNvbGUubG9nKGBFbCBjdWFkcm8gdGV4dG8gbm8gZXhpc3TDrWEgZW4gZWwgY2FjaMOpYCk7CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVDdWFkcm9JbWFnZW5Gcm9tQ2FjaGUoaWRDdWFkcm9JbWFnZW4sIGlkUGFnaW5hKXsKICAgICAgY29uc3Qgc3RvcmU9dGhpcy4kYXBvbGxvLnByb3ZpZGVyLmRlZmF1bHRDbGllbnQ7CiAgICAgIGNvbnN0IGNhY2hlPXN0b3JlLnJlYWRRdWVyeSh7CiAgICAgICAgcXVlcnk6UVVFUllfTElCUk8sCiAgICAgICAgdmFyaWFibGVzOntpZExpYnJvOnRoaXMuaWRMaWJyb30sICAgICAgICAKICAgICAgfSk7CiAgICAgIHZhciBudWV2b0NhY2hlPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsKCiAgICAgIHZhciBsYVBhZ2luYT1udWV2b0NhY2hlLmxpYnJvLnBhZ2luYXMuZmluZChwPT5wLmlkPT1pZFBhZ2luYSk7CiAgICAgIGlmKCFsYVBhZ2luYSl7CiAgICAgICAgY29uc29sZS5sb2coYE5vIGV4aXN0w61hIGxhIHBhZ2luYSBlbiBlbCBjYWNow6lgKTsKICAgICAgICByZXR1cm4gCiAgICAgIH0KCiAgICAgIGNvbnN0IGluZGV4Qz1sYVBhZ2luYS5jdWFkcm9zSW1hZ2VuLmZpbmRJbmRleChjPT5jLmlkPT1pZEN1YWRyb0ltYWdlbik7CiAgICAgIGlmKGluZGV4Qz4tMSl7CiAgICAgICAgbGFQYWdpbmEuY3VhZHJvc0ltYWdlbi5zcGxpY2UoaW5kZXhDLCAxKTsKICAgICAgICBzdG9yZS53cml0ZVF1ZXJ5KHsKICAgICAgICAgIHF1ZXJ5OiBRVUVSWV9MSUJSTywKICAgICAgICAgIHZhcmlhYmxlczp7aWRMaWJybzp0aGlzLmlkTGlicm99LAogICAgICAgICAgZGF0YTogbnVldm9DYWNoZSwKICAgICAgICB9KTsKICAgICAgfQogICAgICBlbHNlewogICAgICAgIGNvbnNvbGUubG9nKGBFbCBjdWFkcm8gdGV4dG8gbm8gZXhpc3TDrWEgZW4gZWwgY2FjaMOpYCk7CiAgICAgIH0KICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["Libro.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Libro.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"libro\" @click=\"idPaginaSeleccionada = null\">\n    <div id=\"zonaTitulo\">\n      <div id=\"titulo\" v-show=\"!editandoTitulo\">\n        {{ libro.titulo }}\n      </div>\n      <input\n        type=\"text\"\n        id=\"inputNuevoTitulo\"\n        :class=\"{ letrasRojas: nuevoTituloIlegal }\"\n        v-model=\"nuevoTitulo\"\n        v-show=\"editandoTitulo\"\n        @keypress.enter=\"guardarNuevoTitulo\"\n      />\n      <div id=\"controlesTitulo\">\n        <img\n          src=\"@/assets/iconos/editar.png\"\n          alt=\"Editar\"\n          id=\"bEditarrTitulo\"\n          class=\"bEditarTitulo\"\n          title=\"Editar titulo del libro\"\n          @click.stop=\"toggleEditandoTitulo\"\n        />\n        <img\n          src=\"@/assets/iconos/guardar.png\"\n          alt=\"Guardar\"\n          title=\"guardar\"\n          class=\"bEditarTitulo\"\n          id=\"bGuardarNuevoTitulo\"\n          v-show=\"editandoTitulo == true && nuevoTituloIlegal == false\"\n          @click.stop=\"guardarNuevoTitulo\"\n        />\n      </div>\n    </div>\n\n    <img src=\"@/assets/iconos/loading.png\" alt=\"Cargando\" class=\"simboloLoading\" style=\"width:50px; margin: 30px auto; display: block\" v-show=\"$apollo.queries.libro.loading\">\n\n    <div id=\"contenedorPaginas\">\n      <pagina\n        v-for=\"(pagina, index) of paginasOrdenadas\"\n        :key=\"pagina.id\"\n        :paginaDerecha=\"index % 2 > 0 || index == 0\"\n        :estaPagina=\"pagina\"\n        :idLibro=\"idLibro\"\n        :seleccionada=\"idPaginaSeleccionada == pagina.id\"\n        :segundoPlano=\"\n          idPaginaSeleccionada != null && idPaginaSeleccionada != pagina.id\n        \"\n        @click.native.stop=\"usuarioEditor || usuarioSuperadministrador?idPaginaSeleccionada = pagina.id:null\"\n        @meElimine=\"removePaginaFromCache(pagina.id)\"\n        @tengoNuevoCuadroTexto=\"updateCacheConNuevoCuadroTexto($event, pagina.id)\"\n        @tengoNuevoCuadroImagen=\"updateCacheConNuevoCuadroImagen($event, pagina.id)\"\n        @elimineCuadroTexto=\"removeCuadroTextoFromCache($event, pagina.id)\"\n        @elimineCuadroImagen=\"removeCuadroImagenFromCache($event, pagina.id)\"\n      />\n    </div>\n\n    <div\n      id=\"bCrearNuevaPagina\"\n      @click.stop=\"crearNuevaPaginaLibro\"\n      :class=\"{ deshabilitado: creandoPagina }\"\n    >\n      Crear nueva página\n    </div>\n\n    <div id=\"zonaForos\">\n      <div class=\"tituloForo\">Foro de editores</div>\n      <foro v-if=\"libro.idForo\" :parent=\"infoAsParent\" :idForo=\"libro.idForo\"/>\n\n    </div>\n\n\n\n  </div>\n</template>\n\n<script>\nimport gql from \"graphql-tag\";\nimport Pagina from \"./Pagina.vue\";\nimport Foro from './Foro.vue';\nconst charProhibidosTitulo = /[^ a-zA-ZÀ-ž0-9_():.,-¿?¡!]/;\n\nexport const fragmentoCuadroTexto = gql`\n  fragment fragCuadroTexto on CuadroTextoCuento {\n    id\n    texto\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n    formato {\n      fontSize\n      colorLetra\n      tipoLetra\n      alineacion\n    }\n  }\n`;\n\nexport const fragmentoCuadroImagen = gql`\n  fragment fragCuadroImagen on CuadroImagenCuento {\n    id\n    sinArchivo\n    tipoActivacionSecundario\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n  }\n`;\n\nconst fragmentoPagina = gql`\n  fragment fragPagina on PaginaCuento {\n    id    \n    numPag\n    color\n    cuadrosTexto {\n      ...fragCuadroTexto\n    }\n    cuadrosImagen {\n      ...fragCuadroImagen\n    }\n  }\n  ${fragmentoCuadroTexto}\n  ${fragmentoCuadroImagen}\n`;\n\nconst QUERY_LIBRO = gql`\n  query($idLibro: ID!) {\n    libro(idLibro: $idLibro) {\n      id\n      idsEditores\n      titulo\n      paginas {\n        ...fragPagina\n      },\n      idForo\n    }\n  }\n  ${fragmentoPagina}\n`;\n\nexport default {\n  components: { Pagina, Foro },\n  name: \"Libro\",\n  apollo: {\n    libro: {\n      query: QUERY_LIBRO,\n      variables() {\n        return {\n          idLibro: this.idLibro,\n        };\n      },      \n      skip() {\n        return this.idLibro == null;\n      },\n      fetchPolicy:\"cache-and-network\"\n    },\n  },\n  props: {\n    idLibro: {\n      type: String,\n      default: null,\n    },\n  },\n  data() {\n    return {\n      libro: {\n        paginas: null,\n      },\n      idPaginaSeleccionada: null,\n\n      creandoPagina: false,\n\n      nuevoTitulo: null,\n      editandoTitulo: false,\n    };\n  },\n  computed: {\n    paginasOrdenadas() {\n      if (this.libro.paginas) {\n        var aPags = this.libro.paginas;\n        return aPags.sort((a, b) => {\n          return parseInt(a.numPag) - parseInt(b.numPag);\n        });\n      }\n      return [];\n    },\n    nuevoTituloIlegal() {\n      if (!this.nuevoTitulo || this.nuevoTitulo.length < 1) {\n        return true;\n      }\n      if (charProhibidosTitulo.test(this.nuevoTitulo)) {\n        return true;\n      }\n      return false;\n    },\n    infoAsParent() {\n      return {\n        id: this.idLibro,\n        tipo: \"libro\",\n        nombre: this.libro.titulo,\n      };\n    },\n    usuarioEditor(){\n      return this.libro.idsEditores.includes(this.usuario.id);\n    }\n  },\n  methods: {\n    toggleEditandoTitulo() {\n      this.editandoTitulo = !this.editandoTitulo;\n      this.nuevoTitulo = this.libro.titulo;\n    },\n    guardarNuevoTitulo() {\n      if (this.nuevoTituloIlegal) {\n        console.log(`No enviado`);\n        return;\n      }\n      if (this.nuevoTitulo == this.libro.titulo) {\n        this.editandoTitulo = false;\n        return;\n      }\n      console.log(`guardando nuevo título`);\n      this.enviandoNuevoTitulo = true;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation($idLibro: ID!, $nuevoTitulo: String!) {\n              editarTituloLibro(idLibro: $idLibro, nuevoTitulo: $nuevoTitulo) {\n                id\n                titulo\n              }\n            }\n          `,\n          variables: {\n            idLibro: this.idLibro,\n            nuevoTitulo: this.nuevoTitulo,\n          },\n        })\n        .then(() => {\n          this.enviandoNuevoTitulo = false;\n          this.editandoTitulo = false;\n        })\n        .catch((error) => {\n          this.enviandoNuevoTitulo = false;\n          console.log(`Error. E :${error}`);\n        });\n    },\n    crearNuevaPaginaLibro() {\n      this.creandoPagina = true;\n      const dis = this;\n      this.$apollo\n        .mutate({\n          mutation: gql`\n            mutation($idLibro: ID!) {\n              crearNuevaPaginaLibro(idLibro: $idLibro) {\n                ...fragPagina\n              }\n            }\n            ${fragmentoPagina}\n          `,\n          variables: {\n            idLibro: this.idLibro,\n          },\n        })\n        .then(({ data: { crearNuevaPaginaLibro } }) => {\n          var store = this.$apollo.provider.defaultClient;\n          const cache = store.readQuery({\n            query: QUERY_LIBRO,\n            variables: { idLibro: dis.idLibro },\n          });\n          var nuevoCache = JSON.parse(JSON.stringify(cache));\n          nuevoCache.libro.paginas.push(crearNuevaPaginaLibro);\n          store.writeQuery({\n            query: QUERY_LIBRO,\n            variables: { idLibro: dis.idLibro },\n            data: nuevoCache,\n          });\n          this.creandoPagina = false;\n        })\n        .catch((error) => {\n          console.log(`Error: ${error}`);\n          this.creandoPagina = false;\n        });\n    },\n    removePaginaFromCache(idPagina) {\n      this.idPaginaSeleccionada=null;\n      const store = this.$apollo.provider.defaultClient;\n      const cache = store.readQuery({\n        query: QUERY_LIBRO,\n        variables: { idLibro: this.idLibro },\n      });\n      var nuevoCache = JSON.parse(JSON.stringify(cache));\n\n      const indexP = nuevoCache.libro.paginas.findIndex(\n        (p) => p.id == idPagina\n      );\n      if (indexP > -1) {\n        nuevoCache.libro.paginas.splice(indexP, 1);\n\n        store.writeQuery({\n          query: QUERY_LIBRO,\n          variables: { idLibro: this.idLibro },\n          data: nuevoCache,\n        });        \n      } else {\n        console.log(`La pagina no estaba en el caché`);\n      }\n    },\n    updateCacheConNuevoCuadroImagen(nuevoCuadroImagen, idPagina){\n      console.log(`Se actualizara el cache con info: ${nuevoCuadroImagen} en la pagina ${idPagina}`);\n      const store=this.$apollo.provider.defaultClient;\n      const cache=store.readQuery({\n        query: QUERY_LIBRO,\n        variables:{idLibro:this.idLibro}\n      });\n      var nuevoCache=JSON.parse(JSON.stringify(cache));\n      var laPagina=nuevoCache.libro.paginas.find(p=>p.id==idPagina);\n      if(!laPagina){\n        console.log(`Pagina no existía`);\n        return\n      }\n      if(laPagina.cuadrosImagen.some(c=>c==nuevoCuadroImagen.id)){\n        console.log(`Ese cuadro texto ya estaba incluido`);\n        return;\n      }\n      \n      laPagina.cuadrosImagen.push((nuevoCuadroImagen));\n\n      store.writeQuery({\n         query: QUERY_LIBRO,\n        variables:{idLibro:this.idLibro},\n        data:nuevoCache\n      });\n\n    },\n    updateCacheConNuevoCuadroTexto(nuevoCuadroTexto, idPagina){\n      console.log(`Se actualizara el cache con info: ${nuevoCuadroTexto} en la pagina ${idPagina}`);\n      const store=this.$apollo.provider.defaultClient;\n      const cache=store.readQuery({\n        query: QUERY_LIBRO,\n        variables:{idLibro:this.idLibro}\n      });\n      var nuevoCache=JSON.parse(JSON.stringify(cache));\n      var laPagina=nuevoCache.libro.paginas.find(p=>p.id==idPagina);\n      if(!laPagina){\n        console.log(`Pagina no existía`);\n        return\n      }\n      if(laPagina.cuadrosTexto.some(c=>c==nuevoCuadroTexto.id)){\n        console.log(`Ese cuadro texto ya estaba incluido`);\n        return;\n      }\n      laPagina.cuadrosTexto.push(nuevoCuadroTexto);\n\n      store.writeQuery({\n         query: QUERY_LIBRO,\n        variables:{idLibro:this.idLibro},\n        data:nuevoCache\n      })\n    },\n    removeCuadroTextoFromCache(idCuadroTexto, idPagina){\n      const store=this.$apollo.provider.defaultClient;\n      const cache=store.readQuery({\n        query:QUERY_LIBRO,\n        variables:{idLibro:this.idLibro},        \n      });\n      var nuevoCache=JSON.parse(JSON.stringify(cache));\n\n      var laPagina=nuevoCache.libro.paginas.find(p=>p.id==idPagina);\n      if(!laPagina){\n        console.log(`No existía la pagina en el caché`);\n        return \n      }\n\n      const indexC=laPagina.cuadrosTexto.findIndex(c=>c.id==idCuadroTexto);\n      if(indexC>-1){\n        laPagina.cuadrosTexto.splice(indexC, 1);\n        store.writeQuery({\n          query: QUERY_LIBRO,\n          variables:{idLibro:this.idLibro},\n          data: nuevoCache,\n        });\n      }\n      else{\n        console.log(`El cuadro texto no existía en el caché`);\n      }\n    },\n    removeCuadroImagenFromCache(idCuadroImagen, idPagina){\n      const store=this.$apollo.provider.defaultClient;\n      const cache=store.readQuery({\n        query:QUERY_LIBRO,\n        variables:{idLibro:this.idLibro},        \n      });\n      var nuevoCache=JSON.parse(JSON.stringify(cache));\n\n      var laPagina=nuevoCache.libro.paginas.find(p=>p.id==idPagina);\n      if(!laPagina){\n        console.log(`No existía la pagina en el caché`);\n        return \n      }\n\n      const indexC=laPagina.cuadrosImagen.findIndex(c=>c.id==idCuadroImagen);\n      if(indexC>-1){\n        laPagina.cuadrosImagen.splice(indexC, 1);\n        store.writeQuery({\n          query: QUERY_LIBRO,\n          variables:{idLibro:this.idLibro},\n          data: nuevoCache,\n        });\n      }\n      else{\n        console.log(`El cuadro texto no existía en el caché`);\n      }\n    }\n  },\n};\n</script>\n\n<style scoped>\n.libro {\n  margin-top: 100px;\n  border: 2px solid black;\n  padding-bottom: 80vh;\n}\n#zonaTitulo {\n  padding: 5px 10px;\n  text-align: center;\n  font-size: 22px;\n  border: 1px solid purple;\n  background-color: rgb(131 94 134);\n  margin: 10px auto;\n}\n#inputNuevoTitulo{\n  font-size: inherit;\n}\n\n.bEditarTitulo {\n  cursor: pointer;\n  border-radius: 50%;\n  width: 35px;\n  height: 35px;\n}\n.bEditarTitulo:hover {\n  background-color: rgba(128, 0, 128, 0.459);\n}\n\n#contenedorPaginas {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  row-gap: 20px;\n}\n#bCrearNuevaPagina {\n  padding: 5px;\n  border: 1px solid rgb(65, 0, 65);\n  background-color: rgba(182, 105, 182, 0.267);\n  cursor: pointer;\n  margin: 10px auto;\n  border-radius: 5px;\n  max-width: 200px;\n}\n\n#bCrearNuevaPagina:hover {\n  background-color: rgb(182, 105, 182);\n}\n\n.tituloForo{\n  font-size: 19px;\n  padding: 5px 10px;\n  background-color: cadetblue;\n}\n</style>"]}]}