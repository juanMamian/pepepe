{"remainingRequest":"/home/juan/webPj/pepepe/libro/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/juan/webPj/pepepe/libro/src/components/CuadroTexto.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/juan/webPj/pepepe/libro/src/components/CuadroTexto.vue","mtime":1617376991584},{"path":"/home/juan/webPj/pepepe/libro/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/juan/webPj/pepepe/libro/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/juan/webPj/pepepe/libro/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/juan/webPj/pepepe/libro/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ3VhZHJvVGV4dG8iLAogIHByb3BzOiB7CiAgICBpZExpYnJvOiBTdHJpbmcsCiAgICBpZFBhZ2luYTogU3RyaW5nLAogICAgZXN0ZUN1YWRyb1RleHRvOiBPYmplY3QsCiAgICBzaXplUGFnaW5hOiBPYmplY3QsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9udFNpemVEdW1teTogMTAsCiAgICAgIGZvbnRTaXplVGV4dG86IDEwLAoKICAgICAgcmVzaXppbmc6IGZhbHNlLAoKICAgICAgcG9zaWNpb246IHsKICAgICAgICB4OiBudWxsLAogICAgICAgIHk6IG51bGwsCiAgICAgIH0sCiAgICAgIHNpemU6IHsKICAgICAgICB4OiBudWxsLAogICAgICAgIHk6IG51bGwsCiAgICAgIH0sCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGVzdGlsb0xheW91dCgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3A6IHRoaXMucG9zaWNpb24ueSArICIlIiwKICAgICAgICBsZWZ0OiB0aGlzLnBvc2ljaW9uLnggKyAiJSIsCgogICAgICAgIHdpZHRoOiB0aGlzLnNpemUueCArICIlIiwKICAgICAgICBoZWlnaHQ6IHRoaXMuc2l6ZS55ICsgIiUiLAogICAgICB9OwogICAgfSwKICAgIGVzdGlsb0Zvcm1hdG8oKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdGV4dEFsaWduOiB0aGlzLmVzdGVDdWFkcm9UZXh0by5mb3JtYXRvLmFsaW5lYWNpb24sCiAgICAgICAgY29sb3I6IHRoaXMuZXN0ZUN1YWRyb1RleHRvLmZvcm1hdG8uY29sb3JMZXRyYSwKICAgICAgICBmb250RmFtaWx5OiB0aGlzLmVzdGVDdWFkcm9UZXh0by5mb3JtYXRvLnRpcG9MZXRyYSArICIsICdOdW5pdG8nLCBzYW5zLXNlcmlmIiwKICAgICAgfTsKICAgIH0sCiAgICBlc3RpbG9Gb250U2l6ZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBmb250U2l6ZTogdGhpcy5mb250U2l6ZVRleHRvICsgInB4IiwKICAgICAgfTsKICAgIH0sCiAgICBlc3RpbG9EdW1teSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBmb250U2l6ZTogdGhpcy5mb250U2l6ZUR1bW15ICsgInB4IiwKICAgICAgfTsKICAgIH0sCiAgICBzaXplUmVzaXplSGFuZGxlKCkgewogICAgICByZXR1cm4gewogICAgICAgIHdpZHRoOiB0aGlzLnJlc2l6aW5nID8gMjAwICsgInB4IiA6IDEwICsgInB4IiwKICAgICAgICBoZWlnaHQ6IHRoaXMucmVzaXppbmcgPyAyMDAgKyAicHgiIDogMTAgKyAicHgiLAogICAgICB9OwogICAgfSwKICAgIHVybEF1ZGlvKCkgewogICAgICByZXR1cm4gKAogICAgICAgIHRoaXMuc2VydmVyVXJsICsKICAgICAgICAiL2FwaUN1ZW50b3MvYXVkaW9UZXh0by8iICsKICAgICAgICB0aGlzLmlkTGlicm8gKwogICAgICAgICIvIiArCiAgICAgICAgdGhpcy5pZFBhZ2luYSArCiAgICAgICAgIi8iICsKICAgICAgICB0aGlzLmVzdGVDdWFkcm9UZXh0by5pZAogICAgICApOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIHBsYXlBdWRpbygpewogICAgICBpZighdGhpcy5lc3RlQ3VhZHJvVGV4dG8uYXVkaW8pcmV0dXJuOwogICAgICBjb25zb2xlLmxvZyhgUmVwcm9kdWNpZW5kb2ApOwogICAgICB0aGlzLiRyZWZzLmF1ZGlvLnBsYXkoKTsKICAgIH0sCiAgICBpbmljaWFyUmVzaXplKCkgewogICAgICB0aGlzLnJlc2l6aW5nID0gdHJ1ZTsKICAgIH0sCiAgICByZXNpemUoZSkgewogICAgICBpZiAodGhpcy5yZXNpemluZykgewogICAgICAgIHZhciBjdWFkcm9Qb3MgPSB7CiAgICAgICAgICB4OiB0aGlzLiRlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0LAogICAgICAgICAgeTogdGhpcy4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wLAogICAgICAgIH07CgogICAgICAgIHZhciBudWV2b3ggPSBlLmNsaWVudFggLSBjdWFkcm9Qb3MueCAtIDU7CiAgICAgICAgdmFyIG51ZXZveSA9IGUuY2xpZW50WSAtIGN1YWRyb1Bvcy55IC0gNTsKCiAgICAgICAgaWYgKG51ZXZveCA8IDE1IHx8IG51ZXZveSA8IDE1KSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhgT2ZmbGltaXRzYCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBpZiAoCiAgICAgICAgLy8gICBlLmNsaWVudFkgPiBjdWFkcm9Qb3MueSArIHRoaXMuc2l6ZVBhZ2luYS55CiAgICAgICAgLy8gKSB7CiAgICAgICAgLy8gICBudWV2b3ggPSB0aGlzLnNpemVQYWdpbmEueCAtIGN1YWRyb1Bvcy54OwogICAgICAgIC8vIH0KCiAgICAgICAgLy8gaWYgKAogICAgICAgIC8vICAgZS5jbGllbnRZID4gY3VhZHJvUG9zLnkgKyB0aGlzLnNpemVQYWdpbmEueQogICAgICAgIC8vICkgewogICAgICAgIC8vICAgbnVldm95ID0gdGhpcy5zaXplUGFnaW5hLnkgLSBjdWFkcm9Qb3MueTsKICAgICAgICAvLyB9CgogICAgICAgIHZhciBudWV2b3hQID0gKG51ZXZveCAqIDEwMCkgLyB0aGlzLnNpemVQYWdpbmEueDsKICAgICAgICB2YXIgbnVldm95UCA9IChudWV2b3kgKiAxMDApIC8gdGhpcy5zaXplUGFnaW5hLnk7CgogICAgICAgIGlmICh0aGlzLnBvc2ljaW9uLnggKyBudWV2b3hQID4gMTAwKQogICAgICAgICAgbnVldm94UCA9IE1hdGguZmxvb3IoMTAwIC0gdGhpcy5wb3NpY2lvbi54KTsKICAgICAgICBpZiAodGhpcy5wb3NpY2lvbi55ICsgbnVldm95UCA+IDEwMCkKICAgICAgICAgIG51ZXZveVAgPSBNYXRoLmZsb29yKDEwMCAtIHRoaXMucG9zaWNpb24ueSk7CgogICAgICAgIHRoaXMuJHNldCh0aGlzLnNpemUsICJ4IiwgbnVldm94UCk7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMuc2l6ZSwgInkiLCBudWV2b3lQKTsKICAgICAgfQogICAgfSwKICAgIGZpblJlc2l6ZSgpIHsKICAgICAgdGhpcy5yZXNpemluZyA9IGZhbHNlOwogICAgICB0aGlzLmZvbnRTaXplRHVtbXkgPSAxMDsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuZmluZEZvbnRTaXplKCk7CiAgICAgIH0pOwogICAgfSwKICAgIGZpbmRGb250U2l6ZSgpIHsKICAgICAgY29uc3QgaFRleHRvID0gdGhpcy4kcmVmcy50ZXh0by5vZmZzZXRIZWlnaHQ7CiAgICAgIGNvbnN0IGhEdW1teSA9IHRoaXMuJHJlZnMudGV4dG9EdW1teS5vZmZzZXRIZWlnaHQ7CiAgICAgIGNvbnN0IHdEdW1teSA9IHRoaXMuJHJlZnMudGV4dG9EdW1teS5zY3JvbGxXaWR0aDsKICAgICAgY29uc3Qgd1RleHRvID0gdGhpcy4kcmVmcy50ZXh0by5vZmZzZXRXaWR0aDsKICAgICAgaWYgKGhEdW1teSA+IGhUZXh0byB8fCB3RHVtbXkgPiB3VGV4dG8pIHsKICAgICAgICB0aGlzLmZvbnRTaXplRHVtbXkgPSB0aGlzLmZvbnRTaXplRHVtbXkgLSAyOwogICAgICAgIHRoaXMuZm9udFNpemVUZXh0byA9IHRoaXMuZm9udFNpemVEdW1teTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZvbnRTaXplRHVtbXkgPSB0aGlzLmZvbnRTaXplRHVtbXkgKyAyOwogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHRoaXMuZmluZEZvbnRTaXplKCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5wb3NpY2lvbiA9IHRoaXMuZXN0ZUN1YWRyb1RleHRvLnBvc2ljaW9uOwogICAgdGhpcy5zaXplID0gdGhpcy5lc3RlQ3VhZHJvVGV4dG8uc2l6ZTsKICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgdGhpcy5maW5kRm9udFNpemUoKTsKICAgIH0pOwogIH0sCn07Cg=="},{"version":3,"sources":["CuadroTexto.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CuadroTexto.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"cuadroTexto\" :style=\"[estiloLayout]\" @click=\"playAudio\" :class=\"{conAudio:esteCuadroTexto.audio}\">\n    <div class=\"texto\" :style=\"[estiloFormato, estiloFontSize]\" ref=\"texto\">\n      {{ esteCuadroTexto.texto }}\n    </div>\n    <div\n      class=\"textoDummy\"\n      :style=\"[estiloFormato, estiloDummy]\"\n      ref=\"textoDummy\"\n    >\n      {{ esteCuadroTexto.texto }}\n    </div>\n    <div\n      id=\"resizeHandle\"\n      :style=\"[sizeResizeHandle]\"\n      @mousedown.left.stop=\"iniciarResize\"\n      @mousemove=\"resize\"\n      @mouseup=\"finResize\"\n    >\n      <div id=\"bolitaResizeHandle\"></div>\n    </div>\n\n    <audio type=\"audio/ogg\" v-if=\"esteCuadroTexto.audio\" ref=\"audio\">\n      <source :src=\"urlAudio\" type=\"audio/ogg\" />\n    </audio>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"CuadroTexto\",\n  props: {\n    idLibro: String,\n    idPagina: String,\n    esteCuadroTexto: Object,\n    sizePagina: Object,\n  },\n  data() {\n    return {\n      fontSizeDummy: 10,\n      fontSizeTexto: 10,\n\n      resizing: false,\n\n      posicion: {\n        x: null,\n        y: null,\n      },\n      size: {\n        x: null,\n        y: null,\n      },\n    };\n  },\n  computed: {\n    estiloLayout() {\n      return {\n        top: this.posicion.y + \"%\",\n        left: this.posicion.x + \"%\",\n\n        width: this.size.x + \"%\",\n        height: this.size.y + \"%\",\n      };\n    },\n    estiloFormato() {\n      return {\n        textAlign: this.esteCuadroTexto.formato.alineacion,\n        color: this.esteCuadroTexto.formato.colorLetra,\n        fontFamily: this.esteCuadroTexto.formato.tipoLetra + \", 'Nunito', sans-serif\",\n      };\n    },\n    estiloFontSize() {\n      return {\n        fontSize: this.fontSizeTexto + \"px\",\n      };\n    },\n    estiloDummy() {\n      return {\n        fontSize: this.fontSizeDummy + \"px\",\n      };\n    },\n    sizeResizeHandle() {\n      return {\n        width: this.resizing ? 200 + \"px\" : 10 + \"px\",\n        height: this.resizing ? 200 + \"px\" : 10 + \"px\",\n      };\n    },\n    urlAudio() {\n      return (\n        this.serverUrl +\n        \"/apiCuentos/audioTexto/\" +\n        this.idLibro +\n        \"/\" +\n        this.idPagina +\n        \"/\" +\n        this.esteCuadroTexto.id\n      );\n    },\n  },\n  methods: {\n    playAudio(){\n      if(!this.esteCuadroTexto.audio)return;\n      console.log(`Reproduciendo`);\n      this.$refs.audio.play();\n    },\n    iniciarResize() {\n      this.resizing = true;\n    },\n    resize(e) {\n      if (this.resizing) {\n        var cuadroPos = {\n          x: this.$el.getBoundingClientRect().left,\n          y: this.$el.getBoundingClientRect().top,\n        };\n\n        var nuevox = e.clientX - cuadroPos.x - 5;\n        var nuevoy = e.clientY - cuadroPos.y - 5;\n\n        if (nuevox < 15 || nuevoy < 15) {\n          console.log(`Offlimits`);\n          return;\n        }\n\n        // if (\n        //   e.clientY > cuadroPos.y + this.sizePagina.y\n        // ) {\n        //   nuevox = this.sizePagina.x - cuadroPos.x;\n        // }\n\n        // if (\n        //   e.clientY > cuadroPos.y + this.sizePagina.y\n        // ) {\n        //   nuevoy = this.sizePagina.y - cuadroPos.y;\n        // }\n\n        var nuevoxP = (nuevox * 100) / this.sizePagina.x;\n        var nuevoyP = (nuevoy * 100) / this.sizePagina.y;\n\n        if (this.posicion.x + nuevoxP > 100)\n          nuevoxP = Math.floor(100 - this.posicion.x);\n        if (this.posicion.y + nuevoyP > 100)\n          nuevoyP = Math.floor(100 - this.posicion.y);\n\n        this.$set(this.size, \"x\", nuevoxP);\n        this.$set(this.size, \"y\", nuevoyP);\n      }\n    },\n    finResize() {\n      this.resizing = false;\n      this.fontSizeDummy = 10;\n      this.$nextTick(() => {\n        this.findFontSize();\n      });\n    },\n    findFontSize() {\n      const hTexto = this.$refs.texto.offsetHeight;\n      const hDummy = this.$refs.textoDummy.offsetHeight;\n      const wDummy = this.$refs.textoDummy.scrollWidth;\n      const wTexto = this.$refs.texto.offsetWidth;\n      if (hDummy > hTexto || wDummy > wTexto) {\n        this.fontSizeDummy = this.fontSizeDummy - 2;\n        this.fontSizeTexto = this.fontSizeDummy;\n      } else {\n        this.fontSizeDummy = this.fontSizeDummy + 2;\n        this.$nextTick(() => {\n          this.findFontSize();\n        });\n      }\n    },\n  },\n  mounted() {\n    this.posicion = this.esteCuadroTexto.posicion;\n    this.size = this.esteCuadroTexto.size;\n    this.$nextTick(() => {\n      this.findFontSize();\n    });\n  },\n};\n</script>\n\n<style>\n.texto {\n  width: 100%;\n  height: 100%;\n}\n.cuadroTexto {\n  position: absolute;\n  border: 1px solid green;\n  resize: both;\n}\n.textoDummy {\n  width: 100%;\n  border: 1px solid pink;\n  overflow-x: scroll;\n  visibility: hidden;\n  pointer-events: none;\n}\n#resizeHandle {\n  position: absolute;\n  top: 100%;\n  left: 100%;\n\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n\n  cursor: pointer;\n  border: 1px solid purple;\n}\n#bolitaResizeHandle {\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background-color: green;\n}\n.conAudio{\n  cursor: pointer;\n}\n</style>"]}]}